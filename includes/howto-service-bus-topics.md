## サービス バス トピックとサブスクリプションとは

サービス バスのトピックとサブスクリプションは、**メッセージ通信の発行/サブスクライブ** モデルをサポートします。トピックとサブスクリプションを使用すると、分散アプリケーションのコンポーネントが互いに直接通信することがなくなり、仲介者の役割を果たすトピックを介してメッセージをやり取りすることになります。

![TopicConcepts](./media/howto-service-bus-topics/sb-topics-01.png)

すべてのメッセージが 1 つのコンシューマーによって処理されるサービス バス キューとは異なり、トピックとサブスクリプションでは発行/サブスクライブ パターンを使用した **1 対多**形式の通信を行います。複数のサブスクリプションを 1 つのトピックに登録できます。トピックに送信されたメッセージはサブスクリプションに渡され、各サブスクリプションで独立して処理できます。

トピック サブスクリプションは、トピックに送信されたメッセージのコピーを受け取る仮想キューのようなものです。トピックに対するフィルター ルールをサブスクリプション単位で登録することもできます。これを使用すると、トピックに送信されるどのメッセージをどのトピック サブスクリプションで受信するかのフィルター処理や制限ができます。

Service Bus のトピックとサブスクリプションを使用することで、多数のユーザーとアプリケーションの間でやり取りされる膨大な数のメッセージを処理することもできます。

## サービス名前空間の作成

Azure のサービス バスのトピックとサブスクリプションを使用するには、最初にサービス名前空間を作成する必要があります。サービス名前空間は、アプリケーション内でサービス バス リソースをアドレス指定するためのスコープ コンテナーを提供します。

サービス名前空間を作成するには:

1.  [Azure の管理ポータル][]にログオンします。

2.  管理ポータルの左のナビゲーション ウィンドウで **[サービス バス]** をクリックします。

3.  管理ポータルの下のウィンドウの **[作成]** をクリックします。   
    ![][0]

4.  **[新しい名前空間を追加する]** ダイアログで、名前空間の名前を入力します。
    その名前が使用できるかどうかがすぐに自動で確認されます。   
    ![][2]

5.  入力した名前空間の名前が利用できることを確認できたら、名前空間をホストする国またはリージョンを選択します (コンピューター リソースを展開する国またはリージョンと同じ国またはリージョンを必ず使用してください)。

	重要:アプリケーションをデプロイする予定の国またはリージョンと **同じ国/リージョン** を選択してください。そうすることで、パフォーマンスが最高になります。

6. 	ダイアログ ボックスの他のフィールドは、既定値 (**[メッセージング]** と **[標準階層]**) のままにして、チェック マークをクリックします。これで、システムによってサービス名前空間が作成され、有効になります。システムがアカウントのリソースを準備し終わるまでに、数分間かかる場合があります。

	![][6]


## 名前空間の既定の管理資格情報の取得

新規作成した名前空間に対してトピックやサブスクリプションの作成などの管理操作を実行するには、名前空間の管理資格情報を取得する必要があります。管理ポータル、または Visual Studio サーバー エクスプローラーからこれらの資格情報を取得できます。

### ポータルから管理資格情報を取得するには

1.  左側のナビゲーション ウィンドウで **[サービス バス]** ノードをクリックして、利用可能な名前空間の一覧を表示します。   
    ![][0]

2.  表示された一覧から先ほど作成した名前空間を選択します。   
    ![][3]

3.  **[接続情報]** をクリックします。   
    ![][4]

4.  **[接続情報へのアクセス]** ダイアログで、**[既定の発行者]** と **[既定のキー]** のエントリを探します。その値を書き留めておきます。この情報は、この後に名前空間に対して操作を実行するときに使用します。 

### 管理資格情報をサーバー エクスプローラーから取得するには

管理ポータルの代わりに Visual Studio を使用して接続情報を取得するには、「[Azure Tools for Visual Studio の概要](http://http://msdn.microsoft.com/library/windowsazure/ff687127.aspx)」の「**Visual Studio から Azure に接続するには**」で説明されている手順に従ってください。Azure にサインインすると、サーバー エクスプローラーの **[Microsoft Azure]** ツリーの下にある **[サービス バス]** ノードが、既に作成したすべての名前空間を使用して自動的に設定されます。いずれかの名前空間を右クリックし、**[プロパティ]** をクリックします。Visual Studio の **[プロパティ]** ウィンドウで表示される、この名前空間に関連付けられている接続文字列と他のメタデータを確認できます。 

**SharedAccessKey** の値を書き留めておくか、クリップボードにコピーしておいてください。

![][34]

 
  [Azure の管理ポータル]: http://manage.windowsazure.com
  [0]: ./media/howto-service-bus-topics/sb-queues-13.png
  [2]: ./media/howto-service-bus-topics/sb-queues-04.png
  [3]: ./media/howto-service-bus-topics/sb-queues-09.png
  [4]: ./media/howto-service-bus-topics/sb-queues-06.png
  
  [6]: ./media/howto-service-bus-topics/getting-started-multi-tier-27.png
  [34]: ./media/howto-service-bus-topics/VSProperties.png

<!--HONumber=47-->
