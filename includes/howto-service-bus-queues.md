<span id="what-are-service-bus-queues"></span></a>

## サービス バス キューとは

サービス バス キューは、**メッセージ通信仲介**
モデルをサポートしています。キューを使用すると、分散アプリケーションのコンポーネントが互いに
直接通信することがなくなり、仲介者の役割を果たすキューを介して
メッセージをやり取りすることになります。メッセージ プロデューサー (送信者) は
キューにメッセージを送信した後で、それまでの処理を引き続き実行します。
メッセージ コンシューマー (受信者) は、キューからメッセージを非同期に
受信して処理します。メッセージ プロデューサーは、それ以降のメッセージの
処理と送信を続ける場合、メッセージ コンシューマーからの応答を待つ必要が
ありません。キューでは、コンシューマーが競合している場合のメッセージ配信に**先入先出法 (FIFO)** を使用
します。つまり、通常はキューに追加された
順番にメッセージが受信され、処理されます。このとき、メッセージを
受信および処理できるメッセージ コンシューマーは、メッセージ 1 件に
つき 1 つだけです。

![QueueConcepts][]

サービス バス キューは汎用テクノロジであり、幅広い
シナリオで使用できます。

-   多層 Azure アプリケーションでの Web ロールと Worker ロールとの
    間の通信
-   ハイブリッド ソリューションでの内部設置型アプリケーション
    と Azure によってホストされるアプリケーションとの間の通信
-   複数の組織で実行される分散アプリケーションまたは 1 つの組織内の
    異なる部署で実行される分散アプリケーションのコンポーネント間
    の通信

キューを使用すると、アプリケーションのスケール アウト性および
アーキテクチャの復元性を有効にできます。

<span id="create-a-service-namespace"></span></a>

## サービス名前空間の作成

</p>
Azure のサービス バス キューを使用するには、最初に
サービス名前空間を作成する必要があります。サービス名前空間は、アプリケーション内で
Service Bus リソースをアドレス指定するためのスコープ コンテナーを提供します。

サービス名前空間を作成するには:

1.  [Azure 管理ポータル][]へのログオン

2.  管理ポータルの左のナビゲーション ウィンドウで、
    **[サービス バス]** をクリックします。

3.  管理ポータルの下のウィンドウの **[作成]** をクリックします。

    ![][]

4.  **[新しい名前空間を追加する]** ダイアログで、名前空間の名前を入力します。
    その名前が使用できるかどうかがすぐに自動で確認されます。

    ![][1]

5.  入力した名前が利用できることを確認できたら、名前空間をホスト
    する国またはリージョンを選択します (コンピューティング リソース
    のデプロイ先となる国またはリージョンと同じ国またはリージョンを
    必ず使用してください)。

    重要: アプリケーションをデプロイする予定の国またはリージョンと**同じ国/リージョン**を選択
    してください。そうすることで、パフォーマンスが最高になります。

6.  チェック マークをクリックします。これで、システムによってサービス名前空間が
    作成され、有効になります。システムがアカウントのリソースを準備し
    終わるまでに、数分間かかる場合があります。

    ![][2]

作成した名前空間が管理ポータルに表示され、アクティブになります。
これには少し時間がかかります。ステータスが **[アクティブ]** になるのを待ってから、
次に進みます。

<span id="obtain-default-credentials"></span></a>

## 名前空間の既定の管理資格情報の取得

</p>
新規作成した名前空間に対してキューの作成などの管理操作を実行するには、
名前空間の管理資格情報を取得する必要が
あります。管理ポータル、または Visual Studio サーバー エクスプローラーからこれらの資格情報を取得できます。

### ポータルから管理資格情報を取得するには

1.  左側のナビゲーション ウィンドウで **[サービス バス]** ノードをクリック
    して、利用可能な名前空間の一覧を表示します。

    ![][3]

2.  表示された一覧から先ほど作成した名前空間を選択します。

    ![][4]

3.  **[接続情報]** をクリックします。

    ![][5]

4.  **[接続情報へのアクセス]** ダイアログで、**[既定の発行者]** と **[既定のキー]** のエントリを探します。その値を書き留めておきます。この情報は、この後に名前空間に対して操作を実行するときに使用します。

### 管理資格情報をサーバー エクスプローラーから取得するには

管理ポータルの代わりに Visual Studio を使用して接続情報を取得するには、「[Azure Tools for Visual Studio の概要][]」の「**Visual Studio から Azure に接続するには**」で説明されている手順に従ってください。Azure にサインインすると、サーバー エクスプローラーの **[Microsoft Azure]** ツリーの下にある **[サービス バス]** ノードが、既に作成したすべての名前空間を使用して自動的に設定されます。いずれかの名前空間を右クリックし、**[プロパティ]** をクリックします。Visual Studio の **[プロパティ]** ウィンドウで表示される、この名前空間に関連付けられている接続文字列と他のメタデータを確認できます。

**SharedAccessKey** の値を書き留めておくか、クリップボードにコピーしておいてください。

![][6]

  [QueueConcepts]: ./media/howto-service-bus-queues/sb-queues-08.png
  [Azure 管理ポータル]: http://manage.windowsazure.com
  []: ./media/howto-service-bus-queues/sb-queues-03.png
  [1]: ./media/howto-service-bus-queues/sb-queues-04.png
  [2]: ./media/howto-service-bus-queues/getting-started-multi-tier-27.png
  [3]: ./media/howto-service-bus-queues/sb-queues-13.png
  [4]: ./media/howto-service-bus-queues/sb-queues-09.png
  [5]: ./media/howto-service-bus-queues/sb-queues-06.png
  [Azure Tools for Visual Studio の概要]: http://http://msdn.microsoft.com/en-us/library/windowsazure/ff687127.aspx
  [6]: ./media/howto-service-bus-queues/VSProperties.png
