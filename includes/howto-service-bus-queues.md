## サービス バス キューとは

Service Bus キューは、**仲介型メッセージング**通信モデルをサポートしています。キューを使用すると、分散アプリケーションのコンポーネントが互いに直接通信することがなくなり、仲介者 (ブローカー) の役割を果たすキューを介してメッセージをやり取りすることになります。メッセージ プロデューサー (送信者) はキューにメッセージを送信した後で、それまでの処理を引き続き実行します。メッセージ コンシューマー (受信者) は、キューからメッセージを非同期に受信して処理します。メッセージ プロデューサーは、それ以降のメッセージの処理と送信を続ける場合、メッセージ コンシューマーからの応答を待つ必要がありません。キューでは、コンシューマーが競合している場合のメッセージ配信に**先入先出法 (FIFO)** を使用します。つまり、通常はキューに追加された順番にメッセージが受信され、処理されます。このとき、メッセージを受信して処理できるメッセージ コンシューマーは、メッセージ 1 件につき 1 つだけです。

![QueueConcepts](./media/howto-service-bus-queues/sb-queues-08.png)

Service Bus キューは汎用テクノロジであり、幅広いシナリオで使用できます。

-   多層 Azure アプリケーションでの Web ロールと Worker ロールとの間の通信。
-   ハイブリッド ソリューションでのオンプレミスのアプリと Azure によってホストされるアプリケーションとの間の通信。
-   複数の組織で実行される分散アプリケーションまたは 1 つの組織内の異なる部署でオンプレミスで実行される分散アプリケーションのコンポーネント間の通信。

キューを使用すると、アプリケーションのスケールアウトをより簡単になり、アーキテクチャの復元性が高まります。

## サービス名前空間の作成

Azure の Service Bus キューを使用するには、最初にサービス名前空間を作成する必要があります。名前空間は、アプリケーション内で Service Bus リソースをアドレス指定するためのスコープ コンテナーを提供します。

サービス名前空間を作成するには:

1.  [Azure 管理ポータル][]へのログオン

2.  管理ポータルの左のナビゲーション ウィンドウで、**[Service Bus]** をクリックします。

3.  管理ポータルの下のウィンドウの **[作成]** をクリックします。![](./media/howto-service-bus-queues/sb-queues-03.png)

4.  **[新しい名前空間を追加する]** ダイアログで、名前空間の名前を入力します。その名前が使用できるかどうかがすぐに自動で確認されます。![](./media/howto-service-bus-queues/sb-queues-04.png)

5.  入力した名前空間の名前が利用できることを確認できたら、名前空間をホストする国またはリージョンを選択します (コンピューティング リソースを展開する国またはリージョンと同じ国またはリージョンを必ず使用してください)。

	重要: アプリケーションをデプロイする予定の国またはリージョンと**同じ国/リージョン**を選択してください。そうすることで、パフォーマンスが最高になります。

6. 	ダイアログ ボックスの他のフィールドは、既定値 (**[メッセージング]** と **[Standard]** プラン) のままにして、チェック マークをクリックします。これで、システムによってサービス名前空間が作成され、有効になります。システムがアカウントのリソースを準備し 終わるまでに、数分間かかる場合があります。

	![](./media/howto-service-bus-queues/getting-started-multi-tier-27.png)

作成した名前空間はアクティブになるまで少し時間がかかります。その後、管理ポータルに表示されます。名前空間のステータスが **[アクティブ]** になるのを待ってから、次に進みます。

## 名前空間の既定の管理資格情報の取得

新規作成した名前空間に対してキューの作成などの管理操作を実行するには、名前空間の管理資格情報を取得する必要があります。これらの資格情報は、Azure 管理ポータルまたは Visual Studio サーバー エクスプローラーから取得できます。

###ポータルから管理資格情報を取得するには

1.  左側のナビゲーション ウィンドウで **[Service Bus]** ノードをクリックして、利用可能な名前空間の一覧を表示します。![](./media/howto-service-bus-queues/sb-queues-13.png)

2.  表示された一覧から先ほど作成した名前空間を選択します。 ![](./media/howto-service-bus-queues/sb-queues-09.png)

3.  **[接続情報]** をクリックします。![](./media/howto-service-bus-queues/sb-queues-06.png)

4.  **[接続情報へのアクセス]** ウィンドウで、SAS キーとキー名を含む接続文字列を見つけます。

	![](./media/howto-service-bus-queues/multi-web-45.png)
    
5.  キーを書き留めておくか、クリップボードにコピーしておいてください。

### 管理資格情報をサーバー エクスプローラーから取得するには

管理ポータルの代わりに Visual Studio を使用して接続情報を取得するには、[こちら](http://msdn.microsoft.com/library/ff687127.aspx)の「**Visual Studio から Azure に接続するには**」で説明されている手順に従ってください。Azure にサインインすると、サーバー エクスプローラーの **[Azure]** ツリーの下にある **[Service Bus]** ノードには、既に作成したすべての名前空間が自動的に設定されます。いずれかの名前空間を右クリックし、**[プロパティ]** をクリックします。Visual Studio の **[プロパティ]** ウィンドウで表示される、この名前空間に関連付けられている接続文字列と他のメタデータを確認できます。

**SharedAccessKey** の値を書き留めておくか、クリップボードにコピーしておいてください。

![][34]

  [Azure Management Portal]: http://manage.windowsazure.com
  [Azure 管理ポータル]: http://manage.windowsazure.com

  [34]: ./media/howto-service-bus-queues/VSProperties.png

<!---HONumber=July15_HO2-->