# Windows Azure の概要

Windows Azure は、パブリック クラウド向けのマイクロソフトのアプリケーション プラットフォームです。このプラットフォームは、さまざまな方法で使用できます。たとえば、Windows Azure を使用して、Windows Azure データ センターのデータ上で実行、格納する Web アプリケーションをビルドできます。データを格納するためにのみ Windows Azure を使用し、このデータを使用するアプリケーションは内部 (つまり、パブリック クラウドの外部) で実行することもできます。Windows Azure を使用して、開発およびテスト用の仮想マシンを作成したり、SharePoint やその他のアプリケーションを実行することもできます。さらに、Windows Azure を使用して、多くのユーザーに対応できるきわめてスケーラブルなアプリケーションを作成できます。このプラットフォームが提供するサービスは多岐にわたるため、さらにさまざまなことが可能になります。

これらのいずれを行う場合でも、基本を理解する必要があります。クラウド コンピューティングに関する知識がまったくなくても、この記事をお読みいただくことで、Windows Azure の基礎を理解することができます。この記事は、このクラウド プラットフォームを理解して使用するための基礎を身に付けていただくことを目的にしています。


## 目次

-   [Windows Azure のコンポーネント](#components)
-   [実行モデル/コンピューティング](#models)
-   [データ管理](#data)
-   [ネットワーク](#networking)
-   [ビジネス分析](#analytics)
-   [メッセージング](#messaging)
-   [Caching](#caching)
-   [ID](#identity)
-   [ハイパフォーマンス コンピューティング (HPC)](#HPC)
-   [メディア](#media)
-   [コマース](#commerce)
-   [SDK](#sdk)
-   [はじめに](#start)




<h2><a id="components"></a>Windows Azure のコンポーネント</h2>

Windows Azure が提供する機能を理解するうえで、そのサービスを個々のカテゴリに分類するとわかりやすくなります。図 1 に、その一例を示します。

![Windows Azure のコンポーネント](./media/intro-to-windows-azure/IntroAzure1.png)
 **図 1: Windows Azure には、Windows Azure データセンターで実行される、インターネット経由でアクセスできるアプリケーション サービスが用意されている。**

Windows Azure を使用するには、少なくとも各コンポーネントの基本を理解する必要があります。[Windows Azure Poster (Windows Azure ポスター)](http://www.microsoft.com/ja-jp/download/details.aspx?id=35473) を使用して、簡単でビジュアルな概要を取得できます。図 1 のボックスの色は、ポスターのグループ化に対応しています。

以降では、図に示したテクノロジについて順に説明し、各テクノロジが提供する機能とその使用例を示します。



<h2><a id="models"></a>実行モデル/コンピューティング</h2>

クラウド プラットフォームで行われる最も基本的な項目に、アプリケーションの実行があります。Windows Azure では、この目的で、仮想マシン、クラウド サービス、Web サイト、およびモバイル サービスという 4 つのオプションを用意しています。4 つの Windows Azure 実行モデルには、それぞれの役割があります。

Windows Azure の仮想マシンには、汎用的なオンデマンドのコンピューティング環境が用意されています。クラウド サービスは、スケーラブルで信頼性の高いアプリケーションを低い管理コストで作成するには最適な選択です。Windows Azure の Web サイトには、幅広いアプリケーション、フレームワーク、テンプレートが用意されています。これらを利用することで、大規模でスケーラブルな Web アプリケーションや Web サイトのプレゼンスをすばやく作成し、開発、テスト、操作を効果的に管理できます。また、Windows Azure のモバイル サービスは、クラウドにデータを格納する、ユーザーを認証する、プッシュ通知を送信するなど、ターンキー型の手法を提供することにより、モバイル デバイス用のアプリケーション開発を迅速化します。

必要に応じてこれらのテクノロジを単独で使用したり、組み合わせて使用することで、アプリケーションに適した基盤を構築できます。どのアプローチを選ぶかは、解決しようとしている問題によって異なります。


###仮想マシン###

標準イメージと独自のイメージのどちらからでも、必要に応じて仮想マシンを作成できる機能は非常に便利です。この VM は実行中の場合のみ課金され、分単位で料金をお支払いただけるので、さらに便利なものになっています。一般的にサービスとしてのインフラストラクチャ (IaaS) と呼ばれるこのアプローチは、Windows Azure の仮想マシンが提供する機能です。

VM を作成するには、使用する VHD と VM のサイズを指定します。そして、VM を実行する料金を時間に応じてお支払いいただきます。Windows Azure の仮想マシンには、ストック VHD のギャラリーが用意されています。これには、Windows Server 2008 R2、Windows Server 2012、Windows Server 2008 R2 with SQL Server などのマイクロソフトが提供するオプションに加えて、マイクロソフト パートナーにより提供される Linux イメージも含まれています。さらに、独自の VHD から VM を作成して、それらの VM をギャラリーに追加することもできます。
 
どこから提供されたイメージでも、VM の実行中に加えたあらゆる変更内容を永続的に格納することができます。次にその VHD から VM を作成するときには、保存した内容が取り込まれます。さらに、変更した VHD を Windows Azure の外部にコピーしてローカルで実行することもできます。

Windows Azure VM はさまざまな方法で使用できます。Windows Azure VM を使用して開発とテスト用に低価格のプラットフォームを作成し、必要がなくなった時点で停止できます。さらに、どのような言語とライブラリを使用するアプリケーションでも作成して実行できます。これらのアプリケーションでは、Windows Azure が提供するあらゆるデータ管理オプションを使用できるだけでなく、使用する SQL Server や他の DBMS を選択して、1 つ以上の仮想マシン上で実行することもできます。また、Windows Azure VM を内部設置型のデータセンターの延長として使用して、SharePoint などのアプリケーションを実行することもできます。これをサポートするため、Windows Azure VM で Active Directory を実行して、クラウド内に Windows ドメインを作成することができます。クラウド コンピューティングに対するこの一般的なアプローチを使用することで、さまざまな問題に対応できます。何をするかは、あなたしだいです。

###Web サイト###

クラウドで行われる最も一般的なことの 1 つに、Web サイトと Web アプリケーションの実行があります。Windows Azure の仮想マシンでこれが可能ですが、この場合には 1 つ以上の VM をお客様が管理しなければなりません。Web サイトのみが必要で、その管理作業はだれかに任せたい場合はどうでしょうか。

これこそ Windows Azure の Web サイトが提供する機能です。この実行モデルには、Windows Azure の管理ポータルおよび API を使用した、マネージされた Web 環境が用意されています。既存の Web サイトを変更せずに Windows Azure の Web サイトに移行でき、またクラウドに直接新しいサイトを作成できます。Web サイトが稼動したら、インスタンスを動的に追加または削除し、Windows Azure の Web サイトで要求の負荷分散ができます。Windows Azure の Web サイトには、仮想マシン内で他の Web サイトと共に稼動する共有オプションと、専用の VM でサイトを実行する標準オプションが用意されています。標準オプションは、必要に応じてインスタンスのサイズ (コンピューティング能力) を増強することもできます。

Windows Azure の Web サイトは、企業、開発者、および Web デザイン代理店のいずれにも役立つように設計されています。企業にとっては、Web サイトのプレゼンスを実行するための、管理が簡単で、スケーラビリティに優れ、高度なセキュリティと可用性を備えたソリューションとして利用できます。開発を目的とする場合は、.NET、PHP、Node.js、Python に加え、リレーショナル ストレージのための SQL データベースと MySQL (マイクロソフト パートナーである ClearDB 製) をサポートします。さらに、WordPress、Joomla、Drupal など、一般的なアプリケーションのサポートも多数組み込まれています。パブリック クラウド内で Web サイトと Web アプリケーションを作成するための低価格でスケーラブル、広範な利便性を備えたプラットフォームを提供することが、その目的です。

###クラウド サービス###

多数の同時ユーザーをサポートしながら、管理作業が少なく、停止することがないクラウド アプリケーションを作成したいとします。たとえば、既存のソフトウェア ベンダーが、クラウドに自社製アプリケーションのうちの 1 つのバージョンを作成して、サービスとしてのソフトウェア (SaaS) を導入する場合や、新興ベンダーとして、成長が期待されるコンシューマー アプリケーションを作成する場合が考えられます。Windows Azure 上に作成する場合は、どの実行モデルを使用しますか。

Windows Azure の Web サイトでもこのような Web アプリケーションを作成できますが、一部の制約があります。たとえば、管理アクセス権がなければ、任意のソフトウェアをインストールできません。Windows Azure の仮想マシンを使用すると、管理アクセス権を含む高い柔軟性が得られ、これを使用してスケーラブルなアプリケーションを作成できますが、信頼性と管理に関する多くの事項をお客様自身が処理する必要があります。この場合に必要なのは、必要な制御性を提供する一方で、信頼性と管理に必要なほとんどの作業を処理するオプションです。

これはまさに Windows Azure のクラウド サービスが提供する機能です。このテクノロジは、信頼性が高くスケーラブルで管理作業の少ないアプリケーションをサポートするためのもので、一般的にサービスとしてのプラットフォーム (PaaS) と呼ばれるテクノロジです。これを使用するには、C#、Java、PHP、Python、Node.js など、目的に合ったテクノロジを使用してアプリケーションを作成します。次に、Windows Server のバージョンを実行する仮想マシン (インスタンスと呼ばれます) でコードを実行します。

しかし、これらの VM は Windows Azure の仮想マシンで作成する VM とは異なります。まず、Windows Azure が VM を管理し、オペレーティング システム パッチのインストールやパッチを適用した新しいイメージの自動ロールアウトなどの作業を行います (これは、お客様のアプリケーションは Web ロールまたは Worker ロールのインスタンスで状態を維持せず、次のセクションで説明する Windows Azure データ管理オプションの 1 つで維持する必要があることを意味します)。さらに、Windows Azure が VM を監視し、障害が発生した VM を再起動します。

インスタンスの作成時に、Windows Server をベースとする 2 つのロールのいずれかを選択します。この 2 つのロールの主な違いは、Web ロールのインスタンスは IIS を実行しますが、Worker ロールのインスタンスは IIS を実行しないことです。しかし、どちらも同様に管理され、アプリケーションでは両方を使用することが一般的です。たとえば、Web ロールのインスタンスがユーザーからの要求を受信し、処理のために Worker ロールのインスタンスに渡すことが考えられます。アプリケーションの規模を拡大または縮小するために、Windows Azure でいずれかのロールのインスタンスをさらに作成したり、既存のインスタンスを停止したりすることもできます。また、Windows Azure の仮想マシンの場合と同様に、Web ロールまたは Worker ロールの各インスタンスも使用時間に応じて課金されます。


###モバイル サービス###

Windows Azure のモバイル サービスは、クラウドにデータを格納する、ユーザーを認証する、プッシュ通知を送信するなど、ターンキー型の手法を提供することにより、モバイル デバイス用のアプリケーション開発を迅速化します。
アンドロイド、iOS、HTML/JavaScript、Windows Phone、および Windows ストアのネイティブ クライアント ライブラリは、主要なモバイル プラットフォームすべてで使用できるアプリケーションの作成を容易なものにします。オープンで柔軟性のある REST API によって、ほとんどすべてのプラットフォームのアプリケーションの、モバイル サービス データおよび認証機能も使用できます。1 つのモバイル サービスは、複数のクライアント アプリケーションをサポートできるため、デバイス全体に一貫したユーザー エクスペリエンスを提供できます。

モバイル サービスによって、SQL データベースに格納されているデータの簡単なプロビジョニングと管理、Facebook、Twitter、Microsoft、Google アカウントなどの著名な ID プロバイダーを使用したユーザー認証、およびアプリケーションにプッシュ通知を配信する通知サービスが使用できます。サーバー側コードを使用すると、BLOB ストレージまたは MongoDB のような追加データ ストレージ オプションの使用、SendGrid または Pusher のような Windows Azure ストアからのアドオンの使用、サービス バスおよび Worker ロールなどその他の Windows Azure サービスの使用、さらに内部設置型にシステムへの接続が容易になります。アプリケーションがさらに普及し、監視およびロギングがサポートされると、サービスを拡張することができます。

仮想マシン、クラウド サービスまたは Web サイトを使用して確実にモバイル アプリケーションのバックエンドをビルドすることもできますが、モバイル サービスを選択すると、このような基盤となるサービス コンポーネントの記述に要する時間を大幅に削減できます。


<h2><a id="data"></a>データ管理</h2>

アプリケーションにはデータが必要です。そして、アプリケーションが異なれば必要なデータも異なります。このため、Windows Azure にはデータの格納および管理を行うさまざまな方法が用意されています。

その 1 つは、前に説明したように、Windows Azure の仮想マシンで作成した VM 内で SQL Server や他の DBMS を実行することです (この方法はリレーショナル システムに限定されません。MongoDB や Cassandra などの NoSQL テクノロジも実行できることに注意してください)。自社のデータベース システムの実行は簡単で、その機能はマイクロソフトのデータセンターで行う場合と同じですが、その DBMS の管理作業を処理しなければなりません。Windows Azure には、作業を容易にするため、ほとんどを自動的に管理する 3 つのデータ管理オプションが用意されています。図 2 に、これらのオプションを示します。


![Windows Azure のデータ管理](./media/intro-to-windows-azure/IntroAzure3.png)
 **図 2: Windows Azure には、データ管理のために、リレーショナル ストレージ、スケーラブルな NoSQL テーブル、および非構造化バイナリ ストレージが用意されている。**

これら 3 つのオプションは、リレーショナル ストレージ、大量に発生する可能性のある単純型データへの高速アクセス、および非構造化バイナリ ストレージという異なるニーズにそれぞれ対応しています。これら 3 つのいずれのケースでも、高可用性を提供するために、Windows Azure データセンター内の 3 種類のコンピューター間でデータが自動的に複製されます。さらに、3 つのオプションはすべて、Windows Azure アプリケーションや、内部設置型のデータセンター、ノート PC、携帯電話などの他の場所で実行されるアプリケーションからアクセスできることに注目してください。また、どのような方法で利用する場合でも、すべての Windows Azure データ管理サービスの料金は、格納されたデータの GB 単位の月額料金を含めて、使用量に基づいてお支払いいただきます。

###SQL データベース###

Windows Azure には、リレーショナル ストレージのために SQL データベースが用意されています。以前は SQL Azure と呼ばれていた SQL データベースは、アトミック トランザクション、データの整合性が確保された複数ユーザーによる同時データ アクセス、ANSI SQL クエリ、使い慣れたプログラミング モデルを含む、リレーショナル データベース管理システムのすべての主要機能を備えています。SQL Server と同様、SQL データベースには、Entity Framework、ADO.NET、JDBC、およびその他の使い慣れたデータ アクセス テクノロジを使用してアクセスできます。さらに、SQL データベースはほとんどの T-SQL 言語と、SQL Server Management Studio などの SQL Server ツールをサポートしています。SQL Server (または他のリレーショナル データベース) を使い慣れていれば、SQL データベースも簡単に使用できます。

しかし、SQL データベースは、クラウド内の単なる DBMS ではなく、PaaS サービスです。データとそれにアクセスするユーザーはお客様が管理しますが、ハードウェア インフラストラクチャの管理、データベースとオペレーティング システム ソフトウェアの自動更新などの単純な管理作業は SQL データベースが行います。さらに SQL データベースには、複数のサーバー間にデータを分散するフェデレーション オプションがあります。これは大量のデータを使用するアプリケーションや、複数のサーバーにデータ アクセス要求を分散してパフォーマンスを向上する必要のあるアプリケーションに有効です。

リレーショナル ストレージを必要とする Windows Azure アプリケーションを (3 つのいずれかの実行モデルを使用して) 作成する場合には、SQL データベースが適しています。しかし、クラウドの外部で実行されるアプリケーションもこのサービスを使用できるため、他にも多くのシナリオが存在します。たとえば、SQL データベースに格納されたデータは、デスクトップ、ノート PC、タブレット、携帯電話などのさまざまなクライアント システムからアクセスできます。さらに、レプリケーションによる高可用性が組み込まれているため、SQL データベースを使用することでダウンタイムを低減することができます。

###テーブル###

大量に発生する可能性がある型指定データに高速アクセスする必要があるが、このデータに対して複雑な SQL クエリを実行する必要はない Windows Azure アプリケーションを作成するとします。たとえば、各ユーザーの顧客プロファイル情報を格納する必要があるコンシューマー アプリケーションを作成する場合を考えてみましょう。このアプリケーションは広く利用されるため、大量のデータに対応する必要がありますが、データを格納して単純な方法で取得する以外は、特にデータを処理する必要がありません。このようなシナリオには、Windows Azure テーブルが最適です。

その名前が誤解を招く可能性がありますが、このテクノロジはリレーショナル ストレージを提供しません (実際には、キー/値ストアと呼ばれる NoSQL アプローチの一例です)。代わりに、Windows Azure テーブルでは、アプリケーションが文字列、整数、日付などさまざまな型のプロパティを格納することができます。その後、アプリケーションはプロパティ グループの一意のキーを指定することで、そのグループを取得できます。結合などの複雑な操作はサポートされていませんが、テーブルを使用することで型指定されたデータに高速でアクセスすることができます。さらに、1 つのテーブルに 1 TB のデータを格納できるため、非常にスケーラブルです。また、テーブルはその簡素性に合わせて、通常は SQL データベースのリレーショナル ストレージを使用する場合よりも低価格です。

###BLOB###

データ管理の 3 番目のオプションである Windows Azure BLOB は、非構造化バイナリ データを格納するために設計されています。テーブルと同様に、BLOB は低価格のストレージを提供し、1 つの BLOB に 1 TB のデータを格納できます。たとえば、ビデオ、バックアップ データ、その他のバイナリ情報を格納するアプリケーションで、簡単な低価格のストレージを確保するために BLOB を使用することができます。Windows Azure アプリケーションでは、Windows Azure Drive も使用できるので、BLOB は Windows Azure インスタンスにマウントされた Windows ファイル システムの永続的なストレージを提供できます。アプリケーションからは、通常の Windows ファイルのように見えますが、実際にはコンテンツは BLOB に格納されています。


<h2><a id="networking"></a>ネットワーク</h2>

Windows Azure は、現在米国、ヨーロッパ、およびアジアに広がるいくつかのデータセンター内で実行されています。アプリケーションを実行したり、データを格納したりする際は、これらの中から使用するデータセンターを 1 つ以上選択できます。さらに、次に示すさまざまな手段でこれらのデータセンターに接続できます。

- Windows Azure の仮想ネットワークを使用して、自社の内部設置型ローカル ネットワークを定義された Windows Azure VM セットに接続できます。

- Windows Azure アプリケーションが複数のデータセンターで実行されている場合は、Windows Azure のトラフィック マネージャーを使用して、アプリケーションのインスタンスにユーザーからの要求をインテリジェントにルーティングできます。

図 3 にこれらのオプションを示します。

![Windows Azure のネットワーク](./media/intro-to-windows-azure/IntroAzure4.png)
 **図 3: Windows Azure では、クラウド VPN を作成し、異なるデータセンターにユーザー要求をインテリジェントに分散できます。**

###仮想ネットワーク###

パブリック クラウドの便利な使用方法として、自社のデータセンターの延長として扱う方法があります。VM は必要に応じて作成し、不要になった時点で削除 (および料金のお支払いを停止) できるため、必要なときにのみコンピューティング能力を確保することができます。また、Windows Azure の仮想マシンにより、SharePoint、Active Directory、その他の使い慣れた内部設置型ソフトウェアを実行する VM を作成できるため、既にあるアプリケーションでこのアプローチを利用することができます。

この有用性を高めるためには、これらのアプリケーションがまるで自社のデータセンターで実行されているかのようにユーザーがアプリケーションを扱うことができる必要があります。これを Windows Azure の仮想ネットワークで実現できます。管理者は、VPN ゲートウェイ デバイスを使用して、自社のローカル ネットワークと Windows Azure で実行されている定義された VM グループの間に仮想プライベート ネットワーク (VPN) を設定できます。クラウド VM には独自の IP v4 アドレスを割り当てるため、VM は自社のネットワーク上にあるように見えます。組織内のユーザーは、ローカルで実行されているかのように、VM に含まれるアプリケーションにアクセスできます。

###トラフィック マネージャー###

ユーザーが世界の一地域に限定されている Windows Azure アプリケーションは、1 つの Windows Azure データセンターのみで実行されるでしょう。しかし、世界中にユーザーがいるアプリケーションは、複数のデータセンターか、場合によってはすべてのデータセンターで実行される可能性が高くなります。この 2 番目の状況では、どのようにしてユーザーをアプリケーション インスタンスにインテリジェントに割り当てるかという問題に直面します。ほとんどの場合は、最適な応答時間を確保するために、ユーザーがそれぞれ最も近いデータセンターにアクセスすることが求められます。しかし、そのアプリケーションのコピーがオーバーロード状態になったり、使用できない場合には、別のデータセンターにこのユーザーの要求を自動的にルーティングすることが求められます。これを Windows Azure のトラフィック マネージャーが実現します。

アプリケーションの所有者は、ユーザーからの要求をデータセンターにルーティングする方法を指定するルールを定義し、トラフィック マネージャーを使用してこれらのルールを実施します。たとえば、通常は最も近い Windows Azure データセンターにユーザーをルーティングしますが、既定のデータセンターからの応答時間が特定のしきい値を超過した場合には、別のデータセンターに送信します。多くのユーザーが世界各地に分散しているアプリケーションでは、組み込みのサービスでこのような問題に対処すると効果的です。


<h2><a id="analytics"></a>ビジネス分析</h2>

企業の情報技術の活用方法において、データの分析は最も基本的なものです。クラウド プラットフォームでは、必要に応じて従量課金制のリソース プールを利用できるため、このようなコンピューティングに最適な基盤を確保できます。それに応じて、Windows Azure には、2 つのビジネス分析オプションが用意されています。図 4 に、これらのオプションを示します。

![Windows Azure の分析](./media/intro-to-windows-azure/IntroAzure5.png)
 **図 4: Windows Azure には、ビジネス分析用にビッグ データのレポート機能とサポートが用意されています。**

データの分析には多くの形式があり、これら 2 つのオプションもそれに応じて非常に異なるため、それぞれについて、個別に見てみましょう。

###SQL データベースを使用したレポート###
格納されたデータを使用する最も一般的な方法に、そのデータからレポートを作成することが挙げられます。
 
Windows Azure の仮想マシンで SQL Server レポート サービス (SSRS) を実行すると、簡単にアクセスできるレポート機能を Windows Azure アプリケーションに組み込むことができます。HTML、XML、PDF、Excel のようなさまざまな形式で、テーブル、グラフ、マップ、ゲージなどを盛り込んだレポートを作成できます。

また、SSRS など内部設置型のビジネス インテリジェンス ツールを使用して、SQL データベースのデータを分析することもできます。クライアントには、SQL データベースが SQL Server のように見え、同じテクノロジでどちらも使用することができます。
 

###HDInsight (Hadoop)###

長年にわたって、データ分析のほとんどは、リレーショナル DBMS で構築されたデータ ウェアハウスに格納されたリレーショナル データに対して行われてきました。このようなビジネス分析は現在も重要であり、それは今後も変わらないでしょう。しかし、リレーショナル データベースで対応できないような大量のデータを分析する場合や、データがリレーショナルでない場合はどうでしょうか。たとえば、データセンターのサーバー ログや、センサーからの履歴イベント データなどです。このような場合には、ビッグ データ問題と呼ばれる問題に直面するため、別のアプローチが必要です。

現在、ビッグ データの分析に最もよく使用されているテクノロジは Hadoop です。Apache オープン ソース プロジェクトであるこのテクノロジは、Hadoop 分散ファイル システム (HDFS) を使用してデータを格納し、開発者はデータを分析するための MapReduce ジョブを作成します。HDFS は複数のサーバーにデータを分散し、各サーバーで MapReduce ジョブのチャンクを実行して、ビッグ データを並列処理します。

HDInsight は、Windows Azure の Apache Hadoop ベース サービスの名前です。図 4 が示すように、HDInsight は HDFS がクラスターにデータを格納してそれを複数の VM に分配することができます。また、これらの VM 全体 MapReduce ジョブのロジックを配布します。内部設置型 Hadoop と同様に、データはローカルで (ロジックとそのロジックが処理するデータは同じ VM 内に存在) 並列処理されるため、パフォーマンスが向上します。HDInsight は、BLOB を使用する Windows Azure の Storage Vault (ASV) にデータを格納できます。ASV を使用すると、クラウドにデータを保持したまま使用していない HDInsight クラスターを削除できるため、コスト削減ができます。
 
HDinsight は Hive および Pig を含めた Hadoop エコシステムのその他のコンポーネントも同様にサポートしています。Microsoft が作成したコンポーネントは、Excel を使用する HiveODBC アダプターや Data Explorer など、従来の BI ツールを使用して作成されたデータに対する作業を容易にします。





<h2><a id="messaging"></a>メッセージング</h2>

どのような処理を行う場合でも、コードは頻繁に他のコードと対話する必要があります。状況によって、基本的なキュー メッセージングのみが必要な場合と、より複雑な対話が必要になる場合があります。Windows Azure には、これらの問題を解決するいくつかの手段が用意されています。図 5 に、これらのオプションを示します。

![Windows Azure のメッセージング](./media/intro-to-windows-azure/IntroAzure6.png)
 **図 5: Windows Azure には、アプリケーションを接続するために、キュー、パブリッシュ/サブスクライブ、およびクラウドによる同期接続が用意されている。**

###キュー###

キューは単純な概念で、あるアプリケーションがキューにメッセージを配置すると、そのメッセージがいずれ別のアプリケーションによって読み取られるというものです。アプリケーションにこのように単純なサービスが必要な場合は、Windows Azure キューが最も適しているでしょう。

今日のキューの一般的な使用方法として、同じクラウド サービス アプリケーション内で Web ロールのインスタンスを Worker ロールのインスタンスと通信させることがあります。たとえば、ビデオを共有するために Windows Azure アプリケーションを作成するとします。アプリケーションは、ユーザーがビデオのアップロードと視聴を行うために Web ロール内で実行される PHP コードと、アップロードされたビデオをさまざまな形式に変換する、C# で実装される Worker ロールで構成されています。Web ロールのインスタンスがユーザーから新しいビデオを取得すると、ビデオを BLOB に格納し、キューを介して Worker ロールにメッセージを送信してこの新しいビデオの格納場所を通知します。Worker ロールのインスタンス (どのインスタンスでもかまいません) は、その後、キューからメッセージを読み取り、バックグラウンドで必要なビデオ変換を実行します。アプリケーションをこのように構成することで、非同期処理が可能になるだけでなく、Web ロールと Worker ロールのインスタンス数を別々に変更できるため、アプリケーションの規模を簡単に変更できるようになります。

###サービス バス###

クラウド、データセンター、モバイル デバイスなど、アプリケーションをどこで実行する場合でも、対話が必要です。Windows Azure のサービス バスの目的は、データを交換するほとんどすべての場所でアプリケーションを実行できるようにすることです。

図 5 に示すように、サービス バスはキュー サービスを提供します。ただし、このサービスは、前に説明したキューとは異なります。Windows Azure キューとの違いの例として、サービス バスは、キュー (1 対 1) および「発行とサブスクライブ」のメカニズムの両方が用意されています。発行/サブスクライブでは、アプリケーションはトピックにメッセージを送信でき、他のアプリケーションはこのトピックへのサブスクリプションを作成できます。これにより、アプリケーション セット内で 1 対多コミュニケーションが可能になり、複数の受信者が同じメッセージを読むことができます。さらに、キューが唯一のオプションではなく、サービス バスはリレー サービスを介した直接的なコミュニケーションも可能にし、ファイアウォールを介して安全に対話する手段を確保できます。サービス バス リレーは、ローカルではなくクラウドでホストされるエンドポイントを介してメッセージを交換することによって、アプリケーションの通信ができます。

サービス バスを介して通信するアプリケーションは、他のクラウド プラットフォーム上で実行される Windows Azure アプリケーションやソフトウェアである場合も、クラウドの外部で実行されるアプリケーションである場合もあります。たとえば、自社のデータセンター内のコンピューターで予約サービスを実施する航空会社があるとします。この航空会社は、空港のチェックイン キオスク、予約代理店の端末、さらに顧客の携帯電話など、多くのクライアントにこのサービスを公開する必要があります。このためにサービス バスを使用して、さまざまなアプリケーション間で疎結合方式の対話を作成します。



<h2><a id="caching"></a>Caching</h2>

アプリケーションは、同じデータに繰り返しアクセスする傾向があります。パフォーマンスを向上する 1 つの手段として、アプリケーションの近くにそのデータのコピーを保持して、データの取得に必要な時間を短縮する方法があります。Windows Azure では、この目的のために、Windows Azure アプリケーションによって使用されるデータのメモリ内キャッシュと、ユーザーの近くのディスクに BLOB データをキャッシュするコンテンツ配信ネットワーク (CDN) という 2 つのサービスを用意しています。図 6 に、その両方を示します。

![Windows Azure の Caching](./media/intro-to-windows-azure/IntroAzure7.png)
 **図 6: Windows Azure アプリケーションはメモリ内にデータをキャッシュでき、BLOB のコピーを世界中のサイトでキャッシュできる。**

###Caching###

SQL データベース、テーブル、BLOB という Windows Azure のデータ管理サービスのいずれかに格納されたデータには高速アクセスできますが、メモリに格納されたデータへのアクセスはさらに高速です。このため、頻繁にアクセスするデータのコピーをメモリ内に維持することで、アプリケーション パフォーマンスを向上できます。これには、Windows Azure のメモリ内 Caching を使用できます。

クラウド サービス アプリケーションは、このキャッシュにデータを格納し、その後は永続的なストレージにアクセスしなくても、直接データを取得できます。図 6 に示すように、アプリケーションの VM 内にキャッシュを維持することも、Caching 専用の VM が提供するキャッシュを使用することもできます。いずれの場合も、キャッシュを分散して、中に含まれるデータを Windows Azure データセンターの複数の VM に分散することができます。

たとえば、製品カタログを繰り返し読み取るアプリケーションでは、必要なデータをすばやく取得できるため、このようなキャッシュの使用が有効です。このテクノロジは、ロックもサポートしているため、読み取り/書き込みデータにも読み取り専用データにも使用できます。さらに、ASP.NET アプリケーションでは、構成を変更するだけで、サービスを使用してセッション データを格納できます。

###CDN###

世界各地のユーザーがアクセスする BLOB データを格納する必要があるとします。例としては、ワールド カップの最新の試合のビデオ、ドライバーの更新プログラム、一般的な電子ブックなどがあります。このために、複数の Windows Azure データセンターにデータのコピーを格納することができますが、ユーザーが多い場合は、十分でない可能性があります。より優れたパフォーマンスを得るには、Windows Azure CDN を使用します。

世界中に数十の CDN サイトがあり、それぞれが Windows Azure BLOB のコピーを格納できます。世界のある地域のユーザーが初めて特定の BLOB にアクセスすると、中に含まれている情報が Windows Azure データセンターからその Geo のローカル CDN ストレージにコピーされます。それ以降のその地域からのアクセスには、CDN にキャッシュされた BLOB コピーが使用されるため、近くの Windows Azure データセンターまでアクセスする必要がありません。この結果、ユーザーは世界中のどこからでも、頻繁にアクセスするデータに高速アクセスできるようになります。



<h2><a id="identity"></a>ID</h2>

ほとんどのアプリケーションには、ID の処理が含まれます。たとえば、アプリケーションはユーザーがだれかを認識することで、そのユーザーとの対話方法を決定します。マイクロソフトでは、このために Windows Azure Active Directory を提供しています。

ほとんどのディレクトリ サービスと同様、Windows Azure Active Directory は、ユーザーとユーザーが所属する組織に関する情報を格納しています。これにより、ユーザーはログインでき、ID を証明するためにアプリケーションに提示するトークンが提供されます。さらに、ローカル ネットワークで内部設置型として実行される Windows Server Active Directory とのユーザー情報の同期も可能です。Windows Azure Active Directory により使用されるメカニズムとデータ形式は、Windows Server Active Directory とは異なりますが、実行する機能はきわめて似ています。

ここで重要な点は、Windows Azure Active Directory は主にクラウド アプリケーションで使用するために設計されているということです。Windows Azure Active Directory は、Windows Azure やその他のクラウド プラットフォームで実行するアプリケーションのほか、Office 365 など、マイクロソフトのクラウド アプリケーションでも使用されます。しかし、Windows Azure の仮想マシンや Windows Azure の仮想ネットワークを使用してデータセンターをクラウドに拡張する場合には、Windows Azure Active Directory は適していません。代わりに、既に説明したように、クラウド VM で Windows Server Active Directory を実行することをお勧めします。

アプリケーションが中に含まれる情報にアクセスできるようにするため、Windows Azure Active Directory には、Windows Azure Active Directory Graph と呼ばれる REST ベースの API が用意されています。この API を使用すると、任意のプラットフォームで実行されるアプリケーションからディレクトリ オブジェクトとこれらオブジェクトのリレーションシップにアクセスすることができます。たとえば、承認されたアプリケーションは、ユーザー、ユーザーが属するグループ、およびその他の情報を得るために、この API を使用することが考えられます。アプリケーションは、ユーザー間のリレーションシップ (ソーシャル グラフ) を確認し、ユーザー間の接続をよりインテリジェントに処理することができます。

このサービスのもう 1 つの機能である Windows Azure Active Directory のアクセス制御は、アプリケーションが Facebook、Google、Windows Live ID やその他の一般的な ID プロバイダーから ID 情報を簡単に取得できるようにします。アプリケーションがこれらの各プロバイダーで使用されるさまざまなデータ形式とプロトコルを認識するのではなく、アクセス制御がこれらのすべてを 1 つの共通形式に変換します。さらに、アプリケーションは 1 つ以上の Active Directory ドメインからのログインを受け入れることができるようになります。たとえば、SaaS アプリケーションを提供するベンダーは、Windows Azure Active Directory のアクセス制御を使用して、各顧客のユーザーにアプリケーションへのシングル サインオンを提供できます。

ディレクトリ サービスは、内部設置型コンピューティングの中核的な土台を構成し、当然のことながら、クラウドでも重要な役割を担います。

<h2><a id="media"></a>メディア</h2>

ビデオは、現在のインターネット トラフィックの大きな部分を占めており、その割合はさらに大きくなっていきます。しかし、Web でビデオを提供するのは簡単ではありません。エンコーディング アルゴリズム、ユーザー画面のディスプレイ解像度など、一定しない要素がたくさんあります。さらに、多くの人がオンライン ムービーを観ようとする土曜の夜など、ビデオの需要は急増することがよくあります。

その人気を考えると、今後はビデオを使用した新しいアプリケーションが数多く作成されることになるでしょう。しかし、どのアプリケーションでも同じ問題を解決する必要があり、アプリケーションごとにそれらの問題を解決するのは合理的ではありません。多くのアプリケーションにより使用される共通の解決策を提供するプラットフォームを作成するアプローチの方が優れています。そして、このプラットフォームをクラウドにビルドすることにはいくつかの明らかな利点があります。従量課金制で広範囲に利用してもらうことができ、ビデオ アプリケーションがよく直面する変動に対処することもできます。

Windows Azure のメディア サービスはこの問題に対処します。ビデオや他のメディアを使用するアプリケーションを作成および実行する担当者の業務をシンプルにする一連のクラウド コンポーネントが用意されています。図 7 に、テクノロジを示します。

![Windows Azure のメディア サービス](./media/intro-to-windows-azure/IntroAzure8.png)
 **図 7: メディア サービスは、世界中の顧客にビデオや他のメディアを提供するアプリケーションのプラットフォームです。**


図が示すように、メディア サービスにはビデオや他のメディアと連動する一連のアプリケーション コンポーネントが用意されています。たとえば、ビデオをメディア サービス (Windows Azure BLOB における格納場所) にアップロードするためのメディア取り込みコンポーネント、さまざまなビデオ形式やオーディオ形式をサポートするエンコーディング コンポーネント、デジタル権利管理を行うコンテンツ保護コンポーネント、ビデオ ストリームに広告を挿入するコンポーネント、ストリーミングを行うコンポーネントなどが用意されています。マイクロソフト パートナーがプラットフォーム向けのコンポーネントを提供し、マイクロソフトがそれらのコンポーネントを代理で配布して請求することもあります。

このプラットフォームを使用するアプリケーションは、Windows Azure などで実行できます。たとえば、ビデオ制作会社向けのデスクトップ アプリケーションでは、ユーザーがメディア サービスにメディアをアップロードし、さまざまな方法で処理できることがあります。または、Windows Azure で実行されるクラウド ベースのコンテンツ管理サービスが、ビデオを処理および配信する点でメディア サービスに依存していることがあります。実行する場所や内容にかかわらず、各アプリケーションは使用する必要があるコンポーネントを選択し、RESTful インターフェイスを通してアクセスします。

アプリケーションは、生成データを配信するために、Windows Azure CDN や他の CDN を使用したり、ユーザーに直接データを送信することができます。配信方法が何であれ、メディア サービスを使用して作成されたビデオは、Windows、Macintosh、HTML 5、iOS、Android、Windows Phone、Flash、Silverlight など、さまざまなクライアント システムにより使用される可能性があります。その目的は、最新のメディア アプリケーションの作成を容易にすることにあります。

メディア サービスの詳細に関するビジュアルな表示については、[Windows Azure のメディア サービス ポスター][Windows Azure Media Services Poster]をダウンロードしてください。


<h2><a id="HPC"></a>ハイパフォーマンス コンピューティング</h2>

クラウド プラットフォームを使用する最も魅力的な方法に、ハイパフォーマンス コンピューティング (HPC) があります。HPC の本質は、複数のマシンで同時にコードを実行することです。Windows Azure では、これは、多くの仮想マシンを同時に実行し、すべてを並列で処理して問題を解決することを意味します。このためには、アプリケーションをスケジュールする、つまり、これらのインスタンス間に処理を分散するための手段が必要になります。Windows Azure には、これを可能にするため HPC Scheduler が用意されています。

このコンポーネントは、業界標準の Message Passing Interface (MPI) を使用するために構築された HPC アプリケーションに使用できます。このタイプのアプリケーションには、自動車の衝突シミュレーションなどの有限要素解析を行うソフトウェアをはじめとして、多くのものがあります。HPC Scheduler は、モンテ カルロ シミュレーションなどの、いわゆる驚異的並列アプリケーションにも使用できます。どのような問題に対応する場合でも、もたらされる価値は等しく、HPC Scheduler は、多数の Windows Azure の仮想マシンの間で並列コンピューティング処理をスケジュールするという複雑な問題に対処します。その目的は、クラウド内で実行される HPC アプリケーションの作成を容易にすることにあります。

<h2><a id="commerce"></a>コマース</h2>

サービスとしてのソフトウェアの登場により、アプリケーションの作成方法が変わろうとしています。さらに、アプリケーションの販売方法も変わろうとしています。SaaS アプリケーションはクラウドに存在するため、当然ながら潜在的な顧客はソリューションをオンラインで探します。この変化は、アプリケーションだけでなくデータにも当てはまります。ユーザーは、商用データセットもクラウドで探すはずです。図 8 に示すように、マイクロソフトは、[Windows Azure Marketplace](http://datamarket.azure.com/) および [Windows Azure ストア](http://www.windowsazure.com/ja-jp/store/overview/)によってどちらの懸念事項にも対応しています。

![Windows Azure Commerce](./media/intro-to-windows-azure/IntroAzure9.png)
 **図 8: Windows Azure Marketplace および Windows Azure ストアでは、Windows Azure アプリケーションと商用データセットを検索して購入することができます。**

これら 2 つの違いは、Marketplace が Windows Azure の管理ポータルの外にあり、ストアはポータルからアクセスできることです。潜在的な顧客は、いずれかを検索してニーズに合う Windows Azure アプリケーションを見つけ、サインアップ後アプリケーションの作成者、または直接 Marketplace またはストアから、アプリケーションを入手して使用することができます。顧客は、人口統計データ、財務データ、地図データなどの商用データセットも、いずれかで検索することができます。目的のデータが見つかった場合、そのベンダーから、または Marketplace やストアの Web サイト、場合によっては管理ポータルから直接そのデータにアクセスできます。アプリケーションで Marketplace 経由で Bing Search API を使用すると、顧客が Web 検索の結果にアクセスできるようにすることもできます。


<h2><a id="sdk"></a>SDK</h2>

2008 年、最初に発表されたプレリリース版の Windows Azure では .NET 開発のみがサポートされていました。しかし、現在ではかなり多くの言語で Windows Azure アプリケーションを作成できます。マイクロソフトでは現在、.NET、Java、PHP、Node.js、Ruby、Python 向けの言語固有の SDK を提供しています。C++ など、任意の言語の基本的なサポートを提供する汎用 Windows Azure SDK も用意されています。

これらの SDK では、Windows Azure アプリケーションを構築、展開、および管理できます。www.windowsazure.com または GitHub から入手でき、Visual Studio や Eclipse と共に使用できます。Windows Azure には、Linux システムおよび Macintosh システムから Windows Azure にアプリケーションを展開するためのツールなど、開発者がエディターや開発環境で使用できるコマンド ライン ツールも用意されています。

Windows Azure アプリケーションを構築できるだけでなく、これらの SDK には、Windows Azure サービスを使用するクラウドの外で実行されるソフトウェアを作成できるクライアント ライブラリも用意されています。たとえば、Windows Azure BLOB に依存するホストで実行されるアプリケーションを構築したり、Windows Azure 管理インターフェイスを通して Windows Azure アプリケーションを展開するツールを作成したりすることができます。


<h2><a id="start"></a>はじめに</h2>

これで全体像を把握できたため、次のステップは最初の Windows Azure アプリケーションを記述することです。言語を選択して[適切な SDK を入手し](http://www.windowsazure.com/ja-jp/downloads/)、作成してみましょう。クラウド コンピューティングはこれからの基本です。今すぐ始めましょう。



[Windows Azure のメディア サービス ポスター]: http://www.microsoft.com/ja-jp/download/details.aspx?id=38195

