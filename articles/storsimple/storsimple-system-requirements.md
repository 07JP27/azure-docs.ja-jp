<properties 
   pageTitle="StorSimple のシステム要件 | Microsoft Azure" 
   description="Azure StorSimple ソリューションでのソフトウェア、高可用性、およびネットワークの要件およびベスト プラクティスについて説明します。" 
   services="storsimple" 
   documentationCenter="NA" 
   authors="alkohli" 
   manager="carolz" 
   editor=""/>

<tags
   ms.service="storsimple"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="TBD" 
   ms.date="09/24/2015"
   ms.author="alkohli"/>

# StorSimple ソフトウェア、高可用性、ネットワークの要件

## 概要

Microsoft Azure StorSimple へようこそ。この記事では、StorSimple デバイスおよび StorSimple デバイスにアクセスするストレージ クライアントにおける重要なシステム要件とベスト プラクティスについて説明します。要件は次のとおりです。

- **ストレージ クライアントのソフトウェア要件** - サポートされているオペレーティング システムと、これらのオペレーティング システムに関する追加要件について説明します。
- **StorSimple の高可用性の要件** - StorSimple デバイスおよびホスト コンピューターの高可用性要件およびベスト プラクティスについて説明します。 
- **、StorSimple デバイスのネットワーク要件** - iSCSI、クラウド、または管理トラフィックを使用できるようにするため、ファイアウォールで開いておく必要があるポートについての情報を提供します。

Azure StorSimple システムをデプロイする前に以下の情報を慎重に確認します。さらにデプロイと後続の操作中にも必要に応じて以下の情報を参照することをお勧めします。

## ストレージ クライアントのソフトウェア要件 

次のソフトウェア要件は、StorSimple デバイスにアクセスするストレージ クライアントに適用されます。

| サポートされているオペレーティング システム | 必須のバージョン | 詳細情報と注意事項 |
| --------------------------- | ---------------- | ------------- |
| Windows Server | 2008R2 SP1、2012、2012R2 |<ul><li>StorSimple iSCSI ボリュームは、次の Windows ディスク タイプで使用する場合にのみサポートされます。<ul><li>ベーシック ディスク上のシンプル ボリューム</li><li>ダイナミック ディスク上のミラー化されたシンプル ボリューム</li></ul>ミラー化されたダイナミック ディスクをバックアップ/復元する場合、およびアプリケーション整合性バックアップを実行する場合は、Windows Server 上で StorSimple Snapshot Manager を使用する必要があります。</li><li>StorSimple Snapshot Manager は、Windows Server 2008 R2 SP1 (64 ビット)、Windows 2012 R2、および Windows Server 2012 でのみサポートされます。<ul><li>Window Server 2012 を使用する場合は、StorSimple Snapshot Manager をインストールする前に .NET 3.5 ～ 4.5 をインストールしておく必要があります。</li><li>Windows Server 2008 R2 SP1 を使用する場合は、StorSimple Snapshot Manager をインストールする前に Windows Management Framework 3.0 をインストールしておく必要があります。</li></ul></li><li>Windows Server 2012 の仮想プロビジョニング機能および ODX 機能は、StorSimple iSCSI ボリュームを使用する場合にサポートされます。<ul><li>StorSimple で作成できるのは、仮想プロビジョニングされたボリュームのみです。完全にプロビジョニングされたボリュームまたは部分的にプロビジョニングされたボリュームについては作成できません。</li><li>仮想プロビジョニングされたボリュームを再フォーマットと時間がかかる場合があります。再フォーマットを行うのではなく、ボリュームを削除してから新しいボリュームを作成することをお勧めします</li><li>ボリュームの再フォーマットを行いたい場合:<ul><li>領域の回復の遅延を避けるために、再フォーマットする前に次のコマンドを実行します <br>`fsutil behavior set disabledeletenotify 1`</br></li><li>フォーマットが完了したら、次のコマンドを使用して領域の回復を再度有効にします。<br>`fsutil behavior set disabledeletenotify 0`</br></li><li>KB2870270 に説明されている Windows Server 2012 修正プログラムを Windows Server コンピューターに適用します。</li></ul></li></ul><li>SharePoint 用 StorSimple アダプターは、SharePoint 2010 および SharePoint 2013 でのみサポートされます。RBS には SQL Server Enterprise Edition のバージョン 2008 R2 または 2012が必要です。</li></ul>|
| VMware | iSCSI クライアントとして VMware vSphere 5.1 でテスト | VAAI ブロック機能は、StorSimple デバイス上の VMware vSphere v.5.1 でテストされます。 
| Linux RHEL/CentOS | Open-iSCSI イニシエーター バージョン 5 および 6 での Linux iSCSI クライアントのサポート | open-iSCSI イニシエーターのみでサポートされます。 |
| Linux | SUSE Linux 11 | |
 >[AZURE.NOTE]社内で行われるテストが限定的であるため、IBM AIX は現在 StorSimple ではサポートされていません。

## StorSimple の高可用性の要件

StorSimple ソリューションに含まれるハードウェア プラットフォームには、エンタープライズ レベルの可用性と信頼性の機能があります。これらの機能は、可用性が高くフォールト トレラントなストレージ インフラストラクチャの基礎をデータセンターで実現します。ただし、Azure StorSimple ソリューションの可用性が得られるようにするには、特定の要件とベスト プラクティスに準拠する必要があります。Azure StorSimple をデプロイする前に、StorSimple デバイスおよび接続されているホスト コンピューターについて次の要件とベスト プラクティスを慎重に確認します。

### StorSimple デバイスの高可用性の要件と手順

StorSimple デバイスの高可用性を確保するには、次の情報を慎重に確認します。

#### 電源および冷却モジュール (PCM)

StorSimple デバイスには、冗長なホットスワップ型の PCM が含まれています。各 PCM はシャーシ全体にサービスを提供するのに十分な容量を備えています。高可用性を確保するには、PCM を両方とも取り付ける必要があります。

- 1 つの電源で障害が発生した場合に可用性を確保するには、PCM をそれぞれ別々の電源に接続しておきます。

- PCM で障害が発生した場合は、すぐに交換を要求します。

- 故障した PCM は必ず、交換部品の取り付け準備ができてから取り外します。

- 両方の PCM を同時に取り外さないでください。PCM モジュールには、バッテリが含まれています。両方の PCM を取り外すと、バッテリで保護されたシャットダウンが行われなくなります。

#### コントローラー モジュール

StorSimple デバイスには、冗長なホットスワップ型のコントローラー モジュールが含まれています。コントローラー モジュールは、アクティブ/パッシブで動作します。どのような場合も、1 つのコントローラー モジュールがアクティブでサービスを提供するのに対し、もう 1 つのコントローラー モジュールはパッシブになります。アクティブ コントローラー モジュールが故障したか取り外された場合は、パッシブ コントローラー モジュールの電源が入って動作可能になります。各コントローラー モジュールには、シャーシ全体にサービスを提供するのに十分な容量があります。高可用性を確保するには、両方のコントローラー モジュールを取り付ける必要があります。

- 両方のコントローラー モジュールが常に取り付けられている状態にします。

- コントローラー モジュールで障害が発生した場合は、すぐに交換を要求します。

- 故障したコントローラーは必ず、交換部品の取り付け準備ができてから取り外します。長時間モジュールを取り外すと通気に影響し、その結果、システムの冷却に影響します。

- 両方のコントローラー モジュールへのネットワーク接続が同じであり、接続したネットワーク インターフェイスのネットワーク構成が同じになっていることを確認します。

- コントローラー モジュールの障害または交換が必要な場合は、障害状態にあるコントローラー モジュールを交換する前に、もう 1 つのコントローラー モジュールがアクティブ状態であることを確認します。

- 両方のコントローラー モジュールを同時に取り外さないでください。

- コントローラー フェールオーバーが進行中の場合、スタンバイ コントローラー モジュールをシャットダウンしたり、シャーシから取り外したりしないでください。

- コントローラー フェールオーバー後、いずれかのコントローラー モジュールを取り外す前に少なくとも 5 分待機します。

#### ネットワーク インターフェイス

StorSimple デバイス コントローラー モジュールはそれぞれ、1 ギガ ビットのイーサネット ネットワーク インターフェイスを 4 つと、10 ギガビットのイーサネット ネットワーク インターフェイスを 2 つ備えています。

- 両方のコントローラー モジュールへのネットワーク接続が同じであり、コントローラー モジュール インターフェイスが接続されているネットワーク インターフェイスのネットワーク構成が同じになっていることを確認します。

- ネットワーク デバイスで障害が発生した場合にサービスの可用性を確保できるようにするには、ネットワーク接続をそれぞれ異なる複数のスイッチでデプロイします。

- 唯一のまたは最後に残った iSCSI 対応インターフェイス (IP アドレスが割り当てられた) のプラグを抜く場合は、そのインターフェイスをまず無効にしてから、ケーブルを外します。先にインターフェイスのプラグを抜くと、アクティブ コントローラーはパッシブ コントローラーにフェール オーバーします。パッシブ コントローラーの対応するインターフェイスもプラグが抜かれている場合は、両方のコントローラーが複数回再起動してから 1 つのコントローラーに落ち着きます。

- 少なくとも 2 つのデータ インターフェイスを各コントローラー モジュールからネットワークに接続します。

- 2 つの 10 GbE インターフェイスを有効にした場合は、これらをそれぞれ異なる複数のスイッチでデプロイします。

- 可能であれば、サーバー上で MPIO を使用して、サーバーがリンク、ネットワーク、またはインターフェイスの障害に耐え得るようにします。

高可用性および高パフォーマンスを実現するためのデバイスのネットワーク接続方法の詳細については、「[StorSimple 8100 デバイスの取り付け](storsimple-8100-hardware-installation.md#cable-your-storsimple-8100-device)」または「[StorSimple 8600 デバイスの取り付け](storsimple-8600-hardware-installation.md#cable-your-storsimple-8600-device)」を参照してください。

#### SSD と HDD

StorSimple デバイスには、ミラー化されたスペースを使用して保護されているソリッド ステート ドライブ (SSD) とハード ディスク ドライブ (HDD) が含まれ、HDD にはホットスペアが提供されます。ミラー化されたスペースを使用すると、デバイスは 1 台または複数台の SSD または HDD で障害が発生してもそれを許容できます。

- すべての SSD と HDD モジュールが取り付けられていることを確認します。

- SSD または HDD で障害が発生した場合は、すぐに交換を要求します。

- SSD または HDD の障害または交換が必要な場合、交換が必要な SSD または HDD のみを取り外すようにします。

- どの時点でもシステムから複数台の SSD または HDD を取り外さないでください。

- 交換中は、SSD と HDD のドライブの **[メンテナンス]** ページで **[ハードウェア状態]** を監視します。緑のチェック状態は、ディスクが正常または OK であると示しています。一方、赤の感嘆符は障害中の SSD または HDD を示しています。

- 特定の種類のディスク (HDD、SSD) での 2 つ以上のエラー、または短時間の連続したエラーは、システムの誤作動やデータ損失を発生させる可能性があります。その場合は、テクニカル サポートに問い合わせてください。システム エラーに備えて、保護する必要があるすべてのボリュームのクラウド スナップショットを構成することもお勧めします。

#### EBOD エンクロージャ

StorSimple デバイス モデル 8600 には、主エンクロージャに加えて、Extended Bunch of Disks (EBOD) エンクロージャが含まれています。EBOD には、EBOD コントローラーと、ミラー化されたスペースを使用して保護されるハード ディスク ドライブ (HDD) が含まれます。ミラー化されたスペースを使用すると、デバイスは 1 台または複数台の HDD で障害が発生してもそれを許容できます。EBOD エンクロージャは、冗長な SAS ケーブルを使用して、主エンクロージャに接続されます。

- 両方の EBOD エンクロージャ コントローラー モジュール、両方の SAS ケーブル、およびすべてのハード ディスク ドライブは必ず常時取り付けておきます。

- EBOD エンクロージャ コントローラー モジュールまたは HDD で障害が発生した場合は、すぐに交換を要求します。

- EBOD エンクロージャ コントローラー モジュールで故障が発生した場合は、該当するモジュールを交換する前に、もう 1 つのコントローラー モジュールがアクティブ状態であることを確認します。

- HDD で障害が発生したか、または HDD の交換が必要な場合は、交換が必要な HDD のみを取り外すようにします。ディスクとアレイが正常であることを示すまで、HDD を取り外さないでください。

- どの時点でもシステムから複数台の HDD を取り外さないでください。

- EBOD コントローラー モジュールまたは HDD の交換中に、**[メンテナンス]**、**[ハードウェア状態]** の順にアクセスして、StorSimple Manager サービスの関連コンポーネントの状態を継続して監視します。

- SAS ケーブルの障害または交換が必要な場合 (Microsoft サポートはこのような判断にかかわる必要があります)、交換が必要な SAS ケーブルのみを取り外すようにします。

- どの時点でも両方の SAS ケーブルをシステムから同時に取り外さないでください。

### ホスト コンピューターの高可用性の要件

StorSimple デバイスに接続されているホストの高可用性を確保するには、以下の要件とベスト プラクティスを慎重に確認してください。

- [2 ノード ファイル サーバー クラスター構成][1]を使用した StorSimple を構成します。単一障害点を削除し、ホスト側の冗長性を構築することにより、ソリューション全体の可用性が向上します。

- ストレージ コントローラーのフェールオーバー中の高可用性を目的として、Windows Server 2012 (SMB 3.0) で利用できる継続的可用性 (CA) 共有を使用します。ファイル サーバー クラスターと Windows Server 2012 との継続的可用性の共有を構成するための追加情報については、この[ビデオ メモ](http://channel9.msdn.com/Events/IT-Camps/IT-Camps-On-Demand-Windows-Server-2012/DEMO-Continuously-Available-File-Shares)を参照してください。

## StorSimple デバイスのネットワーク要件

StorSimple デバイスはロックされたデバイスです。ただし、iSCSI、クラウド、または管理トラフィックを許可するには、ファイアウォールでポートを開く必要があります。次の表は、ファイアウォールで開く必要があるポートの一覧です。この表では、*イン*または*受信*はデバイスにアクセスするクライアント要求が入ってくる方向を意味します。*アウト*または*送信*は StorSimple デバイスがデプロイを超えて外部に (たとえば、インターネットに) データを送信する方向を意味します

| ポート番号<sup>1,2</sup> | インまたはアウト | ポート範囲 | 必須 | メモ |
|------------------------|-----------|------------|----------|-------| 
|TCP 80 (HTTP)<sup>3</sup>| アウト | WAN | いいえ |<ul><li>送信ポートは、更新プログラムを取得するためにインターネット アクセスに使用されます。</li><li>送信 Web プロキシはユーザーが構成可能です。</li><li>システムの更新を許可するには、コントローラーの固定 IP アドレスに対してこのポートも開いている必要があります。</li></ul> |
|TCP 443 (HTTPS)<sup>3</sup>| アウト | WAN | あり |<ul><li>送信ポートは、クラウド内のデータにアクセスするために使用されます。</li><li>送信 Web プロキシはユーザーが構成可能です。</li><li>システムの更新を許可するには、コントローラーの固定 IP アドレスに対してこのポートも開いている必要があります。</li></ul>|
|UDP 53 (DNS) | アウト | WAN | 場合によっては、メモを参照してください。 |このポートは、インターネット ベースの DNS サーバーを使用する場合にのみ必要です。 |
| UDP 123 (NTP) | アウト | WAN | 場合によっては、メモを参照してください。 |このポートは、インターネット ベースの NTP サーバーを使用する場合にのみ必要です。 |
| TCP 9354 | アウト | WAN | 場合によっては、メモを参照してください。 |送信ポートは、StorSimple Manager サービスと通信するために StorSimple デバイスによって使用されます。このポートは、現在のネットワークが HTTP 1.1 を使用したインターネット接続をサポートしていない場合 (たとえば、HTTP 1.0 ベースのプロキシ サーバーを使用している場合)、必須です。<br> プロキシ サーバー経由で接続する場合の詳細については、[サービス バス要件](https://msdn.microsoft.com/library/azure/ee706729.aspx)に関するページを参照してください。 |
| 3260 (iSCSI) | [ | LAN | いいえ | このポートは、iSCSI を介してデータにアクセスするために使用されます。|
| 5985 | [ | LAN | いいえ | 受信ポートは、StorSimple デバイスと通信するために StorSimple Snapshot Manager によってを使用されます。<br>このポートは、HTTP 経由で Windows PowerShell for StorSimple にリモート接続する場合にも使用されます。 |
| 5986 | [ | LAN | いいえ | このポートは、HTTPS 経由で Windows PowerShell for StorSimple にリモート接続する場合にも使用されます。 |

<sup>1</sup> 受信ポートがパブリック インターネットで開かれている必要はありません。

<sup>2</sup> 複数のポートでゲートウェイ構成が運ばれる場合、送信トラフィックの順序は、以下に説明するポート ルーティング順序で決定されます。

<sup>3</sup> StorSimple デバイスのコントローラーの固定の IP アドレスがルーティング可能でインターネットに接続可能である必要があります。固定の IP アドレスは、デバイスに更新プログラムを提供するために使用されます。デバイスのコントローラーが固定の IP アドレスを使用してインターネットに接続できない場合は、StorSimple デバイスを更新できません。

### ポートのルーティング

ポートのルーティングは、StorSimple デバイスで実行されているソフトウェアのバージョンによって異なります。

- デバイスが更新プログラム 1 より前のソフトウェア バージョン (リリース GA、0.1、0.2、または 0.3) を実行している場合、ポート ルーティングは次のように決定されます。

     最後に構成した 10 GbE ネットワーク インターフェイス > その他の 10 GbE ネットワーク インターフェイス > 最後に構成した 1 GbE ネットワーク インターフェイス > その他の 1 GbE ネットワーク インターフェイス

- デバイスが更新プログラム 1 を実行している場合、ポート ルーティングは次のように決定されます。

     DATA 0 > 最後に構成した 10 GbE ネットワーク インターフェイス > その他の 10 GbE ネットワーク インターフェイス > 最後に構成した 1 GbE ネットワーク インターフェイス > その他の 1 GbE ネットワーク インターフェイス

更新プログラム 1 では、DATA 0 のルーティング メトリックが最低値になります。そのため、すべてのクラウド トラフィックが DATA 0 を介してルーティングされます。StorSimple デバイス上に複数のクラウド対応ネットワーク インターフェイスがある場合は、これをメモしておきます。

### ネットワークのベスト プラクティス

StorSimple ソリューションの最適なパフォーマンスを得るためには、上記のネットワーク要件に加えて、次のベスト プラクティスに従ってください。

- StorSimple デバイスで専用の 40 Mbps 帯域幅 (またはそれ以上) が常に利用できるようにします。この帯域幅はその他のアプリケーションと共有できません。

- インターネットへのネットワーク接続を常に利用できるようにします。インターネット接続が途切れるなど、デバイスのインターネット接続が信頼できないと、結果的にサポートされない構成になります。

- iSCSI とクラウドのアクセスに対してデバイスに専用のネットワーク インターフェイスを置くことで、iSCSI とクラウド トラフィックを分離します。詳細については、StorSimple デバイスで[ネットワーク インターフェイスを変更する](storsimple-modify-device-config.md#modify-network-interfaces)方法を参照してください。

- ネットワーク インターフェイスには、Link Aggregation Protocol (LACP) 構成を使用しないでください。このような構成はサポートされていません。

## 次のステップ

- [StorSimple システムの制限の詳細](storsimple-limits.md)
- [StorSimple ソリューションをデプロイする方法](storsimple-deployment-walkthrough.md)
 
<!--Reference links-->
[1]: https://technet.microsoft.com/library/cc731844(v=WS.10).aspx

<!---HONumber=Oct15_HO3-->