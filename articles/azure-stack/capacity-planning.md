---
title: Azure Stack のためのキャパシティ プランニング | Microsoft Docs
description: Azure Stack デプロイのためのキャパシティ プランニングについて説明します。
services: azure-stack
documentationcenter: ''
author: jeffgilb
manager: femila
editor: ''
ms.assetid: ''
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/18/2018
ms.author: jeffgilb
ms.reviewer: prchint
ms.openlocfilehash: ad76e19e324c29c277e72f1e93d2b505984b50ba
ms.sourcegitcommit: ce526d13cd826b6f3e2d80558ea2e289d034d48f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/19/2018
ms.locfileid: "46369767"
---
# <a name="azure-stack-capacity-planning"></a>Azure Stack のキャパシティ プランニング
Azure Stack ソリューションを評価するときに、Azure Stack クラウドのキャパシティ全体に直接影響するハードウェア構成を選択することができます。 CPU、メモリ密度、ストレージ構成、全体的なソリューションの規模 (つまり、サーバー数) といった従来の選択肢があります。 以前の仮想化ソリューションとは異なり、これらのコンポーネントを単純に計算して使用可能なキャパシティを決定することはできません。 その 1 つ目の理由は、Azure Stack が、ソリューション自体の中でインフラストラクチャまたは管理コンポーネントをホストするように設計されているためです。 2 つ目の理由は、ソリューションのキャパシティの一部が、回復性をサポートするために予約されることです。つまり、テナントのワークロードの中断を最小限に抑える方法で、ソリューションのソフトウェアが更新されます。

> [!IMPORTANT]
> キャパシティ プランニングの情報と、付属のスプレッドシートがガイドとしてのみ提供されており、Azure Stack の計画と構成を決定するのに役立ちます。 これらは、独自の調査や分析に代わるものとしては利用できません。 

## <a name="compute-and-storage-capacity-planning"></a>コンピューティングおよびストレージ容量の計画
Azure Stack ソリューションは、コンピューティング、ネットワーク、およびストレージのハイパーコンバージド クラスターとして構築されています。 これにより、可用性とスケーラビリティを提供する方法で、クラスター (Azure Stack 用のスケール ユニットと呼ばれる) 内のすべてのハードウェアのキャパシティを効率的に使用したり、共有したりすることができます。 すべてのインフラストラクチャ ソフトウェアは一連の仮想マシン (VM) 内でホストされ、テナント VM と同じ物理サーバーを共有します。 その後、すべての VM はスケール ユニットの Windows Server クラスタリング テクノロジと個々の Hyper-V インスタンスによって管理されます。 この方法では、Azure Stack ソリューションの取得と管理が簡素化され、スケール ユニット全体のすべてのサービスの移動とスケーラビリティに有効です。

Azure Stack ソリューションでオーバープロビジョニングされない唯一の物理リソースは、サーバーのメモリです。 他のリソース、CPU コア、ネットワーク帯域幅、およびストレージ容量は、利用可能なリソースを最大限活用するためにオーバープロビジョニングされます。 ソリューションで、利用可能なキャパシティを計算するときの主要因子は物理サーバー メモリです。 したがって、その他のリソースの使用率で、考えられるオーバープロビジョニングの比率と、対象ワークロードで受け入れられる内容が判断されます。

約 28 個の VM が Azure Stack のインフラストラクチャをホストするために使用され、合計で約 208 GB のメモリと 124 個の仮想コアが消費されます。  この VM の数の論理的根拠は、セキュリティ、スケーラビリティ、サービス提供および修正プログラムの適用に関する要件を満たすために必要なサービス分離を行うことです。 この内部サービス構造により、今後、新しいインフラストラクチャ サービスが開発されたときに、そのサービスを導入できるようになります。

すべての物理サーバーおよびインフラストラクチャ ソフトウェア コンポーネントの自動更新をサポートするため、あるいは修正プログラムおよび更新プログラムを適用するために、インフラストラクチャとユーザーの VM の配置でスケール ユニットのすべてのメモリ リソースが消費されることはありません。 スケール ユニットのサーバー全体の合計メモリ量は、ソリューションの回復性要件をサポートするために未割り当てとなります。 たとえば、物理サーバーの Windows Server イメージが更新された場合、そのサーバーの Windows Server イメージの更新中に、サーバーでホストされている VM がスケール ユニット内の別の場所に移動されます。 更新が完了すると、サーバーは再起動され、サービス ワークロードに戻されます。 Azure Stack ソリューションの修正プログラムと更新プログラムの目標は、ホストされている VM を停止する必要をなくすことです。 その目標の達成に努めるため、スケール ユニット内の VM が移動できるように、1 つのサーバーの最小限のメモリ容量が未割り当てになっています。 この配置と移動は、Azure Stack ソリューションのユーザーまたはテナントに代わって作成される VM とインフラストラクチャの VM の両方に適用されます。 最終的な実装の結果として、VM にさまざまなメモリ要件がある場合に配置に関する課題があるため、単一サーバーのキャパシティよりも必要な VM の移動をサポートするために予約されるメモリ量をはるかに多くすることができます。 メモリ使用量のカテゴリ内の追加のオーバーヘッドは、Windows Server インスタンス自体のものです。 サーバーごとの基本的なオペレーティング システムのインスタンスでは、オペレーティング システムとその仮想ページ テーブル用のメモリと、ホストされている各 VM を管理するために Hyper-V で使用されるメモリが消費されます。

容量計算の複雑さについては、このセクションの後半で詳しく説明します。 この概要では、以下の例を提供します。これは、さまざまなソリューション サイズの利用可能な容量について理解するのに役立ちます。 これらは概算です。したがって、運用インストール環境には当てはまらない可能性があるテナント VM メモリ使用量についての憶測となります。 次の表では、Standard D2 という Azure VM のサイズが使用されています。 Azure の Standard D2 VM は、2 つの仮想 CPU と 7 GB のメモリで定義されています。

|     |サーバーあたりのキャパシティ|| スケール ユニットのキャパシティ|  |  |||
|-----|-----|-----|-----|-----|-----|-----|-----|
|     | メモリ | CPU コア | サーバーの数 | メモリ | CPU コア | テナント VM<sup>1</sup>     | コア比<sup>2</sup>    |
|例 1|256 GB|28|4|1,024 GB| 112 | 54 |4:3|
|例 2|512 GB|28|4|2024 GB|112|144|4:1|
|例 3|384 GB|28|12|4,608 GB|336|432|3:1|
|     |     |     |     |     |     |     |     |

> <sup>1</sup> Standard D2 VM。

> <sup>2</sup> 仮想コア対物理コア比。

前述のように、VM のキャパシティは利用可能なメモリによって決まります。 仮想コア対物理コア比は、ソリューションが多くの数の物理コアで作成された (別の CPU が選択された) 場合を除き、VM 密度によって利用可能な CPU のキャパシティがどのように変わるかを例示するものです。 同じことが、ストレージ容量とストレージ キャッシュ容量にも当てはまります。

VM 密度の上記の例は単に説明するためのものです。 サポートされる計算ではさらに複雑になります。 キャパシティ プランニングの選択肢および結果として得られる利用可能なキャパシティについてさらに理解するには、Microsoft またはソリューション パートナーに連絡する必要があります。

このセクションの残りの部分では、コンピューティングおよびストレージに関する Azure Stack デプロイ要件について説明します。 この情報を利用して、必要なコンポーネントとその最小構成値の基本を理解します。 利用可能なキャパシティに関するソリューションの構成方法、およびテナントのキャパシティとパフォーマンス能力に関するシステムの潜在的な制限について説明するために、追加情報も提供されます。

> [!NOTE]
> ネットワークに関するキャパシティ プランニング要件は、パブリック VIP のサイズが構成可能である場合にのみ、最小要件となります。 Azure Stack にパブリック IP アドレスをさらに追加する方法については、「[Add Public IP Addresses](azure-stack-add-ips.md)」 (パブリック IP アドレスの追加) を参照してください。


## <a name="next-steps"></a>次の手順
[コンピューティング能力の計画](capacity-planning-compute.md)
