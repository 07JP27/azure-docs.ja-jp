---
title: Azure Stack でのオファーの委任 | Microsoft Docs
description: 他のユーザーにオファーの作成とユーザーのサインアップを任せる方法を説明します。
services: azure-stack
documentationcenter: ''
author: brenduns
manager: femila
editor: ''
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/07/2018
ms.author: brenduns
ms.reviewer: alfredop
ms.openlocfilehash: 112586d3ee5f49eab9adb72d41a210e2dd9828d8
ms.sourcegitcommit: 387d7edd387a478db181ca639db8a8e43d0d75f7
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/10/2018
ms.locfileid: "41946590"
---
# <a name="delegate-offers-in-azure-stack"></a>Azure Stack でのオファーの委任

*適用先: Azure Stack 統合システムと Azure Stack 開発キット*

Azure Stack オペレーターとして、ユーザーのサインアップとサブスクリプション作成を他の人に担当してもらいたいことがよくあります。 たとえば、あなたがサービス プロバイダーで、再販業者に顧客のサインアップと管理を担当してもらいたい場合があります。 また、社内の中央の IT 部門に所属している場合は、ユーザーのサインアップを他の IT 部門のスタッフに委任する場合もあります。

次の図に示すように、委任を利用すると、自分のみで行う場合よりも、多くのユーザーの対応と管理が簡単になります。 

![委任のレベル](media/azure-stack-delegated-provider/image1.png)

委任を使用すると、委任されたプロバイダーがオファーを管理するため (委任されたオファー)、エンド カスタマーはシステム管理者からの関与なしに、そのオファーのサブスクリプションを取得します。 

## <a name="understand-delegation-roles-and-steps"></a>委任のロールと手順の概要

### <a name="delegation-roles"></a>委任ロール

次のロールは委任の一部です。

* *Azure Stack オペレーター*は、Azure Stack インフラストラクチャを管理し、オファー テンプレートを作成します。 オペレーターは、テナントにオファーを提供する業務を委任します。

* 委任された Azure Stack オペレーターとは、*委任されたプロバイダー*と呼ばれるサブスクリプションで、*所有者*または*共同作成者*の権限を持つユーザーです。 他の組織 (他の Azure Active Directory (Azure AD) テナントなど) に属すことができます。

* *ユーザー*はオファーにサインアップして、それらを使用してワークロードの管理、VM の作成、データの格納などを行います。

### <a name="delegation-steps"></a>委任手順

委任を設定する基本的な手順は 2 つあります。

1. *委任されたプロバイダー サブスクリプションを作成します*。作成するには、サブスクリプション サービスのみが含まれるオファーにユーザーをサブスクライブします。 このオファーをサブスクライブするユーザーは、委任されたオファーにサインアップすると、それらのオファーを他のユーザーに拡張できます。

2. "*委任されたプロバイダーにオファーを委任*" します。 このオファーにより、委任されたプロバイダーはサブスクリプションを作成すること、またはユーザーにオファーを拡張することができます。 委任されたプロバイダーはこのオファーを受け取り、他のユーザーに提供することができます。

次の図は、委任を設定する手順を示しています。

![委任されたプロバイダーを作成し、ユーザーのサインアップを有効にします。](media/azure-stack-delegated-provider/image2.png)

**委任されたプロバイダーの要件**

委任されたプロバイダーとして行動するには、サブスクリプションを作成して、メイン プロバイダーとの関係を確立する必要があります。 このサブスクリプションは、メイン プロバイダーの代わりに委任されたオファーを提供する権限を持つものとして委任されたプロバイダーを識別します。

このリレーションシップが確立されると、Azure Stack オペレーターは委任されたプロバイダーにオファーを委任できます。 委任されたプロバイダーはこれで、オファーを取得し、その名前を変更し (その内容は変更できません)、お客様に提供できるようになります。

## <a name="delegation-walkthrough"></a>委任のチュートリアル

以下のセクションは、委任されたプロバイダーの設定、オファーの委任、委任されたオファーにユーザーがサインアップできることを確認する方法に関する実践的なチュートリアルです。

### <a name="set-up-roles"></a>ロールの設定

このチュートリアルを実行するには、Azure Stack オペレーター アカウントに加えて 2 つの Azure AD アカウントが必要です。 これら 2 つのアカウントがない場合は、アカウントを作成する必要があります。 アカウントは、任意の Azure AD ユーザーに属することができ、委任されたプロバイダーおよびユーザーと呼ばれます。

| **ロール** | **組織の権限** |
| --- | --- |
| 委任されたプロバイダー |User |
| User |User |

### <a name="identify-the-delegated-provider"></a>委任されたプロバイダーを識別します。

1. 管理者ポータルに Azure Stack オペレーターとしてサインインします。

1. ユーザーが委任されたプロバイダーになることができるオファーを作成するには:

   a.  [プランを作成します](azure-stack-create-plan.md)。
       このプランは、サブスクリプション サービスのみを含んでいる必要があります。 この記事では、**PlanForDelegation** という名前のプランを例として使用します。

   b.  このプランに基づいて、[オファーを作成](azure-stack-create-offer.md)します。 この記事では、**OfferToDP** という名前のオファーを例として使用します。

   c.  **[サブスクリプション]** > **[追加]** > **[新しいテナント サブスクリプション]** の順に選択して、委任されたプロバイダーをこのオファーのサブスクライバーとして追加します。

   ![委任されたプロバイダーをサブスクライバーとして追加します。](media/azure-stack-delegated-provider/image3.png)

   > [!NOTE]
   > すべての Azure Stack オファーと同様に、オファーをパブリックにしてユーザーにサインアップさせる、または、プライベートのままにして Azure Stack オペレーターがサインアップを管理する、というオプションがあります。 委任されたプロバイダーは通常、小規模なグループです。 参加しているユーザーを管理したいため、たいていの場合このオファーはプライベートにしておくのが適切です。

### <a name="azure-stack-operator-creates-the-delegated-offer"></a>Azure Stack オペレーターが委任されたオファーを作成する

次の手順は、委任することになる、そしてユーザーが使用することになる、プランとオファーの作成です。 委任されたプロバイダーはそこに含まれるプランとクォータを変更できないため、このオファーは、ユーザーに表示させたいとおりに定義することをお勧めします。

1. Azure Stack オペレーターとして、[プランを作成し](azure-stack-create-plan.md)、そのプランに基づいた[オファー](azure-stack-create-offer.md)を作成することが必要です。 この記事では、**DelegatedOffer** という名前のオファーを例として使用します。

   > [!NOTE]
   > このオファーを公開する必要はありませんが、必要に応じて公開することもできます。 ただし、委任されたプロバイーダのみにオファーのアクセス権を付与したい場合がほとんどです。 次の手順にあるようにプライベート オファーを委任すると、以降は委任されたプロバイダーがアクセス権を持ちます。

1. オファーを委任します。 **DelegatedOffer** に移動します。 **[設定]** で、**[委任されたプロバイダー]** > **[追加]** の順に選択します。

1. ドロップダウン リストから、委任されたプロバイダーのサブスクリプションを選択して、**[委任]** をクリックします。

   ![委任されたプロバイダーを追加する](media/azure-stack-delegated-provider/image4.png)

### <a name="delegated-provider-customizes-the-offer"></a>委任されたプロバイダーがオファーをカスタマイズする

委任されたプロバイダーとしてユーザー ポータルにサインインし、委任されたオファーをテンプレートとして使用して、新しいオファーを作成します。

1. **[新規]** > **[テナントのプラン]** > **[オファー]** の順に選択します。

    ![新しいオファーを作成する](media/azure-stack-delegated-provider/image5.png)

1. オファーに名前を割り当てます。 この記事では、**ResellerOffer** を例として使用します。 基になる委任されたオファーを選択して、**[作成]** を選択します。

   ![名前の割り当て](media/azure-stack-delegated-provider/image6.png)

   >[!IMPORTANT]
   >委任されたプロバイダーは委任されたオファーしか選択できない、という点を理解しておくことが重要です。 それらのオファーを変更することはできません。 Azure Stack オペレーターだけが、これらのオファーを変更する (プランやクォータの変更など) ことができます。 委任されたプロバイダーが基本プランとアドオン プランからオファーを作成することはありません。 

3. 委任されたプロバイダーは、独自のポータル URL からこれらのオファーを公開できます。 オファーを公開するには、**[参照]**、**[オファー]** の順に選択します。 オファーを選び、**[状態の変更]** を選択します。

4. これら公開用の委任されたオファーは、委任されたポータルを介してのみ表示できるようになりました。 この URL を検索し変更するには、以下を行います。

    a.  **[参照]** > **[More services]\(その他のサービス\)** > **[サブスクリプション]** の順に選択します。 次に、委任されたプロバイダーのサブスクリプションを選択します。 たとえば、**[DPSubscription]** > **[プロパティ]** を選択します。

    b.  ポータル URL を、メモ帳など別の場所にコピーします。

    ![委任されたプロバイダーのサブスクリプションを選択する](media/azure-stack-delegated-provider/dpportaluri.png)  

   委任されたプロバイダーとして委任されたオファーの作成を完了しました。 委任されたプロバイダーからサインアウトし、使用しているブラウザー ウィンドウを閉じます。

### <a name="sign-up-for-the-offer"></a>オファーのサインアップ

1. 新しいブラウザー ウィンドウで、前の手順で保存した、委任されたポータル URL に移動します。 ユーザーとしてポータルにサインインします。

   >[!NOTE]
   >委任されたポータルを使用しない限り、委任されたオファーは表示されません。

1. ダッシュボードで、**[Get a subscription]\(サブスクリプションを取得\)** を選択します。 委任されたプロバイダーによって作成された、委任されたオファーのみがユーザーに表示されることがわかります。

   ![オファーを表示および選択する](media/azure-stack-delegated-provider/image8.png)

オファーを委任するプロセスは完了しました。 ユーザーは、サブスクリプションを取得して今すぐこのオファーにサインアップできるようになりました。

## <a name="move-subscriptions-between-delegated-providers"></a>委任されたプロバイダー間でのサブスクリプションの移動

必要な場合、同じディレクトリ テナントに属する新規または既存の委任されたプロバイダー サブスクリプション間でサブスクリプションを移動できます。 これを行うには、PowerShell の [Move-AzsSubscription](https://docs.microsoft.com/powershell/module/azs.subscriptions.admin) コマンドレットを使用します。

これは、次の場合に便利です。
- 委任されたプロバイダーの役割を担う新しいチーム メンバーをオンボードし、既定のプロバイダー サブスクリプションで以前に作成したユーザー サブスクリプションをこのチーム メンバーに割り当てる場合。
- 同じディレクトリ テナント (Azure Active Directory) に複数の委任されたプロバイダー サブスクリプションがあり、その間でユーザー サブスクリプションを移動する必要がある場合。 これは、チーム メンバーが別のチームに移動するためサブスクリプションを新しいチームに割り当てる必要がある場合などです。


## <a name="next-steps"></a>次の手順

[VM のプロビジョニング](azure-stack-provision-vm.md)