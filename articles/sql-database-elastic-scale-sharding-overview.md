<properties title="Sharding Overview" pageTitle="シャーディングの概要" description="Reasons for sharding: scale database resources to increase availability or performance." metaKeywords="sharding, scaling, elastic scale, Azure SQL Database" services="sql-database" documentationCenter="" manager="jhubbard" authors="sidneyh@microsoft.com"/>

<tags ms.service="sql-database" ms.workload="sql-database" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="10/02/2014" ms.author="sidneyh" />
#シャーディングの概要 

##シャーディングの原則 

**シャーディング**は、同じ構造を持つ大量のデータを数多くの独立したデータベースに分散する手法です。この手法は、エンド ユーザーまたは企業向けにサービスとしてのソフトウェア (SAAS) 製品をサービスで作成するクラウド開発者の間でよく知られています。これらのエンド カスタマーは、多くの場合、"テナント" と呼ばれます。シャーディングは、次のような理由で必要になります。 

* データの合計数が多すぎて、単一のデータベースの制約に適合しない 
* ワークロード全体のトランザクションのスループットが 1 つのデータベースの能力を超えている 
* テナントを互いに物理的に独立させる必要があり、テナントごとに別個のデータベースが必要になる 
* コンプライアンス、パフォーマンス、または地理上の理由から、データベースの異なる部分を異なる地理的場所に配置することが必要になる場合がある 
 
シャーディングは、アプリケーションのすべてのトランザクションをシャーディング キーの単一の値に制限できる場合に最適です。これにより、すべてのトランザクションが特定のデータベースにローカルであることが保証されます。 

一部のアプリケーションでは、テナントごとに別個のデータベースを作成する最も単純なアプローチが使用されています。これは、分離、バックアップ/復元機能、およびテナントの粒度でリソースのスケーリングを提供する、**単一テナントのシャーディング パターン**です。単一テナントのシャーディングでは、各データベースは特定のテナント ID 値 (または顧客キー値) に関連付けられますが、キーは必ずしもデータ自体に存在する必要はありません。各要求を適切なデータベースにルーティングするのはアプリケーションの役目です。 

![][1]

複数のテナントを別個のデータベースに分離する代わりに、一緒にデータベースにパックするシナリオもあります。これが典型的な**マルチテナントのシャーディング パターン**です。このパターンは、コスト、効率性、またはアプリケーションが多数の小さなテナントを管理するという事実の影響を受ける可能性があります。マルチテナントのシャーディングでは、データベース テーブル内の行は、テナント ID を識別するキーまたはシャーディング キーを格納するように設計されます。ここでも、アプリケーション層は、テナントの要求を適切なデータベースにルーティングする役割を負います。 

デバイスに配布からのデータの取り込みなどの他のシナリオでは、時間帯によって配布されるデータベースのセットを入力するシャーディングを使用できます。たとえば、別個のデータベースをそれぞれの日または週専用に使用できます。その場合、シャーディング キーとして (シャード化テーブルのすべての行に存在する) 日付を表す整数を使用できます。アプリケーションは、日付の範囲の情報を取得するクエリを、対象の範囲をカバーするデータベースのサブセットにルーティングする必要があります。

使用されるシャーディング モデルに関係なく、"**シャード マップ**" と呼ばれる特殊なデータ構造が、シャーディング キー値をデータベースに関連付けるルックアップ テーブルとして機能します。これにより、アプリケーションは、データベース要求のルーティングを実行できます。これは、"**データ依存ルーティング**" と呼ばれる、アプリケーションがシャード化されたデータ層を使用するために必要な基本機能です。[Elastic Scale クライアント API](http://go.microsoft.com/?linkid=9862592) は、[シャード マップを管理](http://go.microsoft.com/?linkid=9862595)したり、効率的で使いやすい[Data-depenendent routing capabilities](http://go.microsoft.com/?linkid=9862596)をアプリケーションで有効にしたりするために必要な多機能な機能セットを提供します。 

[AZURE.INCLUDE [elastic-scale-include](../includes/elastic-scale-include.md)]

<!--Image references-->
[1]: ./media/sql-database-elastic-scale-sharding-overview/tenancy.png
