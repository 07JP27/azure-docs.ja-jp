---
title: "アクティビティ ログ アラートの作成 | Microsoft Docs"
description: "アクティビティ ログで特定のイベントが発生した場合に、SMS、webhook、および電子メールで通知を受け取ります。"
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/03/2017
ms.author: johnkem
ms.translationtype: HT
ms.sourcegitcommit: 8b857b4a629618d84f66da28d46f79c2b74171df
ms.openlocfilehash: c44ecc0ee61c58ab7590e9a21a5fe002068c6b83
ms.contentlocale: ja-jp
ms.lasthandoff: 08/04/2017

---
# <a name="create-activity-log-alerts"></a>アクティビティ ログ アラートの作成

## <a name="overview"></a>概要
アクティビティ ログ アラートは、アラートに指定した条件と一致する新しいアクティビティのログ イベントが発生したときにアクティブになるアラートです。 アラートは Azure リソースなので、Resource Manager テンプレートを使用して作成し、Azure Portal で作成、更新、または削除することができます。 この記事では、アクティビティ ログ アラートの背後にある概念について説明します。また、Azure Portal を使用してアクティビティ ログ イベントに対してアラートを設定する方法についても説明します。

通常、アクティビティ ログ アラートは、次の 2 つのいずれかの目的で作成されます。
1. Azure サブスクリプションでリソースに特定の変更が発生した場合に通知を受け取るため。多くの場合、特定のリソース グループまたはリソースを対象とします。 たとえば、myProductionResourceGroup 内の仮想マシンが削除されたときに通知を受け取ることができます。 また、サブスクリプション内のユーザーに新しい役割が割り当てられた場合に通知を受け取ることもできます。
2. サービス正常性イベントが発生したときに通知を受け取るため。 サービス正常性イベントには、サブスクリプション内のリソースに適用されるインシデント イベントとメンテナンス イベントの通知が含まれます。

いずれの場合でも、アクティビティ ログ アラートでは、アラートが作成されたサブスクリプション内のイベントのみが監視されます。

JSON オブジェクトの任意の最上位プロパティに基づいて、アクティビティ ログ イベントのアクティビティ ログ アラートを構成できますが、ポータルには最も一般的なオプションが表示されます。
- **カテゴリ** - 管理、サービス正常性、自動スケール、推奨のいずれか。 [アクティビティ ログのカテゴリの詳細についてはこちらの記事](./monitoring-overview-activity-logs.md#categories-in-the-activity-log)、[サービス正常性イベントの詳細についてはこちらの記事](./monitoring-activity-log-alerts-on-service-notifications.md)を参照してください。
- **リソース グループ**
- **リソース**
- **リソースの種類**
- **操作名** - Resource Manager RBAC の操作名。
- **レベル** - イベントの重大度レベル (詳細、情報、警告、エラー、重大)
- **状態** - イベントの状態 (通常は "開始"、"失敗"、または "成功")
- **イベント開始者** - "呼び出し元" とも呼ばれます 操作を実行したユーザーの電子メール アドレスまたは Active Directory 識別子。

>[!NOTE]
>アラートには、上記の条件の 2 つ以上 (うち 1 つはカテゴリ) を指定する必要があります。 アクティビティ ログ内にイベントが作成されるたびにアクティブ化するアラートを作成することはできません。
>
>

アクティビティ ログ アラートがアクティブになると、アクションまたは通知の生成にアクション グループが使用されます。 アクション グループは、通知レシーバー (電子メール アドレス、webhook URL、または SMS の電話番号) の再利用可能なセットです。複数のアラートから参照し、通知チャネルの一元管理とグループ化を行うことができます。 アクティビティ ログ アラートで既存のアクション グループを使用するか、アクティビティ ログ アラートの定義時に新しいアクション グループを作成することがあります。 アクション グループの詳細については、[こちら](monitoring-action-groups.md)をご覧ください。

サービス正常性通知に対するアクティビティ ログ アラートについては、[こちら](monitoring-activity-log-alerts-on-service-notifications.md)を参照してください。

## <a name="create-an-alert-on-an-activity-log-event-with-a-new-action-group-with-the-azure-portal"></a>Azure Portal での新しいアクション グループを使用したアクティビティ ログ イベントのアラートの作成
1.  [ポータル](https://portal.azure.com)で **[モニター]** ブレードに移動します。

    ![監視](./media/monitoring-activity-log-alerts/home-monitor.png)
2.  **[監視]** オプションをクリックして、[監視] ブレードを開きます。 最初に開くのは **[アクティビティ ログ]** ブレードです。

3.  次に、**[アラート]** ブレードをクリックします。

    ![アラート](./media/monitoring-activity-log-alerts/alerts-blades.png)
4.  **[アクティビティ ログ アラートの追加]** コマンドを選択し、フィールドに入力します。

5.  アクティビティ ログ アラート の **[名前]** を入力し、**[説明]** を選択します。

    ![アラートの追加](./media/monitoring-activity-log-alerts/add-activity-log-alert.png)

6.  選択されている **[サブスクリプション]** は、アクティビティ ログ アラートが保存されるサブスクリプションです。 現在操作を行っているサブスクリプションに自動的に入力されます。 これは、アラート リソースがデプロイされ、アクティビティ ログ イベントが監視されるサブスクリプションです。

    ![アラートの追加 - 新しいアクション グループ](./media/monitoring-activity-log-alerts/activity-log-alert-new-action-group.png)

7.  このアラート リソースを作成する **[リソース グループ]** を選択します。 これは、アラートの*監視対象*であるリソース グループではなく、*アラート リソース自体をデプロイする*リソース グループです。

8.  必要に応じて **[イベント カテゴリ]** を選択します。表示される追加のフィルター セットが変更されます。 管理イベントの場合、**[リソース グループ]**、**[リソース]**、**[リソースの種類]**、**[操作名]**、**[レベル]**、**[状態]**、および **[イベント開始者]** の各値でフィルターして、このアラートで監視するイベントを識別するオプションがあります。

>[!NOTE]
>アラートでは、上記の条件の少なくとも 1 つを指定する必要があります。 アクティビティ ログ内にイベントが作成されるたびにアクティブ化するアラートを作成することはできません。
>
>

9.  **[新規]** アクション グループを作成し、**[名前]** および **[短い名前]** を指定します。短い名前は、このアラートが有効になったときに送信される通知に表示されます。

10. 次に、アクションについての次の情報を指定して、アクションの一覧を定義します

    a. **名前:** アクションの名前、別名、または識別子。

    b. **アクションの種類:** アクションの種類を選択します: SMS、電子メール、または Webhook

    c. **詳細:** 選択したアクションの種類の選択に基づいて、電話番号、電子メール アドレス、または Webhook の URI を入力します。

11. 完了したら **[OK]** を選択して、アラートを作成します。

アラートが完全に反映されるまでに数分かかります。反映されるとアラートがアクティブになり、新しいイベントがアラートの条件に一致するとトリガーされます。

[アクティビティ ログ アラートの webhook スキーマの詳細については、こちらのドキュメントを参照してください](monitoring-activity-log-alerts-webhook.md)。

>[!NOTE]
>上記の手順で定義されたアクション グループは、今後すべてのアラート定義で既存のアクション グループとして再利用できます。
>
>

## <a name="create-an-alert-on-an-activity-log-event-for-an-existing-action-group-with-the-azure-portal"></a>Azure Portal で既存のアクション グループのアクティビティ ログ イベントに対してアラートを作成する
1.  [ポータル](https://portal.azure.com)で **[モニター]** ブレードに移動します。

    ![監視](./media/monitoring-activity-log-alerts/home-monitor.png)
2.  **[監視]** オプションをクリックして、[監視] ブレードを開きます。 最初に開くのは **[アクティビティ ログ]** セクションです。

3.  次に、**[アラート]** セクションをクリックします。

    ![アラート](./media/monitoring-activity-log-alerts/alerts-blades.png)
4.  **[アクティビティ ログ アラートの追加]** コマンドを選択し、フィールドに入力します。

5.  アクティビティ ログ アラート の **[名前]** を入力し、**[説明]** を選択します。 この内容は、アラートが発生したときに送信される通知に表示されます。

    ![アラートの追加](./media/monitoring-activity-log-alerts/add-activity-log-alert.png)
6.  選択されている **[サブスクリプション]** は、アクティビティ ログ アラートが保存されるサブスクリプションです。 現在操作を行っているサブスクリプションに自動的に入力されます。 これは、アラート リソースがデプロイされ、アクティビティ ログ イベントが監視されるサブスクリプションです。

    ![アラートの追加 - 既存のアクション グループ](./media/monitoring-activity-log-alerts/activity-log-alert-existing-action-group.png)
7.  このアラート リソースを作成する **[リソース グループ]** を選択します。 これは、アラートの*監視対象*であるリソース グループではなく、*アラート リソース自体をデプロイする*リソース グループです。

8.  必要に応じて **[イベント カテゴリ]** を選択します。表示される追加のフィルター セットが変更されます。 管理イベントの場合、**[リソース グループ]**、**[リソース]**、**[リソースの種類]**、**[操作名]**、**[レベル]**、**[状態]**、および **[イベント開始者]** の各値でフィルターして、このアラートで監視するイベントを識別するオプションがあります。

9.  **[通知手段]** で、**[既存のアクション グループ]** を選択します。 一覧から既存のアクション グループを選択します。

10. 完了したら **[OK]** を選択して、アラートを作成します。

アラートが完全に反映されるまでに数分かかります。反映されるとアラートがアクティブになり、新しいイベントがアラートの条件に一致するとトリガーされます。

## <a name="managing-your-alerts"></a>アラートの管理

アラートを作成すると、[監視] ブレードの [アラート] セクションにアラートが表示されます。 管理対象のアラートを選択すると、次の操作を実行できます。
* **編集**する。
* **削除**する。
* **無効**または**有効**にしてそのアラートの通知受信を一時的に停止または再開する。

## <a name="next-steps"></a>次のステップ
- [アラートの概要](monitoring-overview-alerts.md)について把握します。
- [通知のレート制限](monitoring-alerts-rate-limiting.md)を参照する
- [アクティビティ ログ アラート webhook スキーマ](monitoring-activity-log-alerts-webhook.md) の確認
- [アクション グループ](monitoring-action-groups.md)の詳細を確認する  
- [サービス正常性の通知](monitoring-service-notifications.md)を参照する
- [アクティビティ ログ アラートを作成して、サブスクリプションで自動スケールのエンジン操作をすべて監視する](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert)
- [アクティビティ ログ アラートを作成して、サブスクリプションで失敗した自動スケールのスケールイン/スケールアウト操作をすべて監視する](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert)

