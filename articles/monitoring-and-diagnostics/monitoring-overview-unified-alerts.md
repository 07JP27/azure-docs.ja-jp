---
title: Azure Monitor での統合アラート
description: Azure サービスにまたがるアラートおよびアラート ルールを管理できる、Azure での統合アラートの説明。
author: manishsm-msft
services: monitoring
ms.service: azure-monitor
ms.topic: conceptual
ms.date: 06/07/2018
ms.author: mamit
ms.component: alerts
ms.openlocfilehash: ff2650ec7d4c2c1fffd57176327b56199335fa9d
ms.sourcegitcommit: 1b8665f1fff36a13af0cbc4c399c16f62e9884f3
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "35264818"
---
# <a name="unified-alerts-in-azure-monitor"></a>Azure Monitor での統合アラート

## <a name="overview"></a>概要

> [!NOTE]
>  複数のサブスクリプションからアラートを管理でき、さらにアラートの状態やスマート グループを導入する新しい統合アラート エクスペリエンスが現在、パブリック プレビューで使用できます。 この拡張されたエクスペリエンスと、それを有効にするためのプロセスについては、[この記事の最後のセクション](#enhanced-unified-alerts-experience-public-preview)を参照してください。


この記事では、Azure Monitor での統合アラート エクスペリエンスについて説明します。 [以前のアラート エクスペリエンス](monitoring-overview-alerts.md)は、Azure Monitor メニューの **[アラート (クラシック)]** オプションから使用できます。 

## <a name="features-of-the-unified-alert-experience"></a>統合アラート エクスペリエンスの機能

統合されたエクスペリエンスには、クラシック エクスペリエンスに比べて次の利点があります。

-   **より優れた通知システム**: 統合アラートは、複数のアラートで再利用できる通知とアクションの名前付きグループである[アクション グループ]( https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-action-groups)を使用します。 
- **統合された作成エクスペリエンス** - Azure Monitor、Log Analytics、および Application Insights にわたるメトリック、ログ、アクティビティ ログのアラートおよびアラート ルールを 1 か所で管理できます。 
- **発生した Log Analytics アラートを Azure Portal で表示する** - Log Analytics からのアラートを、Azure Portal で他のソースからの他のアラートと共に表示します。 以前はこれらは別のポータルにありました。
- **発生したアラートおよびアラート ルールの分離** - アラート ルールは現在、アラートから区別されます。 アラート ルールは、アラートをトリガーする条件の定義です。 アラートは、発生したアラート ルールのインスタンスです。
- **より優れたワークフロー** - 統合アラートの作成エクスペリエンスは、アラート ルールを構成するプロセスを案内します。
 
メトリック アラートは、クラシック メトリック アラートに比べて次の点が機能強化されています。

-   **待ち時間の短縮**: メトリック アラートを 1 分ごとの頻度で実行できます。 クラシック メトリック アラートは、常に 5 分の頻度で実行されました。 ログ アラートは、ログの取り込みに時間がかかるため、まだ 1 分を超える遅延が発生します。 
-   **多次元メトリックのサポート**: 各次元のメトリックに関するアラートを生成して、メトリックの特定のインスタンスを監視できます。
-   **メトリックの条件に対する制御の向上**: メトリックの最大、最小、平均、および合計値の監視をサポートするより高機能なアラート ルールを定義できます。
-   **複数のメトリックの監視の組み合わせ**: 最大 2 つのメトリックを 1 つのルールで監視できます。 両方のメトリックが、指定された期間にわたってしきい値を超えた場合、アラートがトリガーされます。
-   **ログからのメトリック** (限定パブリック プレビュー): Log Analytics に移動するログ データの一部を抽出して、Azure Monitor メトリックに変換し、他のメトリックと同様にアラートの対象にできるようになりました。 


## <a name="alert-rules"></a>アラート ルール
統合アラート エクスペリエンスでは、アラート ルールとアラートを区別しながら、さまざまなアラートの種類にわたる作成エクスペリエンスを統合するために次の概念を使用します。

| 項目 | 定義 |
|:---|:---|
| アラート ルール | アラートを作成するための条件の定義。 _ターゲット リソース_、_シグナル_、_条件_、および_ロジック_で構成されます。 アラート ルールは、_有効な_状態にある場合にのみアクティブになります。
| ターゲット リソース | アラートに使用できる特定のリソースとシグナルを定義します。 ターゲットには、任意の Azure リソースを指定できます。<br>例: 仮想マシン、ストレージ アカウント、仮想マシン スケール セット、Log Analytics ワークスペース、Application Insights リソース |
| シグナル | ターゲット リソースによって出力されるデータのソース。 サポートされるシグナルの種類は、*メトリック*、*アクティビティ ログ*、*Application Insights*、および*ログ*です。 |
| 条件 | ターゲット リソースに適用される_シグナル_と_ロジック_の組み合わせ。<br>(例: CPU 使用率が 70% を超える、サーバー応答時間が 4 ミリ秒を超える、ログ クエリの結果数が 100 を超える)。 |
| ロジック | シグナルが予測された範囲/値内にあるかどうかを確認するためのユーザー定義ロジック。 |
| アクションを表示します。 | アラートが発生したときに実行するアクション。 アラートが発生したときに、複数のアクションが実行される可能性があります。 これらのアラートは、アクション グループをサポートします。<br>例: メール アドレスへの電子メール送信、webhook URL の呼び出し。 |
| 監視条件 | メトリック アラートを作成した条件が、その後解決されたかどうかを示します。 メトリック アラート ルールは、特定のメトリックを定期的にサンプリングします。 そのアラート ルールの条件が満たされた場合は、新しいアラートが [Fired] (発生済み) の条件で作成されます。  そのメトリックが再びサンプリングされたとき、条件がまだ満たされている場合は何も発生しません。  条件が満たされていない場合は、そのアラートの条件が [解決済み] に変更されます。 後でその条件が満たされた場合は、別のアラートが [Fired] (発生済み) の条件で作成されます。 |


## <a name="alert-pages"></a>アラート ページ
統合アラートには、すべての Azure アラートを表示および管理するための 1 つの場所が用意されています。 以降のセクションでは、統合されたエクスペリエンスの各ページの機能について説明します。

### <a name="alerts-overview-page"></a>アラートの概要ページ
**[アラート]** 概要ページには、発生したすべてのアラートの集計された概要と、有効なアラート ルールの合計が表示されます。 サブスクリプションまたはフィルター パラメーターを変更すると、集計と発生したアラートの一覧が更新されます。

 ![alerts-overview](./media/monitoring-overview-unified-alerts/alerts-preview-overview2.png) 

### <a name="alert-rules-management"></a>アラート ルールの管理
**[ルール]** は、Azure サブスクリプションにまたがるすべてのアラート ルールを管理するための単一のページです。 ここにはすべてのアラート ルールが一覧表示され、それをターゲット リソース、リソース グループ、ルール名、または状態に基づいて並べ替えることができます。 このページからアラート ルールを編集したり、有効または無効にしたりすることもできます。

 ![alerts-rules](./media/monitoring-overview-unified-alerts/alerts-preview-rules.png)


## <a name="creating-an-alert-rule"></a>アラート ルールの作成
アラートは、監視サービスやシグナルの種類には関係なく、一貫した方法で作成できます。 発生したすべてのアラートや関連する詳細を単一のページで確認できます。
 
新しいアラート ルールは、次の 3 つの手順で作成します。
1. アラートの_ターゲット_を選択します。
1. そのターゲットに使用できるシグナルから_シグナル_を選択します。
1. そのシグナルからのデータに適用される_ロジック_を指定します。
 
この簡素化された作成プロセスでは、ユーザーは Azure リソースを選択する前に、サポートされている監視ソースやシグナルを把握しておく必要はなくなります。 選択されたターゲット リソースに基づいて、使用可能なシグナルの一覧が自動的にフィルター処理され、アラート ルールのロジックの定義を案内します。

アラート ルールを作成する方法の詳細については、「[Azure Monitor を使用してアラートを作成、表示、管理する](monitor-alerts-unified-usage.md)」を参照してください。

アラートは複数の Azure 監視サービス全体で使用できます。 これらの各サービスを使用する方法およびタイミングについては、「[Azure のアプリケーションおよびリソースの監視](./monitoring-overview.md)」を参照してください。 次の表は、Azure にまたがって使用できるアラート ルールの種類と、統合アラート エクスペリエンスによって現在サポートされている内容の一覧を示しています。

| **モニター ソース** | **シグナルの種類**  | **説明** | 
|-------------|----------------|-------------|
| Azure Monitor | メトリック  | [ほぼリアルタイムのメトリック アラート](monitoring-near-real-time-metric-alerts.md)とも呼ばれます。これらは、最短 1 分間隔でのメトリック条件の評価をサポートし、マルチメトリックおよび多次元メトリックのルールを使用できます。 サポートされるリソースの種類の一覧は、「[Azure Portal で使用できる Azure サービスの新しいメトリック アラート](monitoring-near-real-time-metric-alerts.md#metrics-and-dimensions-supported)」で確認できます。<br>[クラシック メトリック アラート](monitoring-overview-alerts.md)は、新しいアラート エクスペリエンスではサポートされていません。 これらは、Azure Portal の [アラート (クラシック)] の下にあります。 クラシック アラートは、新しいアラートにまだ移動されていない一部のメトリックの種類をサポートします。 完全な一覧については、[サポートされるメトリック](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-supported-metrics)に関するページを参照してください。 |
| Log Analytics | ログ  | ログ検索クエリが特定の条件を満たしたときに、通知を受信するか、または自動化されたアクションを実行します。 Log Analytics のアラートは、[新しいエクスペリエンスにコピーされます](monitoring-alerts-extend.md)。 [*メトリックとしての Log Analytics ログのプレビュー*](monitoring-alerts-extend-tool.md)を使用できます。 このプレビュー機能では、一部のログの種類を取得してメトリックに変換し、新しいアラート エクスペリエンスを使ってそれらについてのアラートを行うことができます。 このプレビュー機能は、ネイティブの Azure Monitor メトリックと共に Azure 以外のログを取得したい場合に便利です。 |
| アクティビティ ログ | アクティビティ ログ | 選択したターゲットによって作成されたすべての [作成]、[更新]、および [削除] アクションのレコードが含まれます。 |
| サービス正常性 | アクティビティ ログ  | 統合アラートではサポートされていません。 「[サービス通知のアクティビティ ログ アラートを作成する](monitoring-activity-log-alerts-on-service-notifications.md)」をご覧ください。  |
| Application Insights | ログ  | アプリケーションのパフォーマンスの詳細が記録されたログが含まれます。 分析クエリを使用すると、アプリケーション データに基づいて実行されるアクションの条件を定義できます。 |
| Application Insights | メトリック | 統合アラートではサポートされていません。 [Metric alerts].(../application-insights/app-insights-alerts.md) を参照してください。 |
| Application Insights | Web 可用性テスト | 統合アラートではサポートされていません。  [Web テスト アラート](../application-insights/app-insights-monitor-web-app-availability.md)に関するページをご覧ください。 Application Insights にデータを送信するようにインストルメント化されたすべての Web サイトで使用できます。 Web サイトの可用性または応答性が期待を下回る場合に通知を受け取ります。 |

## <a name="enhanced-unified-alerts-public-preview"></a>拡張された統合アラート (パブリック プレビュー)
> [!NOTE]
>  このセクションの機能は近日対応予定です。 これは、使用しているポータルのバージョンではまだ表示されない可能性があります。 

拡張された統合アラート エクスペリエンスは、2018 年 6 月 1 日に Azure Monitor のパブリック プレビューでリリースされました。 このエクスペリエンスは、2018 年 3 月にリリースされた[統合アラート](#overview) の利点に基づいて構築されており、アラートの状態の変更に加えて個々のアラートを管理および集計する機能を提供します。 このセクションでは、新機能と、Azure Portal で新しいアラート ページに移動する方法について説明します。

### <a name="features-enhanced-unified-alerts"></a>拡張された統合アラートの機能

新しいエクスペリエンスは、従来の統合されたエクスペリエンスでは使用できない次の機能を提供します。

- **サブスクリプションにまたがるアラートを表示する** - 複数のサブスクリプションにまたがるアラートの個々のインスタンスを 1 つのビューで表示および管理できるようになりました。
- **アラートの状態を管理する** - アラートには、それが終了済みとして確認されたかどうかを示す状態が割り当てられています。
- **スマート グループを使用してアラートを整理する** - スマート グループは、関連するアラートを個別にではなく、セットとして管理できるように自動的にグループ化します。

### <a name="enable-enhanced-unified-alerts"></a>拡張された統合アラートを有効にする
新しい統合アラート エクスペリエンスを有効にするには、[アラート] ページの上部にあるバナーをクリックします。 このプロセスにより、サポートされるサービスにまたがる過去 30 日間の発生したアラートを含むアラート ストアが作成されます。 新しいエクスペリエンスが有効になったら、このバナーをクリックすることによって、新しいエクスペリエンスと古いエクスペリエンスを切り替えることができます。

> [!NOTE]
>  新しいエクスペリエンスが最初に有効になるには数分かかることがあります。

![バナー](media/monitoring-overview-unified-alerts/opt-in-banner.png)

新しいエクスペリエンスを有効にすると、アクセスできるすべてのサブスクリプションが登録されます。 サブスクリプション全体が有効になりますが、新しいエクスペリエンスを表示できるのは、それを選択したユーザーだけです。 そのサブスクリプションにアクセスできる他のユーザーは、このエクスペリエンスを個別に有効にする必要があります。

新しいアラート エクスペリエンスを有効にしても、アクション グループの構成やアラート ルールでの通知には影響を与えません。 発生したアラートのインスタンスを Azure Portal で表示および管理する方法が変更されるだけです。

### <a name="smart-groups"></a>スマート グループ
スマート グループは、個々のアラートを管理するのではなく、関連するアラートを 1 つの単位として管理できるようにすることによってノイズを削減します。 スマート グループの詳細を表示したり、アラートと同様の状態を設定したりできます。 各アラートは、1 つだけのスマート グループのメンバーです。

スマート グループは、1 つの問題を表す関連するアラートを結合するために、機械学習を使用して自動的に作成されます。 アラートが作成されると、このアルゴリズムは履歴パターン、プロパティの類似性、構造の類似性などの情報に基づいて、そのアラートを新しいスマート グループまたは既存のスマート グループに追加します。 現在、このアルゴリズムでは、サブスクリプション内の同じ監視サービスからのアラートだけが考慮されます。 スマート グループは、この統合によってアラートのノイズの最大 99% を削減できます。 アラートがグループに含まれた理由は、スマート グループの詳細ページで表示できます。

スマート グループの名前は、その最初のアラートの名前です。 スマート グループを作成したり、その名前を変更したりすることはできません。


### <a name="alert-states"></a>アラートの状態
拡張された統合アラートでは、アラートの状態の概念が導入されています。 アラートの状態を設定して、それが解決プロセス内のどこにあるかを指定できます。  アラートが作成されたとき、その状態は *[新規]* になります。 アラートを確認した場合や、アラートを終了した場合は、その状態を変更できます。 状態の変更はすべて、アラートの履歴に格納されます。

次のアラートの状態がサポートされています。

| State | 説明 |
|:---|:---|
| 新規 | 問題が検出されたばかりであり、まだレビューされていません。 |
| [Acknowledged] (確認済み) | 管理者がアラートをレビューし、それに対する作業を開始しました。 |
| クローズ | 問題が解決されました。 アラートが終了されされたら、それを再び開いて別の状態に変更できます。 |

アラートの状態は、監視条件とは異なります。 メトリック アラート ルールは、エラーの条件が満たされなくなったら、アラートを_解決済み_の条件に設定できます。 アラートの状態はユーザーによって設定され、監視条件には依存しません。 システムが監視条件を解決済みに設定したとしても、アラートの状態は、ユーザーがそれを変更するまで変更されません。

#### <a name="changing-the-state-of-an-alert-or-smart-group"></a>アラートまたはスマート グループの状態の変更
個々のアラートの状態を変更するか、またはスマート グループの状態を設定することによって複数のアラートをまとめて管理できます。

アラートの詳細ビューで **[Change alert state] (アラートの状態を変更する)** をクリックすることによってアラートの状態を変更するか、またはスマート グループの詳細ビューで **[Change smart group state] (スマート グループの状態を変更する)** をクリックすることによってスマート グループの状態を変更します。 一覧ビューで選択し、このページの上部にある **[状態の変更]** をクリックすることによって、複数の項目の状態を一度に変更できます。 どちらの場合も、ドロップダウンから新しい状態を選択し、オプションでコメントを指定します。 1 つの項目を変更する場合は、スマート グループ内のすべてのアラートに同じ変更を適用するオプションもあります。

![状態の変更](media/monitoring-overview-unified-alerts/change-tate.png)

### <a name="alerts-page"></a>Alerts page
既定の [アラート] ページには、特定の時間枠内に作成されたアラートの概要が表示されます。 ここには、重大度ごとのアラートの合計が、重大度ごとの各状態にあるアラートの総数を識別する列と共に表示されます。 任意の重大度をクリックすると、その重大度でフィルター処理された [[すべてのアラート]](#all-alerts-page) ページが開きます。

![Alerts page](media/monitoring-overview-unified-alerts/alerts-page.png)

このページの上部にあるドロップダウン内の値を選択することによって、このビューをフィルター処理できます。

| 分割 | 説明 |
|:---|:---|
| サブスクリプション | 最大 5 つの Azure サブスクリプションを選択します。 このビューには、選択されたサブスクリプション内のアラートのみが含まれます。 |
| リソース グループ | 1 つのリソース グループを選択します。 このビューには、選択されたリソース グループ内のターゲットを含むアラートのみが含まれます。 |
| 時間の範囲 | このビューには、選択された時間枠内に発生したアラートのみが含まれます。 サポートされる値は、過去 1 時間、過去 24 時間、過去 7 日間、および過去 30 日間です。 |

[アラート] ページの上部にある次の値をクリックすると、別のページが開きます。

| 値 | 説明 |
|:---|:---|
| [Total Alerts] (アラートの合計) | 選択された条件に一致するアラートの総数。 この値をクリックすると、フィルターなしの [すべてのアラート] ビューが開きます。 |
| [Smart Groups] (スマート グループ) | 選択された条件に一致する、アラートから作成されたスマート グループの総数。 この値をクリックすると、[すべてのアラート] ビューに [Smart Groups] (スマート グループ) 一覧が開きます。
| [アラート ルールの合計] | 選択されたサブスクリプションおよびリソース グループ内のアラート ルールの総数。 この値をクリックすると、選択されたサブスクリプションおよびリソース グループに対してフィルター処理された [ルール] ビューが開きます。


### <a name="all-alerts-page"></a>[すべてのアラート] ページ 
[すべてのアラート] ページでは、選択された時間枠内に作成されたアラートの一覧を表示できます。 個々のアラートの一覧、またはそれらのアラートを含むスマート グループの一覧のどちらかを表示できます。 このページの上部にあるバナーをクリックすると、ビューが切り替わります。

![[すべてのアラート] ページ](media/monitoring-overview-unified-alerts/all-alerts-page.png)

このページの上部にあるドロップダウン内の次の値を選択することによって、このビューをフィルター処理できます。

| 分割 | 説明 |
|:---|:---|
| サブスクリプション | 最大 5 つの Azure サブスクリプションを選択します。 このビューには、選択されたサブスクリプション内のアラートのみが含まれます。 |
| リソース グループ | 1 つのリソース グループを選択します。 このビューには、選択されたリソース グループ内のターゲットを含むアラートのみが含まれます。 |
| リソースの種類 | 1 つ以上のリソースの種類を選択します。 このビューには、選択された種類のターゲットを含むアラートのみが含まれます。 この列は、リソース グループが指定されたときにのみ使用できます。 |
| リソース | リソースを選択します。 このビューには、そのリソースをターゲットとして含むアラートのみが含まれます。 この列は、リソースの種類が指定されたときにのみ使用できます。 |
| 重大度 | アラートの重大度を選択するか、または *[すべて]* を選択してすべての重大度のアラートを含めます。 |
| [Monitor Condition] (監視条件) | 監視条件を選択するか、または *[すべて]* を選択してすべての条件のアラートを含めます。 |
| [アラートの状態] | アラートの状態を選択するか、または *[すべて]* を選択してすべての状態のアラートを含めます。 |
| [Monitor Service] (監視サービス) | サービスを選択するか、または *[すべて]* を選択してすべてのサービスを含めます。 そのサービスをターゲットとして使用してルールによって作成されたアラートのみが含まれます。 |
| 時間の範囲 | このビューには、選択された時間枠内に発生したアラートのみが含まれます。 サポートされる値は、過去 1 時間、過去 24 時間、過去 7 日間、および過去 30 日間です。 |

表示する列を選択するには、このページの上部にある **[列]** をクリックします。 任意の列を削除できます。 

### <a name="alert-detail-page"></a>アラートの詳細ページ
アラートをクリックすると、[Alert Detail] (アラートの詳細) ページが表示されます。 ここにはアラートの詳細が表示され、その状態を変更できるようになります。

![[Alert Detail] (アラートの詳細)](media/monitoring-overview-unified-alerts/alert-detail.png)

[Alert Detail] (アラートの詳細) ページには、次のセクションが含まれています。

| セクション | 説明 |
|:---|:---|
| 要点 | アラートに関するプロパティやその他の重大な情報を表示します。 |
| 履歴 | アラートによって実行された各アクションと、アラートに加えられたすべての変更を一覧表示します。 これは現在、状態の変更に制限されています。 |
| [Smart Group] (スマート グループ) | そのアラートが含まれているスマート グループに関する情報。 **[Alert Count] (アラート数)** は、そのスマート グループに含まれているアラートの数を示します。 これには、過去 30 日間に作成された、同じスマート グループに含まれている他のアラートが含まれます。  これは、アラートの一覧ページ内の時間フィルターには関係ありません。 アラートをクリックすると、その詳細が表示されます。 |
| 詳細 | 通常はそのアラートを作成したソースの種類に固有である、アラートの詳細なコンテキスト情報を表示します。 |


### <a name="smart-group-detail-page"></a>スマート グループの詳細ページ
スマート グループをクリックすると、[Smart Group Detail] (スマート グループの詳細) ページが表示されます。 ここにはスマート グループの詳細 (そのグループを作成するために使用された理由を含む) が表示され、その状態を変更できるようになります。
 
![[Smart Group Detail] (スマート グループの詳細)](media/monitoring-overview-unified-alerts/smart-group-detail.png)


[Smart Group Detail] (スマート グループの詳細) ページには、次のセクションが含まれています。

| セクション | 説明 |
|:---|:---|
| アラート | そのスマート グループに含まれている個々のアラートを一覧表示します。 アラートをクリックすると、その [Alert Detail] (アラートの詳細) ページが開きます。 |
| 履歴 | スマート グループによって実行された各アクションと、それに加えられたすべての変更を一覧表示します。 これは現在、状態の変更とアラート メンバーシップの変更に制限されています。 |

## <a name="next-steps"></a>次の手順
- [新しいアラート エクスペリエンスを使用してアラートを作成、表示、管理する方法を確認する](monitor-alerts-unified-usage.md)
- [アラート エクスペリエンスのログ アラートについて確認する](monitor-alerts-unified-log.md)
- [アラート エクスペリエンスのメトリック アラートについて確認する](monitoring-near-real-time-metric-alerts.md)
- [アラート エクスペリエンスのアクティビティ ログ アラートについて確認する](monitoring-activity-log-alerts-new-experience.md)
