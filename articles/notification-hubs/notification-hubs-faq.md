<properties
	pageTitle="Azure 通知ハブ - よく寄せられる質問 (FAQ)"
	description="通知ハブにおけるソリューションの設計と実装についての FAQ"
	services="notification-hubs"
	documentationCenter="mobile"
	authors="wesmc"
	manager="dwrede"
	editor="" />

<tags
	ms.service="notification-hubs"
	ms.workload="mobile"
	ms.tgt_pltfrm="mobile-multiple"
	ms.devlang="multiple"
	ms.topic="article"
	ms.date="08/18/2015" 
	ms.author="wesmc" />

#Azure 通知ハブ - よく寄せられる質問 (FAQ)

##全般
###1\.通知ハブの料金を教えてください。
Notification Hubs は *Free*、*Basic*、*Standard* の 3 つのレベルで提供されます。詳しくは「[Notification Hubs 料金]」をご覧ください。料金はサブスクリプション レベルで課金され、名前空間または通知ハブの数に関係なく、プッシュの数に基づいています。Free レベルは、開発目的のために提供されており、SLA の保証はありません。Basic と Standard レベルは本番環境用に提供されています。次の主要機能は Standard レベルのみで有効になります。

- *ブロードキャスト* - Basic レベルでは通知ハブのタグ数は 3,000 (5 台未満のデバイスに適用) までに制限されます。対象ユーザーが 3,000 人以上いる場合、Standard レベルに移行する必要があります。
- *リッチ テレメトリ* - Basic レベルではテレメトリ データや登録データのエクスポートは行えません。オフライン表示と分析のためにテレメトリ データをエクスポートする必要がある場合、Standard レベルに移行する必要があります。
- *マルチ テナント機能* - Notification Hubs を使用してモバイル アプリを作成し、複数のテナントをサポートする場合、Standard レベルへの移行を検討する必要があります。これにより、アプリの通知ハブの名前空間レベルでプッシュ通知サービス (PNS) の資格情報を設定して、この共通の名前空間でテナントに個別のハブを提供し、分離ができます。これにより、テナント間の重複を確実に避けるために各テナント用に分離した通知ハブから通知を送受信する SAS キーを保持しつつ、簡単にメンテナンスをすることができます。

###2\.SLA とは何ですか。
Basic と Standard の通知ハブ レベルでは、Basic や Standard の通知ハブ レベル内で導入した通知ハブに関しては少なくとも 99.9%、適切に構成されたアプリケーションが通知を送信したり、登録管理操作を実行できるように保証します。SLA について詳しくは、こちらの [Notification Hubs の SLA] に関するページをご覧ください。通知ハブは外部のプラットフォーム プロバイダーに依存してデバイスに通知を送信するため、プラットフォーム通知サービスとデバイス間の区間における SLA の保証はありません。

###3\.通知ハブを使用している顧客を教えてください。
大勢のお客様が通知ハブをご使用になっています。次にいくつかご紹介します。

* ソチ 2014 年冬季オリンピック – 数百におよぶ利益団体、300 万台以上のデバイス、2 週間でディスパッチした通知 150 万件以上[CaseStudy - ソチ]
* Skanska - [CaseStudy - Skanska]
* シアトル タイムズ - [CaseStudy - シアトル タイムズ]
* Mural.ly - [CaseStudy - Mural.ly]
* 7Digital - [CaseStudy - 7Digital]
* Bing アプリ – 数千万台のデバイス、1 日あたり 300 万件の通知を送信

##設計と開発
###1\.サポートするサービス側のプラットフォームはどれですか。
SDK と、.NET、Java、PHP、Python、Node.js のサンプルを提供しています。アプリのバックエンドを設定して、こうしたプラットフォームを使い通知ハブに通信できるようにします。通知ハブの API は REST インターフェイスに基づいているので、これらと直接対話ができます。詳しくは「[Notification Hubs REST インターフェイスの使用方法]」をご覧ください。

###2\.どのデバイスのプラットフォームをサポートしていますか。
Apple iOS、Android、Windows ユニバーサル、Windows Phone、Kindle、Android China (Baidu 経由)、Xamarin (iOS と Android)、Chrome アプリ プラットフォームへの通知の送信をサポートしています。こうしたプラットフォーム用のステップ バイ ステップの概要チュートリアルは、「[Notification Hubs の使用]」から入手できます。

###3\.SMS/メール/Web 通知はサポートしていますか。
通知ハブは、主に、上記のプラットフォームを使用してモバイル アプリに通知を送信することを目的としています。メールや SMS への送信機能は提供していませんが、こうした機能を提供するサード パーティ製のプラットフォームを通知ハブに統合させて、Azure モバイル サービスを使いネイティブのプッシュ通知を送信ができます。たとえば、「[Mobile Services から音声および SMS 機能に Twilio を使用する方法]」では、Azure Mobile Services を使って SMS 通知を送信する方法について説明しています。また、すぐに使えるブラウザー内プッシュ通知も提供していません。お客様は SignalR でこれを実装することもできます。また、Google Chrome ブラウザーで作動する Chrome アプリへのプッシュ通知の送信についてのチュートリアルも提供しています。「[Notification Hubs の使用]」をご覧ください。

###4\.Azure モバイル サービスと Azure 通知ハブとの関係について教えてください。いつ、どれを使えばいいのですか。
モバイル アプリのバックエンドが既にあり、プッシュ通知の送信機能だけを追加する場合は、Azure 通知ハブを使う必要があります。モバイル アプリのバックエンドを最初から設定する場合は、Azure モバイル サービスの使用を検討する必要があります。Azure モバイル サービスでは通知ハブを自動的にプロビジョニングするため、モバイル アプリのバックエンドから簡単にプッシュ通知を送信できます。Azure モバイル サービスの料金には、通知ハブの基本料金が含まれており、それに含まれるプッシュ数を超過する場合のみ料金を支払います。詳しくは「[Mobile Services 料金]」をご覧ください。

###5\.サポートできるデバイス数を教えてください。
Basic と Standard レベルでは、通知を受信できるアクティブなデバイスの数に制限はありません。詳しくは「[Notification Hubs 料金]」をご覧ください。

###6\.送信できるプッシュ通知の数を教えてください。
お客様は Azure 通知ハブを使って毎日数百万のプッシュ通知を送信しています。通知ハブの数を増やすためにお客様がすることは何もありません。システムで流動する通知の数を基に、こちらで自動的に増やします。送信するプッシュ通知に基づいて料金が左右することに注意してください。

###7\.通知が自分のデバイスに到達するまでどのくらいの時間がかかりますか。
Azure 通知ハブでは、着信負荷が一定で急増することのない通常の使用シナリオにおいては、1 分間に少なくとも 100 万件の送信を処理できます。この数はタグの数や着信するメッセージなどの性質によって異なります。この間に、登録したタグやタグ式を基に、プラットフォームあたりのターゲットを計測し、各プッシュ通知サービスへメッセージを送信します。ここからデバイスに通知を送信するのはプッシュ通知サービス (PNS) の責任になります。PNS では、通知の送信に対する SLA を保証しませんが、通常ほとんどのメッセージはこちらのプラットフォームに送信された時から数分以内 (10 分以内) にデバイスに送信されます。中にはもう少し時間がかかるものもあります。また、Azure 通知ハブには 30 分以内に PNS に送信できない通知を停止するポリシーがあります。こうした遅延にはさまざまな理由が考えられますが、最も一般的な理由は PNS がアプリケーションをスロットルするためです。

###8\.遅延に対する保証はありますか。
プッシュ通知は外部プラットフォーム専用のプッシュ通知サービスによって送信されるという性質であるため、遅延に対する保証はありません。通常、ほとんどの通知は数分以内に送信されます。

###9\.名前空間と通知ハブを使用するソリューションを設計する上で考慮する必要がある点を教えてください。
*モバイル アプリ/環境:* 1 つの環境、1 つのモバイル アプリに対して通知ハブは 1 つにする必要があります。複数テナントのシナリオでは、各テナントで個別のハブが必要になります。テスト環境と本番環境で同じ通知ハブを共有しないでください。通知の送信中に問題が発生する原因になる場合があります。たとえば、Apple では Sandbox と Production Push エンドポイントをそれぞれ個別の資格情報で提供しています。ハブがもともと Apple Sandbox の証明書で構成されており、後から Apple の本番用の証明書を使用するように再構成される場合、古いデバイスのトークンは新しい証明書で無効になり、プッシュが失敗する原因になります。本番環境とテスト環境は別にし、個別の環境にはそれぞれのハブを使用することをお勧めします。

*PNS 資格情報:* モバイル アプリがプラットフォームの開発者ポータル (Apple や Google など) で登録される場合、アプリの識別子とセキュリティ トークンを取得します。これはデバイスにプッシュ通知を送信できるようにするために、アプリのバックエンドがプラットフォームのプッシュ通知サービスに提供するものです。セキュリティ トークンは、通知ハブで構成する必要がある証明書 (Apple iOS、Windows Phone など) やセキュリティ キー (Google Android、Windows) などの形式にできます。これは通常、通知ハブ レベルで行われますが、マルチ テナントのシナリオでは名前空間レベルで行うこともできます。

*名前空間:* 名前空間は展開のグループ化にも使用できます。また、マルチ テナントのシナリオで同じアプリのすべてのテナントにすべての通知ハブを表すことにも使用できます。

*地理的分散:* プッシュ通知では、地理的分散は常に重要というわけではありません。最終的にプッシュ通知をデバイスに送信するさまざまなプッシュ通知サービス (APNS、GCM など) が均等に分散されていないことに注意してください。ただし、世界中で使われているアプリケーションがある場合は、別の名前空間で複数のハブを作成し、全世界のさまざまな Azure リージョンで通知ハブ サービスの可用性を活用できます。これは、特に登録に関する管理コストが増加するため、お勧めできません。本当に必要な場合のみ行ってください。

###10\.登録はアプリのバックエンドから行うべきですか。デバイスから直接行うべきですか。
アプリのバックエンドからの登録は、登録を作成する前にクライアント認証を実行する必要がある場合、アプリのロジックに基づいてアプリのバックエンドで作成もしくは変更する必要のあるタグがある場合に役立ちます。その他のガイダンスは「[アプリ バックエンドからの登録]」と「[登録管理]」をご覧ください。

###11\.セキュリティ モデルとは何ですか。
Azure 通知ハブでは Shared Access Signature (SAS) ベースのセキュリティ モデルを使用しています。SAS トークンはルートの名前空間レベルや詳細な通知ハブ レベルで使用できます。こうした SAS トークンは、送信メッセージの許可やリッスン通知の許可などさまざまな承認規則で設定できます。詳しくは「[セキュリティ]」をご覧ください。

###12\.通知ではどのようにデリケートなペイロード情報が扱われますか。
すべての通知は、プラットフォームのプッシュ通知サービス (PNS) によってデバイスに送信されます。送信者が Azure 通知ハブに通知を送信すると、通知は処理されてそれぞれの PNS に渡されます。送信者から Azure 通知ハブに接続され、さらに HTTPS を使用する PNS へと繋がります。Azure 通知ハブでメッセージのペイロードが記録されることは決してありません。ただし、デリケートなペイロードの送信には、セキュリティで保護されたプッシュのパターンをお勧めします。送信者はデリケートなのペイロードなしで、メッセージの識別子が付いた ping 通知をデバイスに送信できます。デバイスのアプリでこのペイロードを受信すると、セキュリティ保護されたアプリのバックエンド API を直接呼び出し、メッセージの詳細をフェッチします。パターンを実装するためのチュートリアルは、「[Azure Notification Hubs の安全なプッシュ]」をご覧ください。

##操作
###1\.災害復旧 (DR) ストーリーとは何ですか。
Microsoft ではメタデータの災害復旧 (通知ハブの名前、接続文字列など) を提供します。DR が発生する場合、消失するのは登録データですので、このデータを新しいハブに再入力するソリューションが必要になります。

- *ステップ 1* - 別の DC でセカンダリ通知ハブを作成します。これは DR 発生時にすぐに作成できます。または最初から作成しておくこともできます。NH プロビジョニングは数秒でできる高速プロセスですので、どちらでもあまり関係ありませんが、最初から作成しておくことによって、DR 発生時の管理機能への影響からも保護できるので、こちらをお勧めします。

- *ステップ 2* - プライマリの通知ハブからの登録をセカンダリの通知ハブに利用します。登録は入ってくるものであり、PNS により期限切れになる性質により正しく作動しないので、両方のハブで登録を管理し、最新に保つことはお勧めしません。通知ハブでは、期限が切れたり、無効な登録についての PNS のフィードバックを受信しながら、そうした登録をクリーンアップします。

次のいずれかのアプリのバックエンドを使用することをお勧めします。

- 一連の登録を管理し、DR 発生時にセカンダリの通知ハブに一括挿入できる

- バックアップとしてプライマリのハブから登録のダンプを定期的に取得し、セカンダリ NH に一括挿入する

(Standard レベルで利用できる登録のエクスポート/インポート機能については「[登録の一括エクスポートと変更]」をご覧ください)

バックエンドがない場合、アプリがデバイスで起動すると、セカンダリ NH で新規登録を実行します。セカンダリ NH には最終的に登録済みのアクティブなデバイスのすべてがあることになりますが、デバイスでアプリを起動しない場合に、通知を受信しない期間があるのが欠点です。

###2\.監査ログ機能はありますか。
すべての通知ハブ管理操作は、Azure 管理ポータルで公開されている操作ログに移動します。

##監視とトラブルシューティング
###1\.どのようなトラブルシューティングの機能がありますか。
Azure 通知ハブでは、特にドロップされた通知に関する最も一般的なシナリオに共通するトラブルシューティングを行うための機能をいくつか提供しています。詳しくはトラブルシューティングのホワイト ペーパー「[Azure Notification Hubs - 診断ガイドライン]」をご覧ください。

###2\.どのようなテレメトリ機能がありますか。
Azure 通知ハブでは Azure 管理ポータルでテレメトリ データの表示を有効にします。使用可能なメトリックについて詳しくは、「[メトリック]」をご覧ください。通知の成功とは、外部のプッシュ通知サービス (Apple の APNS、Google の GCM など) に通知が送信されたことを意味します。通知をデバイスに送信するのは PNS 次第で、PNS ではこうしたメトリックを Microsoft に公表しておりません。また、プログラムによってテレメトリをエクスポートする機能も提供しています (Standard レベル)。詳しくは [Notification Hubs のメトリックのサンプル]をご覧ください。

[Notification Hubs 料金]: http://azure.microsoft.com/pricing/details/notification-hubs/
[Notification Hubs の SLA]: http://azure.microsoft.com/support/legal/sla/
[CaseStudy - ソチ]: https://customers.microsoft.com/Pages/CustomerStory.aspx?recid=7942
[CaseStudy - Skanska]: https://customers.microsoft.com/Pages/CustomerStory.aspx?recid=5847
[CaseStudy - シアトル タイムズ]: https://customers.microsoft.com/Pages/CustomerStory.aspx?recid=8354
[CaseStudy - Mural.ly]: https://customers.microsoft.com/Pages/CustomerStory.aspx?recid=11592
[CaseStudy - 7Digital]: https://customers.microsoft.com/Pages/CustomerStory.aspx?recid=3684
[Notification Hubs REST インターフェイスの使用方法]: https://msdn.microsoft.com/library/azure/dn530746.aspx
[Notification Hubs の使用]: http://azure.microsoft.com/documentation/articles/notification-hubs-ios-get-started/
[Mobile Services から音声および SMS 機能に Twilio を使用する方法]: http://azure.microsoft.com/documentation/articles/partner-twilio-mobile-services-how-to-use-voice-sms/
[Notification Hubs の使用]: http://azure.microsoft.com/documentation/articles/notification-hubs-chrome-get-started/
[Mobile Services 料金]: http://azure.microsoft.com/pricing/details/mobile-services/
[アプリ バックエンドからの登録]: https://msdn.microsoft.com/library/azure/dn743807.aspx
[登録管理]: https://msdn.microsoft.com/library/azure/dn530747.aspx
[セキュリティ]: https://msdn.microsoft.com/library/azure/dn495373.aspx
[Azure Notification Hubs の安全なプッシュ]: http://azure.microsoft.com/documentation/articles/notification-hubs-aspnet-backend-ios-secure-push/
[Azure Notification Hubs - 診断ガイドライン]: http://azure.microsoft.com/documentation/articles/notification-hubs-diagnosing/
[メトリック]: https://msdn.microsoft.com/library/dn458822.aspx
[Notification Hubs のメトリックのサンプル]: https://github.com/Azure/azure-notificationhubs-samples/tree/master/FetchNHTelemetryInExcel
[登録の一括エクスポートと変更]: https://msdn.microsoft.com/library/dn790624.aspx

<!---HONumber=August15_HO8-->