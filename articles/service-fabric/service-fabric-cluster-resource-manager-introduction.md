<properties
   pageTitle="Service Fabric クラスター リソース マネージャーの概要 | Microsoft Azure"
   description="Service Fabric クラスター リソース マネージャーについての概要。"
   services="service-fabric"
   documentationCenter=".net"
   authors="masnider"
   manager="timlt"
   editor=""/>

<tags
   ms.service="Service-Fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="08/19/2016"
   ms.author="masnider"/>

# Service Fabric クラスター リソース マネージャーの概要
従来、IT システムまたは一連のサービスの管理では、いくつかの物理または仮想マシンをそれらの特定のサービスまたはシステム専用に使用しました。多くの主要なサービスは "Web" 層と "データ" 層または "ストレージ" 層に分かれ、普通はそれ以外にキャッシュなどのいくつかの特殊なコンポーネントがあります。他には要求が出入りするメッセージング層を持つアプリケーションの種類があり、メッセージングの一部として必要な分析や変換のための処理層に接続されています。ワークロードの各種類には 1 個の専用マシンが使用されます。データベースには 2 個の専用マシンが使用され、Web サーバーには数個が使用されます。特定の種類のワークロードがそのワークロード用のマシンの能力を超えた場合は、そのワークロード用に構成されたマシンの数を増やすか、または何台かを大型のマシンに置き換えます。簡単です。マシンで障害が発生した場合、マシンが復元されるまで、アプリケーションのその部分の処理能力が低下します。まだ (楽しくはないにしても) 十分に簡単です。

ところが、スケール アウトが必要になり、コンテナーやマイクロサービスを追加する場合を考えてみてください。突然、数十、数百または何千ものマシン、何十種類ものサービス、これらのサービスのおそらく何百ものインスタンスがあり、それぞれに高可用性 (HA) のためのインスタンスまたはレプリカが 1 つ以上あることに気付くのです。

いきなり、環境の管理は、1 種類のワークロードに専用の数台のマシンの管理といった単純なものではなくなります。サーバーは仮想化されており、もはや名前を持ちません (考え方を[ペットから家畜の牛](http://www.slideshare.net/randybias/architectures-for-open-and-scalable-clouds/20)に変え*ます*)。マシンに関する構成は減り、サービス自体に関する構成が増えています。専用ハードウェアは過去のものであり、サービスは複数の細分化されたコモディティ ハードウェアにまで及ぶ小規模な分散システムになっています。

このように従来の単一の階層化されたアプリをコモディティ ハードウェアで実行している複数の異なるサービスに分割した結果として、はるかに多くの組み合わせに対応する必要があります。どのハードウェアまたは何台のハードウェアで実行できるワークロードの種類をだれが決定しますか。 どのワークロードが同じハードウェアで適切に動作し、競合しているでしょうか。 マシンがダウンをしたとき、そこでは何が実行していましたか。 確実にワークロードが再実行する責任はだれにありますか。 (仮想) マシンが回復するまで待ちますか、またはワークロードは自動的に他のマシンにフェールオーバーし、実行し続けていますか。 ユーザーの介入は必要ですか。 このような環境でのアップグレードについてはどうですか。

このような世界に存在する開発者およびオペレーターとして、この複雑さを管理するには何らかの手助けが必要ですが、むやみに人を雇って複雑さを覆い隠そうとすることは正しい答えではないことは何となくわかっています。

どうすればよいでしょうか。

## オーケストレーターの導入
"オーケストレーター" とは、管理者がこの種の環境を管理するのを支援するソフトウェアの一般的な用語です。オーケストレーターは、"このサービスの 5 つのコピーを環境で実行したい" といった要求を受け取り、それを実現して維持するコンポーネントです。

オーケストレーター (人ではありません) は、何らかの予期しない理由によってマシンで障害が発生したりワークロードが中断したりすると活動を開始します。ほとんどのオーケストレーターは、新しいデプロイの支援、アップグレードの処理、リソース消費の処理など、単なる障害対応以上のことを行いますが、基本的にはすべては環境内の構成を何らかの望ましい状態に維持することに関係しています。管理者としては、オーケストレーターに希望を伝えて重労働を任せることができればいいと思うでしょう。Mesos 上の Chronos または Marathon、Fleet、Swarm、Kubernetes、Service Fabric はすべて、オーケストレーターの例であるか、オーケストレーターが組み込まれています。異なる種類の環境と条件で実際のデプロイを管理する複雑さは拡大および変化しているので、常に新しいオーケストレーターが作成されています。

## サービスとしてのオーケストレーション
Service Fabric クラスターでのオーケストレーターのジョブは、主にクラスター リソース マネージャーによって行われます。Service Fabric クラスター リソース マネージャーは Service Fabric 内のシステム サービスの 1 つであり、各クラスターで自動的に起動されます。一般に、クラスター リソース マネージャーのジョブは 3 つの部分に分かれます。

1. ルールの強制
2. 環境の最適化
3. 他のプロセスの支援

### 説明
従来の N 層 Web アプリには、常に "Load Balancer" の概念が存在しました。通常は、ネットワーク スタック内での位置によりネットワーク ロード バランサー (NLB) またはアプリケーション ロード バランサー (ALB) と呼ばれます。ロード バランサーには、F5 の BigIP のようなハードウェア ベースのものと、Microsoft の NLB のようなソフトウェア ベースのものがあります。他の環境では、このロールに HAProxy のようなものを確認できます。これらのアーキテクチャでの負荷分散の仕事は、すべての異なるステートレス フロントエンド マシンまたはクラスター内の異なるマシンが、(ほぼ) 同じ量の作業を受け取るようにすることです。その方法は、異なる各呼び出しを異なるサーバーに送るといったものから、セッションの固定/持続性や、予想されるコストと現在のマシンの負荷に基づく実際の推定と呼び出しの割り当てまで、さまざまです。

これはせいぜい、Web 層をほぼ同じバランスに維持するメカニズムであったことに注意してください。データ層のバランスをとる方法はまったく異なるもので、データ ストレージ メカニズムに依存し、通常はデータ シャーディング、キャッシュ、管理されたデータベースのビュー、ストアド プロシージャなどが中心になります。

これらの方法の中には興味深いものもありますが、Service Fabric クラスター リソース マネージャーはネットワーク ロード バランサーやキャッシュとはまったく異なるものです。ネットワーク ロード バランサーがトラフィックをサービスが実行されている場所に移動することによってフロントエンドのバランスをとるのに対し、Service Fabric クラスター リソース マネージャーはまったく異なる方法を使用します。基本的には、Service Fabric は (トラフィックや負荷がそれに続くと想定して) *サービス*をそれが最も意味のある場所に移動します。たとえば、割り当てられているサービスがすぐにはあまりやることがない、または削除されたか別の場所に移動されたために現在コールド状態になっているノードなどです。または、別の例として、クラスター リソース マネージャーが、アップグレードされようとしているマシンや、実行されているサービスによる使用量の急増により過負荷状態になっているマシンからサービスを離す場合もあります。クラスター リソース マネージャーはサービスを移動させる役割を担う (ネットワーク トラフィックをサービスが既に実行している場所に提供しない) ため、ネットワーク ロード バランサーでの確認対象となるものと比較して大幅に異なる機能セットを含み、クラスター内のハードウェア リソースを適切に使用できるようにするまったく異なる方法を採用します。

## 次のステップ
- クラスター リソース マネージャーのアーキテクチャと情報フローについては、[この記事](service-fabric-cluster-resource-manager-architecture.md)を参照してください。
- クラスター リソース マネージャーには、クラスターを記述するためのさまざまなオプションがあります。オプションの詳細については、[Service Fabric クラスターの記述](service-fabric-cluster-resource-manager-cluster-description.md)に関する記事を参照してください。
- サービスの構成に利用できるその他のオプションの詳細については、[サービスの構成の詳細に関する記事](service-fabric-cluster-resource-manager-configure-services.md)にある、その他のクラスター リソース マネージャーのトピックを参照してください。
- メトリックは、Service Fabric クラスター リソース マネージャーが管理するクラスターの利用量と容量を表します。メトリックの詳細とその構成方法については、[この記事](service-fabric-cluster-resource-manager-metrics.md)を参照してください。
- クラスター リソース マネージャーは Service Fabric の管理機能と連動します。その統合の詳細については、[この記事](service-fabric-cluster-resource-manager-management-integration.md)を参照してください。
- クラスター リソース マネージャーでクラスターの負荷を管理し、分散するしくみについては、[負荷分散](service-fabric-cluster-resource-manager-balancing.md)に関する記事を参照してください。

<!---HONumber=AcomDC_0824_2016-->