<properties
   pageTitle="Service Fabric クラスター リソース マネージャーの概要"
   description="Service Fabric クラスター リソース マネージャーについての概要。"
   services="service-fabric"
   documentationCenter=".net"
   authors="masnider"
   manager="timlt"
   editor=""/>

<tags
   ms.service="Service-Fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="03/03/2016"
   ms.author="masnider"/>

# Service Fabric クラスター リソース マネージャーの概要

従来、IT システムまたは一連のサービスの管理では、いくつかのマシンをそれらの特定のサービスまたはシステム専用に使用しました。多くの主要なサービスは "Web" 層と "データ" 層または "ストレージ" 層に分かれ、普通はそれ以外にキャッシュなどのいくつかの特殊なコンポーネントがあります。他には要求が出入りするメッセージング層を持つアプリケーションの種類があり、メッセージングの一部として必要な分析や変換のための処理層に接続されています。各部分には 1 個または 2 個の専用マシンが使用されます。データベースには 2 個の専用マシンが使用され、Web サーバーには数個が使用されます。特定の種類のワークロードがそのワークロード用のマシンの能力を超えた場合は、そのワークロード用に構成されたマシンの数を増やすか、または何台かを大型のマシンに置き換えます。簡単です。マシンで障害が発生した場合、マシンが復元されるまで、アプリケーションのその部分の処理能力が低下します。まだ (楽しくはないにしても) 十分に簡単です。

ところが、スケール アウトが必要になり、コンテナーやマイクロサービスを追加する場合を考えてみてください。突然、数百または何千ものマシン、何十種類ものサービス、これらのサービスのおそらく何百ものインスタンスがあり、それぞれに高可用性 (HA) のためのインスタンスまたはレプリカが 1 つ以上あることに気付くのです。

いきなり、環境の管理は、1 種類のワークロードに専用の数台のマシンの管理といった単純なものではなくなります。サーバーは仮想化されており、もはや名前を持たず (考え方を[ペットから家畜の牛](http://www.slideshare.net/randybias/architectures-for-open-and-scalable-clouds/20)に変えます)、マシンは 1 種類のワークロードの専用ではありません。マシンに関する構成は減り、サービス自体に関する構成が増えています。

このように従来の単一の階層化されたアプリを複数の異なるサービスに分離および分割した結果として、はるかに多くの組み合わせに対応する必要があります。特定の 1 台または 2 台のハードウェアで実行できるワークロードの種類をだれが決定しますか。 マシンがダウンをしたとき、そこでは何が実行していましたか。 確実に再実行する責任はだれにありますか。 (仮想) マシンが回復するまで待ちますか、またはワークロードは実行し続けていますか。 復旧には人間の介入が必要ですか。 このような環境でのアップグレードについてはどうですか。 何らかの手助けが必要ですが、むやみに人を雇って複雑さを覆い隠そうとすることは正しい答えではないことは何となくわかっています。

どうすればよいでしょうか。

## オーケストレーターの導入
"オーケストレーター" とは、管理者がこの種のデプロイを管理するのを支援するソフトウェアの一般的な用語です。オーケストレーターは、"このサービスの 5 つのコピーを環境で実行したい" といった要求を受け取り、それを実現して維持するコンポーネントです。オーケストレーター (人ではありません) は、何らかの予期しない理由によってマシンで障害が発生したりワークロードが中断したりすると活動を開始します。ほとんどのオーケストレーターは、新しいデプロイの支援、アップグレードの処理、リソース消費の処理など、単なる障害対応以上のことを行いますが、基本的にはすべては環境内の構成を何らかの望ましい状態に維持することに関係しています。管理者としては、オーケストレーターに希望を伝えて重労働を任せることができればいいと思うでしょう。Mesosphere 上の Chronos、Fleet、Swarm、Kubernetes、Service Fabric はすべて、オーケストレーターが組み込まれています。異なる種類の環境と条件で実際のデプロイを管理する複雑さは拡大および変化しているので、常に新しいオーケストレーターが作成されています。

## サービスとしてのオーケストレーション
Service Fabric クラスターでのオーケストレーターのジョブは、主にクラスター リソース マネージャーによって行われます。Service Fabric クラスター リソース マネージャーは Service Fabric 内のシステム サービスの 1 つであり、各クラスターで自動的に起動されます。一般に、リソース マネージャーのジョブは 3 つの部分に分かれます。

1. ルールの強制
2. 環境の最適化
3. 他のプロセスの支援

リソース マネージャーのすべての機能を見ていく前に、そのしくみについて簡単に説明します。Service Fabric クラスター リソース マネージャー

## 一般的なアーキテクチャと実装
クラスター リソース マネージャーとそのすべての機能を詳しく説明する前に、クラスター リソース マネージャーとはどのようなもので、どのように動作するのかについて少し説明します。

### 説明
従来の N 層 Web アプリには、常に "Load Balancer" の概念が存在しました。通常は、ネットワーク スタック内での位置によりネットワーク ロード バランサー (NLB) またはアプリケーション ロード バランサー (ALB) と呼ばれます。ロード バランサーには、F5 の BigIP のようなハードウェア ベースのものと、Microsoft の NLB のようなソフトウェア ベースのものがあります。これらのアーキテクチャでの負荷分散の仕事は、すべての異なるステートレス フロントエンド マシンまたはクラスター内の異なるマシンが、(ほぼ) 同じ量の作業を受け取るようにすることです。その方法は、異なる各呼び出しを異なるサーバーに送るといったものから、セッションの固定/持続性や、予想されるコストと現在のマシンの負荷に基づく実際の推定と呼び出しの割り当てまで、さまざまです。

これはせいぜい、Web 層をほぼ同じバランスに維持するメカニズムであったことに注意してください。データ層のバランスをとる方法はまったく異なるもので、データ ストレージ メカニズムに依存し、通常はデータ シャーディング、キャッシュ、管理されたデータベースのビュー、ストアド プロシージャなどが中心になります。

これらの方法の中には興味深いものもありますが、Service Fabric クラスター リソース マネージャーはネットワーク ロード バランサーやキャッシュとはまったく異なるものです。NLB がトラフィックをサービスが実行されている場所に移動することによってフロントエンドのバランスをとるのに対し、Service Fabric リソース マネージャーはまったく異なる方法を使用します。基本的には、Service Fabric はサービスをそれが最も意味のある場所に移動します。たとえば、割り当てられているサービスがすぐにはあまりやることがないために現在コールド状態になっているノードなどです。または、アップグレードされようとしているノードや、実行されているサービスの使用量の急増により過負荷状態になっているノードから離れているノードの場合もあります。Service Fabric リソース マネージャーは、(サービスが既にある場所にネットワーク トラフィックを送るのではなく) サービスの移動を行うため、汎用性が高く、サービスを移動する場所や方法の制御に関する追加機能も含まれます。

<!--Every topic should have next steps and links to the next logical set of content to keep the customer engaged-->
## 次のステップ
- [クラスター リソース マネージャーのアーキテクチャについて](service-fabric-cluster-resource-manager-architecture.md)
- [クラスターの説明](service-fabric-cluster-resource-manager-cluster-description.md)
- [Learn about configuring Services (サービスの構成について)](service-fabric-cluster-resource-manager-configure-services.md)
- [メトリックの詳細](service-fabric-cluster-resource-manager-metrics.md)
- [クラスター リソース マネージャーと Service Fabric の他の管理機能の統合方法について](service-fabric-cluster-resource-manager-management-integration.md)

<!---HONumber=AcomDC_0309_2016-->