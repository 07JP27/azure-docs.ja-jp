---
title: リソース マネージャー アーキテクチャ | Microsoft Docs
description: Service Fabric クラスター リソース マネージャーのアーキテクチャの概要。
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: ''

ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/19/2016
ms.author: masnider

---
# クラスター リソース マネージャーのアーキテクチャの概要
Service Fabric クラスター リソース マネージャーには、クラスター内のリソースを管理するための情報がいくつか必要です。現在存在しているサービスと、これらのサービスが現在 (または既定で) 消費しているリソースの量を把握している必要があります。クラスター内のノードの実際の容量、つまり、使用可能なリソースがクラスター全体でどれくらいあるか、および特定のノードでどれくらいリソースが残っているかの両方を把握している必要があります。特定のサービスのリソースの消費は時間の経過と共に変わり、またサービスは実際に複数のリソースを使用します。異なる多数のサービスには、メモリーやディスク消費などのメトリックとして測定、報告される実際の物理リソースと、(より一般的な) 論理メトリック (WorkQueueDepth、TotalRequests など) の両方があります。論理および物理メトリックはいずれも、さまざまな種類の数多くのサービスで使用できる場合もあれば、少数のサービスでしか使用できない場合もあります。

## その他の考慮事項
クラスターの所有者やオペレーターがサービス作成者と違うことや、少なくとも同じ人物がいくつかの職務を掛け持ちしていることもあります。たとえば、サービスを開発しているときは、リソース要件およびさまざまなコンポーネントの最適なデプロイの方法についてはわずかな知識しかありませんが、運用環境のサービスで稼働中のサイトのインシデントを処理するときには、職務は別になるため、別のツールを使用する必要があります。また、クラスターもサービス自体も静的には構成されません。クラスターのノード数が増減したり、さまざまなサイズのノードが追加、削除されたり、サービスが作成、削除されたり、またサービスによって、必要なリソースの割り当てがその場で変更されたりする場合があります。アップグレードやその他の管理操作がクラスター全体に適用される場合があり、また障害もいつ発生するかわかりません。

## クラスター リソース マネージャーのコンポーネントとデータ フロー
クラスター リソース マネージャーは、各サービス、そしてこれを構成するステートレスなインスタンスやステートフルなレプリカの要件と同様に、クラスター全体に関する多数の知識が必要です。Service Fabric には、これを実現する、個々のノード上で実行される、ローカルのリソース消費情報を集計するクラスター リソース マネージャーのエージェントと、サービスとクラスターのすべての情報を集め、現在の構成に基づいて対応する、一元的なフォールト トレランス機能を備えたクラスター リソース マネージャー サービスの 2 つがあります。クラスター リソース マネージャー サービス (およびその他のすべてのシステム サービス) のフォールト トレランスは、お使いのサービスに使用されているのと完全に同じ (サービスの状態をクラスター内のいくつかのレプリカ (通常は 7 つ) にレプリケーションする) メカニズムにより実現されます。

![リソース バランサーのアーキテクチャ][Image1]

例として上の図を見てみましょう。実行時には、たくさんの変更がある場合があります。たとえば、サービスのリソース消費量が変わったり、サービスで障害が発生したり、クラスターにノードの追加や削除がある場合があります。特定のノードのすべての変更は、集計されて、クラスター リソース マネージャー サービスに定期的に送信 (1、2) されます。ここでは再度集計、分析、および格納が行われます。サービスは数秒ごとにすべての変更を確認し、何らかのアクションをとる必要があるか判断します (3)。たとえば、クラスターにノードが追加され、それが空であることを検出し、それらのノードにサービスを追加することを決定するなどです。また、特定のノードに過剰の負荷がかかっていること、または特定のサービスで障害が発生したり (削除されたり)、他のノードでリソースが開放されたことを検出する場合があります。

以下の図を見て、次に何が起こるか見てみましょう。たとえば、変更が必要であるとクラスター リソース マネージャーが判断するとします。その他のシステム サービス (具体的には Failover Manager) と調整を行い、必要な変更を行います。次いで変更要求を適切なノードに送信します (4)。この場合、リソース マネージャーがノード 5 に過剰な負荷がかかっていることに気付き、サービス B を N5 から N4 に移動することに決定したとします。再構成後 (5)、クラスターは次のようになります。

![リソース バランサーのアーキテクチャ][Image2]

## 次のステップ
* クラスター リソース マネージャーには、クラスターを記述するためのさまざまなオプションがあります。オプションの詳細については、[Service Fabric クラスターの記述](service-fabric-cluster-resource-manager-cluster-description.md)に関する記事を参照してください。

[Image1]: ./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-1.png
[Image2]: ./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-2.png

<!---HONumber=AcomDC_0824_2016-->