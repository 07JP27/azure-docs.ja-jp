<properties
	pageTitle=".NET SDK ???????? ?? ???? (VoD) ????????"
	description="????????????Azure Media Services ? .NET ???????? ?? ???? (VoD) ???????????????????????????"
	services="media-services"
	documentationCenter=""
	authors="Juliako"
	manager="dwrede"
	editor=""/>

<tags
	ms.service="media-services"
	ms.workload="media"
	ms.tgt_pltfrm="na"
	ms.devlang="dotnet"
	ms.topic="hero-article" 
	ms.date="08/11/2015" 
	ms.author="juliako"/>


# .NET SDK ???????? ?? ???? (VoD) ????????

[AZURE.INCLUDE [media-services-selector-get-started](../../includes/media-services-selector-get-started.md)]


>[AZURE.NOTE]
> ?????????????????Azure ???????????????????????????????????????????????????????????<a href="http://www.windowsazure.com/pricing/free-trial/?WT.mc_id=A8A8397B5" target="_blank">Azure ?????????</a>???????????

????????????Azure Media Services (AMS) SDK for .NET ???????? ?? ???? (VoD) ??????????????????????????????


????????? Media Services ?????????????Media Services ??????????????????? ???????????????????????????????????????? ???? ?????????????????????????????????????????? ??????????????

## ????
Media Services SDK for .NET ???????????????????????????

- ???????? ????: Windows 7?Windows 2008 R2?Windows 8 ????????
- .NET Framework 4.5 ? .NET Framework 4.0
- Visual Studio 2013?Visual Studio 2012?Visual Studio 2010 SP1 (Professional?Premium?Ultimate?Express ?????)?


?????? ????????????????????

1.  ????????? Media Services ????????
2.  ??????? ?????????? (??????)
3.  Visual Studio ????????????
5.  Media Services ?????????
1.  ?????????????? ???????????
1.  ????????? ?????? MP4 ???????? ????????????
1.  ??????????????????????
1.  ???????????????? URL ???????? ?????? URL ?????  
1.  ????????


##????????? Media Services ????????

1. [??????][]??**[??]**?**[???? ????]**?**[????]** ???????????

	![???? ?????????](./media/media-services-dotnet-get-started/wams-QuickCreate.png)

2. **[??]** ??????????????????????????? ???? ???????????????????????????????????????????? 3 ~ 24 ?????

3. **[?????]** ?????????? ???? ??????????? ???????????????????????????? ?????????????? ???? ???????????????

4. **[????? ?????]** ?????????? ???? ?????????? ?????? BLOB ????????????? ???????????????? ???? ???????????????????????? ?????????????????????? ?????????????????????????? ?????????????????????

5. ???????? ??????????????**[???????? ??????]** ?????????? ???????????????????? ???????????????? ???? ???????????

6. ?????????? **[????]** ?????????

	????????????????????????????????

	????????????????????? [?????] ???????

	?????? **[?????]** ?????????????????????????Media Services ???????????? ???????? ????????????????Media Services ?????????????????????????????????? ???????????


	![[???? ????] ???](./media/media-services-dotnet-get-started/wams-mediaservices-page.png)

	????????????????????? [???? ????] ????????????????????????????????????????????????????????????? ????????????????????????????[?????] ?????????????????


##??????? ?????????? (??????)

???????????????? ?????? ???????????Azure Media Services ???????? 1 ?????????? ?????? ???????????????????????CPU ?????????????????????????????????? ?????????????????????????????Media Services ?????????????? ?????? ??????? ???????HTTP ??? ??????? (HLS)????? ????????MPEG DASH?HDS (Adobe PrimeTime/Access ?????????) ???

Media Services ?????????????????????? ?????? MP4 ??????? ???????????????????????Media Services ????????????????? (MPEG DASH?HLS????? ????????HDS) ??????????????????????????????????????????????????????

???????????????????????????????

- mezzanine (???) ?????????????? ?????? MP4 ????????????? ?????? ???? ??????? ?????????????????????? (??????????????)?  
- ???????????**??????? ???????**???????? ?????????? 1 ??????

????????????????????????????????????????????????????Media Services ???????????????????????????????

???????????????????????????????????

1. [??????](https://manage.windowsazure.com/)??**[???? ????]** ???????????????? ????????????????

2. [??????? ???????] ???????????????????????? ????????????????

3. ??????? ??????????????[????] ?????????**[????]** ????????????

	![[????] ???](./media/media-services-dotnet-get-started/media-services-origin-scale.png)

4. [??] ?????????????????

	????????????????????? 20 ???????


	>[AZURE.NOTE]?????????????? ????????????????????????????? 1 ??????????
	>
	> ??????????24 ??????????????????????????????????????????[Azure ?????](http://go.microsoft.com/fwlink/?LinkId=275107)???????????



##Visual Studio ????????????

1. Visual Studio 2013?Visual Studio 2012 ? Visual Studio 2010 SP1 ??C# ????????? ???????????????**[??]**?**[??]**?**[????????]** ?????[OK] ?????????

2. Nuget ????? [windowsazure.mediaservices.extensions](https://www.nuget.org/packages/windowsazure.mediaservices.extensions) ????? **Azure Media Services .NET SDK Extensions** ???????????Media Services .NET SDK Extensions ???????????Media Services ????????????????????????????????????????????????**Media Services .NET SDK** ??????????????????????????????????

3. System.Configuration ???????????????????????????????? (App.config ??) ?????????? System.Configuration.ConfigurationManager ????????????

4. App.config ??????? (??????????????????????????????????)?????? *appSettings* ????????????Azure Media Services ????????????? ?????????????????????????????????????????Azure ?????????? Media Services ???????????[**?????**] ?????????


	<pre><code>
&lt;configuration>
    &lt;appSettings>
	&lt;add key="MediaServicesAccountName" value="Media-Services-Account-Name" />
    	&lt;add key="MediaServicesAccountKey" value="Media-Services-Account-Key" />
    &lt;/appSettings>
&lt;/configuration>
</code></pre>


5. Program.cs ??????????????????????????????????

		using System;
		using System.Collections.Generic;
		using System.Linq;
		using System.Text;
		using System.Threading.Tasks;
		using System.Configuration;
		using System.Threading;
		using System.IO;
		using Microsoft.WindowsAzure.MediaServices.Client;
		using Microsoft.WindowsAzure.MediaServices.Client.DynamicEncryption;

6. ?????? ????????????????????????????????????????? ???????????? .mp4 ????? .wmv ??????????????????"C:\VideoFiles" ????????????

##Media Services ?????????

Media Services ? .NET ????????Media Services ???????????? ???????????????????? (????????? ????????????? ????????????) ???????????????????**CloudMediaContext** ????????????

??? Program ????????????????????????App.config ???????????????CloudMediaContext ??????????? Media Services ???????????????Media Services ??????????????[Media Services SDK for .NET ????? Media Services ????](http://msdn.microsoft.com/library/azure/jj129571.aspx)?????????

**Main** ??????????????????????????

    class Program
    {
        // Read values from the App.config file.
        private static readonly string _mediaServicesAccountName =
            ConfigurationManager.AppSettings["MediaServicesAccountName"];
        private static readonly string _mediaServicesAccountKey =
            ConfigurationManager.AppSettings["MediaServicesAccountKey"];

        // Field for service context.
        private static CloudMediaContext _context = null;
        private static MediaServicesCredentials _cachedCredentials = null;

        static void Main(string[] args)
        {
            try
            {
                // Create and cache the Media Services credentials in a static class variable.
                _cachedCredentials = new MediaServicesCredentials(
                                _mediaServicesAccountName,
                                _mediaServicesAccountKey);
                // Used the chached credentials to create CloudMediaContext.
                _context = new CloudMediaContext(_cachedCredentials);

                // Add calls to methods defined in this section.

                IAsset inputAsset =
                    UploadFile(@"C:\VideoFiles\BigBuckBunny.mp4", AssetCreationOptions.None);

                IAsset encodedAsset =
                    EncodeToAdaptiveBitrateMP4s(inputAsset, AssetCreationOptions.None);

                ConfigureClearAssetDeliveryPolicy(encodedAsset);

                PublishAssetGetURLs(encodedAsset);
            }
            catch (Exception exception)
            {
                // Parse the XML error message in the Media Services response and create a new
                // exception with its content.
                exception = MediaServicesExceptionParser.Parse(exception);

                Console.Error.WriteLine(exception.Message);
            }
            finally
            {
                Console.ReadLine();
            }
        }

##?????????????? ???????????

Media Services ?????? ????????????????? (????) ???**Asset** ?????????????????????????????????????? ?????????? ?????? ???? (??????????????) ???????? ???????????????????????????????????????????????????????????????????????????**???? ????**??????

??????? **UploadFile** ??????(.NET SDK Extensions ????????) **CreateFromFile** ????????**CreateFromFile** ????????????? ??????????????????????????????

**CreateFromFile** ????? **AssetCreationOptions** ???????????????????????????????

- **None**: ??????????????????????????????????????????????????????????????????????????????????????? ??????????? MP4 ??????????????????????
- **StorageEncrypted**: ????? AES-256 ???????????????????????????????? Azure Storage ?????????????????????????????????????????StorageEncrypted ?????????????????????????????????????????????? ??????????????????????????????????????????????????????????StorageEncrypted ????????????????? ??????????????????????????????????????????????
- **CommonEncryptionProtected**: ?? Common Encryption ? PlayReady DRM ??????????????????? (PlayReady DRM ?????????? ?????????) ???????????????????????????
- **EnvelopeEncryptionProtected**: AES ??????? HLS ????????????????????????????????????Transform Manager ?????????????????????????????????

**CreateFromFile** ???????????????????????????????????????????????

?????????????????? **None** ?????????

??????? Program ??????????

	static public IAsset UploadFile(string fileName, AssetCreationOptions options)
	{
	    IAsset inputAsset = _context.Assets.CreateFromFile(
	        fileName,
	        options,
	        (af, p) =>
	        {
	            Console.WriteLine("Uploading '{0}' - Progress: {1:0.##}%", af.Name, p.Progress);
	        });

	    Console.WriteLine("Asset {0} created.", inputAsset.Id);

	    return inputAsset;
	}


##????????? ?????? MP4 ???????? ????????????

Media Services ????????????????????????????????????????????????????????????????????????????????????????????????????? ??? ?????????????????????????????????????????????????????????? ???????????????????? ???????????

??????????Azure Media Services ???????? 1 ??????????????????? ?????? ????????????Media Services ???HTTP ??? ??????? (HLS)????? ????????MPEG DASH?HDS (Adobe PrimeTime/Access ?????????) ?????????????????? ?????? MP4 ????????????????????????

???????????????????????????????

- mezzanine (???) ?????????????? ?????? MP4 ????????????? ?????? ???? ??????? ???????????????????????  
- ?????????????????? ??????????????? ?????????? 1 ??????

???????????????? ?????????????????????????**Azure ???? ??????**????? mezzanine ?????????????? ?????? MP4 ???????????????????? 1 ?????????????????????????????????

?????????????????????????????????????????? MP4 ???????????????????????????
MP4 ?????????????????????????????? ??????? ??????????????????


??????? Program ??????????

	static public IAsset EncodeToAdaptiveBitrateMP4s(IAsset asset, AssetCreationOptions options)
	{
		// Prepare a job with a single task to transcode the specified asset
        // into a multi-bitrate asset.

	    IJob job = _context.Jobs.CreateWithSingleTask(
	        MediaProcessorNames.AzureMediaEncoder,
	        MediaEncoderTaskPresetStrings.H264AdaptiveBitrateMP4Set720p,
	        asset,
	        "Adaptive Bitrate MP4",
	        options);

		Console.WriteLine("Submitting transcoding job...");


	    // Submit the job and wait until it is completed.
	    job.Submit();

	    job = job.StartExecutionProgressTask(
	        j =>
	        {
	            Console.WriteLine("Job state: {0}", j.State);
	            Console.WriteLine("Job progress: {0:0.##}%", j.GetOverallProgress());
	        },
	        CancellationToken.None).Result;

	    Console.WriteLine("Transcoding job finished.");

	    IAsset outputAsset = job.OutputMediaAssets[0];

	    return outputAsset;
	}

##??????????????????????

Media Services ??????????????????????????????????????????????????????????????????????? (MPEG DASH?HLS?HDS????? ??????????????????) ????????????????????????????????? (???????Common Encryption ??) ?????????????????????????

?? **ConfigureClearAssetDeliveryPolicy** ??????????????????MPEG DASH?HLS????? ??????????????????????????????????????

??????? Program ??????????

    static public void ConfigureClearAssetDeliveryPolicy(IAsset asset)
    {
        IAssetDeliveryPolicy policy =
            _context.AssetDeliveryPolicies.Create("Clear Policy",
            AssetDeliveryPolicyType.NoDynamicEncryption,
            AssetDeliveryProtocol.HLS | AssetDeliveryProtocol.SmoothStreaming | AssetDeliveryProtocol.Dash, null);

        asset.DeliveryPolicies.Add(policy);
    }


##???????????????? URL ???????? ?????? URL ?????

??????????????????????????????????????????? "??" ??????????????????????????????????????????????Media Services ???2 ????????????????????OnDemandOrigin ?????????????????? (MPEG DASH?HLS????? ?????????) ??Access Signature (SAS) ?????????? ??????????????????

?????????????????????????????????????? URL ???????


???? ??????????????? URL ????????????

	{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest

HLS ???????? URL ????????????

	{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest(format=m3u8-aapl)

MPEG DASH ???????? URL ????????????

	{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest(format=mpd-time-csf)

???????????????? SAS URL ????????????

	{blob container name}/{asset name}/{file name}/{SAS signature}

Media Services .NET SDK Extensions ????????????? URL ???????????????? ??????????????

?????????.NET SDK Extensions ?????????????????????? URL ? ??????? ?????? URL ???????????????? ???????????????????????????????????

??????? Program ??????????

    static public void PublishAssetGetURLs(IAsset asset)
    {
        // Publish the output asset by creating an Origin locator for adaptive streaming,
        // and a SAS locator for progressive download.

        _context.Locators.Create(
            LocatorType.OnDemandOrigin,
            asset,
            AccessPermissions.Read,
            TimeSpan.FromDays(30));

        _context.Locators.Create(
            LocatorType.Sas,
            asset,
            AccessPermissions.Read,
            TimeSpan.FromDays(30));


        IEnumerable<IAssetFile> mp4AssetFiles = asset
                .AssetFiles
                .ToList()
                .Where(af => af.Name.EndsWith(".mp4", StringComparison.OrdinalIgnoreCase));

        // Get the Smooth Streaming, HLS and MPEG-DASH URLs for adaptive streaming,
        // and the Progressive Download URL.
        Uri smoothStreamingUri = asset.GetSmoothStreamingUri();
        Uri hlsUri = asset.GetHlsUri();
        Uri mpegDashUri = asset.GetMpegDashUri();

        // Get progressive download URLs for each MP4 file that was generated as a result
		// of encoding.
		List<Uri> mp4ProgressiveDownloadUris = mp4AssetFiles.Select(af => af.GetSasUri()).ToList();


        // Display  the streaming URLs.
        Console.WriteLine("Use the following URLs for adaptive streaming: ");
        Console.WriteLine(smoothStreamingUri);
        Console.WriteLine(hlsUri);
        Console.WriteLine(mpegDashUri);
        Console.WriteLine();

		// Display the progressive download URLs.
        Console.WriteLine("Use the following URLs for progressive download.");
        mp4ProgressiveDownloadUris.ForEach(uri => Console.WriteLine(uri + "\n"));
        Console.WriteLine();

        // Download the output asset to a local folder.
        string outputFolder = "job-output";
        if (!Directory.Exists(outputFolder))
        {
            Directory.CreateDirectory(outputFolder);
        }

        Console.WriteLine();
        Console.WriteLine("Downloading output asset files to a local folder...");
        asset.DownloadToFolder(
            outputFolder,
            (af, p) =>
            {
                Console.WriteLine("Downloading '{0}' - Progress: {1:0.##}%", af.Name, p.Progress);
            });

        Console.WriteLine("Output asset files available at '{0}'.", Path.GetFullPath(outputFolder));
    }

##????????  

????????????????????????????? ??????????? URL ????????

?????? ???????? URL:

???? ???????

	http://amstestaccount001.streaming.mediaservices.windows.net/ebf733c4-3e2e-4a68-b67b-cc5159d1d7f2/BigBuckBunny.ism/manifest

HLS

	http://amstestaccount001.streaming.mediaservices.windows.net/ebf733c4-3e2e-4a68-b67b-cc5159d1d7f2/BigBuckBunny.ism/manifest(format=m3u8-aapl)

MPEG DASH

	http://amstestaccount001.streaming.mediaservices.windows.net/ebf733c4-3e2e-4a68-b67b-cc5159d1d7f2/BigBuckBunny.ism/manifest(format=mpd-time-csf)

??????? ??????? URL (?????????):

	https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_H264_650kbps_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z

	https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_H264_400kbps_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z

	https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_H264_3400kbps_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z

	https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_H264_2250kbps_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z

	https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_H264_1500kbps_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z

	https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_H264_1000kbps_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z

	https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z

	https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_AAC_und_ch2_56kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z


????????????????[Azure Media Services Player](http://amsplayer.azurewebsites.net/azuremediaplayer.html) ???????

??????? ???????????????????? (IE?Chrome?Safari ??) ? URL ????????

##??????

??? ?? ???? ???????????????????[VoD ???????????](media-services-video-on-demand-workflow.md)

###????????
- <a href="http://channel9.msdn.com/Shows/Azure-Friday/Azure-Media-Services-101-Get-your-video-online-now-">Azure Media Services 101 - ??????????????????!</a>
- <a href="http://channel9.msdn.com/Shows/Azure-Friday/Azure-Media-Services-102-Dynamic-Packaging-and-Mobile-Devices">Azure Media Services 102 - ??????????????? ????</a>


<!-- Anchors. -->


<!-- URLs. -->
  [Web Platform Installer]: http://go.microsoft.com/fwlink/?linkid=255386
  [??????]: http://manage.windowsazure.com/
 

<!---HONumber=August15_HO7-->