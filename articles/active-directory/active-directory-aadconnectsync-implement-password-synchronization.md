<properties
	pageTitle="Azure AD Connect Sync - パスワード同期の実装"
	description="パスワード同期機能のしくみを理解するために必要な情報と環境でパスワード同期を有効にする方法について説明します。"
	services="active-directory"
	documentationCenter=""
	authors="markusvi"
	manager="swadhwa"
	editor=""/>

<tags
	ms.service="active-directory"
	ms.workload="identity"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="07/27/2015"
	ms.author="markusvi"/>


# Azure AD Connect Sync: パスワード同期の実装 

パスワード同期により、ユーザーはオンプレミス Active Directory にログインするときと同じパスワードを使用して Azure Active Directory にログインできるようになります。

このトピックでは、パスワード同期機能のしくみを理解するために必要な情報と環境でパスワード同期を有効にする方法について説明します。

## パスワード同期とは

パスワード同期は Azure Active Directory Connect Synchronization Services (Azure AD Connect Sync) の機能であり、オンプレミス Active Directory と Azure Active Directory (Azure AD) のユーザー パスワードを同期します。この機能を使用すると、ユーザーは、オンプレミス ネットワークにログインするときと同じパスワードを使用して、Azure Active Directory のサービス (Office 365、Microsoft Intune、CRM Online など) にログインできます。パスワード同期ベースの処理ではトークンの共有や交換がないため、この機能ではシングル サインオン (SSO) ソリューションは提供されないことに注意することが重要です。

> [AZURE.NOTE]FIPS とパスワード同期に対して構成されている Active Directory ドメイン サービスの詳細については、「Password Sync failing in FIPS-compliant systems (FIPS 準拠システムでパスワード同期が失敗する)」をご覧ください。
 
## パスワード同期の可用性

Azure Active Directory のユーザーはすべてパスワード同期を実行できます。パスワード同期とフェデレーション認証などの他の機能との互換性については、以下をご覧ください。

## パスワード同期のしくみ

パスワード同期は、Azure AD Connect Sync によって実装されるディレクトリ同期の拡張機能です。そのため、この機能が動作するためには、オンプレミスと Azure Active Directory の間にディレクトリ同期が構成されている必要があります。

Active Directory ドメイン サービスは、実際のユーザー パスワードをハッシュ値表現の形式で格納します。パスワードのハッシュを使用してオンプレミス ネットワークにログインすることはできません。また、設計上、ユーザーのプレーン テキスト パスワードにアクセスするように元に戻すことはできません。パスワードを同期するには、Azure AD Connect Sync でオンプレミス Active Directory のパスワード ハッシュを抽出します。Azure Active Directory 認証サービスに同期される前に、パスワード ハッシュには、追加のセキュリティ処理が行われます。パスワード同期処理の実際のデータ フローは、表示名や電子メール アドレスなどのユーザー データの同期と似ています。

パスワードは、他の属性に対する標準のディレクトリ同期ウィンドウよりも頻繁に同期されます。パスワードは、ユーザーごとに同期され、通常は時間順に同期されます。ユーザーのパスワードがオンプレミス AD からクラウドに対して同期されるとき、既存のクラウド パスワードは上書きされます。

パスワード同期機能を初めて有効にすると、パスワードの初期同期を実行し、スコープ内のすべてのユーザーのパスワードをオンプレミス Active Directory から Azure Active Directory に同期します。パスワードをクラウドに同期するユーザーのセットを明示的に定義することはできません。その後は、オンプレミス ユーザーがパスワードを変更すると、パスワード同期機能は、ほとんどの場合は数分以内に、それを検出して変更されたパスワードを同期します。パスワードの同期が失敗すると、パスワード同期機能は自動的に再試行します。パスワード同期の試行中にエラーが発生した場合、イベント ビューアーにエラーが表示されます。

パスワードの同期によって、現在ログイン中のユーザーが影響を受けることはありません。クラウド サービスにログインしているユーザーがオンプレミスのパスワードを変更した場合でも、クラウド サービスのセッションは中断せずに続けられます。ただし、クラウド サービスでユーザーの再認証が必要になったときは、すぐに新しいパスワードを提供する必要があります。この時点で、ユーザーは新しいパスワード、つまりその前にオンプレミス Active Directory からクラウドに同期されたパスワードを提供する必要があります。

## セキュリティに関する考慮事項

パスワードを同期するとき、ユーザーのプレーン テキスト形式のパスワードは、パスワード同期機能にも、Azure AD や関連するどのサービスにも公開されません。

また、オンプレミス Active Directory でパスワードを可逆的に暗号化された形式で保存する必要はありません。Windows Active Directory パスワード ハッシュのダイジェストが、オンプレミス AD と Azure Active Directory の間の伝送に使用されます。パスワード ハッシュのダイジェストを使用して、ユーザーのオンプレミス環境のリソースにアクセスすることはできません。

## パスワード ポリシーの考慮事項

パスワード同期を有効にすることによって影響を受ける 2 種類のパスワード ポリシーがあります。

1. パスワードの複雑性のポリシー
2. パスワードの有効期限のポリシー

### パスワードの複雑性のポリシー

パスワード同期を有効にすると、オンプレミス Active Directory で構成されているパスワードの複雑性のポリシーにより、同期されるユーザーに対してクラウドで定義されている複雑性のポリシーが上書きされます。つまり、ユーザーのオンプレミス Active Directory 環境において有効なパスワードは、Azure AD サービスのアクセスに使用できます。


> [AZURE.NOTE]クラウド内で直接作成されたユーザーのパスワードには、引き続きクラウドで定義されているパスワード ポリシーが適用されます。
 
### パスワードの有効期限のポリシー

ユーザーがパスワード同期のスコープ内にいる場合、クラウド アカウントのパスワードは "期限なし" に設定されます。つまり、オンプレミス環境でユーザーのパスワードの期限が切れても、クラウド サービスにはその期限切れパスワードを使用して引き続きログインできる可能性があります。

クラウドのパスワードは、次にユーザーがオンプレミス環境でパスワードを変更したときに更新されます。


## 同期されたパスワードの上書き

管理者は、Azure Active Directory PowerShell を使用して手動でユーザーのパスワードをリセットできます。

この場合、新しいパスワードによってユーザーの同期されたパスワードは上書きされ、クラウドで定義されているすべてのパスワード ポリシーが新しいパスワードに適用されます。

ユーザーがオンプレミスのパスワードを再び変更した場合、新しいパスワードはクラウドに同期され、手動で更新したパスワードを上書きします。


## パスワード同期の準備

Azure Active Directory テナントのパスワード同期を有効にするには、先にディレクトリ同期を有効にする必要があります。


## パスワード同期の有効化

Azure AD Connect 構成ウィザードを実行するときに、パスワード同期を有効にします。

**[オプション機能]** ダイアログ ページで、[パスワード同期] を選択します。
 
![オプション機能][1]


> [AZURE.NOTE]このプロセスにより完全同期がトリガーされます。通常、完全同期サイクルの完了には他の同期サイクルより時間がかかります。
 

## パスワード同期の管理

Azure AD Connect を実行しているコンピューターのイベント ログを使用して、パスワード同期の進行状況を監視できます。


### パスワード同期のステータスの特定

以下の条件に一致するイベントを調べることによって、パスワードの同期に成功したユーザーを特定できます。

| から| イベント ID |
| --- | --- |
| ディレクトリ同期| 656|
| ディレクトリ同期| 657|
 
イベント ID 656 のイベントは、処理されたパスワードの変更要求のレポートを提供します。

![イベント ID 656][2]

ID 657 に対応するイベントは、これらの要求の結果を提供します。

![イベント ID 657][3]

イベントでは、影響を受けるオブジェクトがアンカーと DN の値によって識別されます。アンカーの値は、Get-MsoUser コマンドレットによってユーザーに返される **ImmutableId** の値に対応します。

オブジェクト ID に加えて、**イベント ID 656** は、ユーザーのパスワードがオンプレミス Active Directory で変更された日付を提供します。

![パスワード変更要求][4]

イベント ID 657 には、ソース オブジェクト ID に加えて、そのユーザー オブジェクトの同期ステータスを示す Result フィールドがあります。

パスワードの同期が正常に行われたことは、イベント ID 657 のイベントで Result 属性の値が Success に設定されていることによってわかります。パスワード同期の試行が失敗した場合、Result 属性の値は Failure になります。

![パスワード変更結果][5]

 
## パスワード同期の無効化

パスワード同期を無効にするには、Azure AD Connect 構成ウィザードを再び実行します。ウィザードで指定を求められたら、[パスワード同期] チェックボックスをオフにします。


> [AZURE.NOTE]このプロセスにより完全同期がトリガーされます。通常、完全同期サイクルの完了には他の同期サイクルより時間がかかります。
 
構成ウィザードを実行した後、テナントはパスワードを同期しなくなります。パスワードを新しく変更しても、クラウドには同期されません。それまでパスワードを同期していたユーザーは、クラウドでパスワードを手動で変更するまで、同期されたパスワードを使用して引き続きログインできます。



## その他のリソース

* [Azure AD Connect Sync: 同期オプションのカスタマイズ](active-directory-aadconnectsync-whatis.md)
* [オンプレミス ID と Azure Active Directory の統合](active-directory-aadconnect.md)
 
<!--Image references-->
[1]: ./media/active-directory-aadsync-implement-password-synchronization/IC759788.png
[2]: ./media/active-directory-aadsync-implement-password-synchronization/IC662504.png
[3]: ./media/active-directory-aadsync-implement-password-synchronization/IC662505.png
[4]: ./media/active-directory-aadsync-implement-password-synchronization/IC662506.png
[5]: ./media/active-directory-aadsync-implement-password-synchronization/IC662507.png

<!---HONumber=July15_HO5-->