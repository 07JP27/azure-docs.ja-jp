<properties 
    pageTitle="Azure Active Directory アプリケーション ギャラリーに含まれていないアプリケーションへのシングル サインオンの構成 | Microsoft Azure" 
    description="SAML およびパスワード ベースの SSO を使用して、Azure Active Directory にアプリをセルフサービス接続する方法について説明します。" 
    services="active-directory" 
    authors="asmalser-msft"  
    documentationCenter="na" manager="stevenpo"/>
<tags 
    ms.service="active-directory" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.tgt_pltfrm="na" 
    ms.workload="identity" 
    ms.date="11/18/2015" 
    ms.author="asmalser" />

#Azure Active Directory アプリケーション ギャラリーに含まれていないアプリケーションへのシングル サインオンの構成

[この記事]( https://azure.microsoft.com/documentation/articles/active-directory-appssoaccess-whatis/)で説明されているように、Azure Active Directory アプリケーション ギャラリーには、Azure Active Directory によるシングル サインオンの形式をサポートすることがわかっているアプリケーションの一覧が表示されます。(組織内の IT スペシャリストまたはシステム インテグレーターとして) 接続するアプリケーションを見つけたら、Microsoft Azure 管理ポータルに示される詳細な手順に従って、シングル サインオンを有効にすることができます。

[Azure Active Directory Premium](https://msdn.microsoft.com/library/azure/dn532272.aspx) ライセンスを持つ顧客は、Azure AD アプリケーション ギャラリーの **[カスタム]** カテゴリから呼び出すことができる以下の追加機能を取得します。

* SAML 2.0 ID プロバイダーをサポートする任意のアプリケーションのセルフサービス接続
* パスワード ベースの SSO を使用する HTML ベースのサインイン ページがある任意の Web アプリケーションのセルフサービス接続
* [Office 365 アプリ ランチャー]( https://blogs.office.com/2014/10/16/organize-office-365-new-app-launcher-2/)または [Azure AD アクセス パネル]( https://azure.microsoft.com/documentation/articles/active-directory-appssoaccess-whatis/#deploying-azure-ad-integrated-applications-to-users/)での任意のアプリケーションへのリンクの追加機能
* ユーザー プロビジョニング用の SCIM プロトコルを使用するアプリケーションのセルフサービス接続 ([ここで説明](active-directory-scim-provisioning))

これには、使用するが Azure AD アプリケーション ギャラリーにはまだ追加されていない SaaS アプリケーションだけでなく、組織がクラウドまたはオンプレミスで制御対象のサーバーにデプロイしたサードパーティの Web アプリケーションも含まれる場合があります。

注: アプリケーションとこの機能の間の互換性をテストする予定のアプリケーション開発者は、[Azure Active Directory Premium の無料試用版](https://azure.microsoft.com/trial/get-started-active-directory/)を使用して実行できますが、[社内使用権のライセンス](https://mspartner.microsoft.com/en/us/pages/membership/internal-use-software.aspx)を取得することをお勧めします。

##一覧にないアプリケーションまたはカスタム アプリケーションの追加 

アプリケーションを構成するには、Azure Active Directory の管理者アカウントを使用して Microsoft Azure 管理ポータルにサインインし、**[Active Directory]、[ディレクトリ]、[アプリケーション]** セクションの順に参照して、**[追加]** を選択してから **[ギャラリーからアプリケーションを追加]** を選択します。

![][1]

アプリ ギャラリーでは、左側の **[カスタム]** カテゴリを使用するか、必要なアプリが見つからない場合は検索結果に表示されている **[一覧にないアプリケーションを追加]** リンクを選択して、カスタム アプリを追加できます。アプリケーションの [名前] を入力すると、シングル サインオン オプションとその動作を構成できます。

**ポップ ヒント**: ベスト プラクティスとして、検索機能を使用して、アプリケーションが既にアプリケーション ギャラリー内に存在するかどうかを確認します。アプリが検出され、その説明に "シングル サインオン" と記載されている場合は、フェデレーション シングル サインオンで既にそのアプリケーションがサポートされています。

![][2]

カスタム アプリケーションを追加することで、事前に統合されたアプリケーションで使用可能なものによく似たエクスペリエンスが提供されます。作業を開始するには、**[シングル サインオンの構成]** を選択します。次の画面には、以降のセクションで説明されているシングル サインオンを構成するための 3 つのオプションが示されています。

![][3]


##Azure AD のシングル サインオン

アプリケーションの SAML ベースの認証を構成するには、このオプションを選択します。その場合、アプリケーションで SAML 2.0 がサポートされている必要があり、ユーザーは作業を続行する前に、アプリケーションの SAML 機能の使用方法に関する情報を収集する必要があります。**[次へ]** を選択すると、アプリケーションの SAML エンドポイントに対応する 3 つの異なる URL を入力するように求められます。

![][4]

ダイアログのツールヒント アイコンでは、各 URL とその使用方法に関する詳細が示されます。これらを入力したら、**[次へ]** をクリックして次の画面に進みます。この画面には、Azure AD からの SAML トークンを受け入れられるようにアプリケーション側で構成する必要がある内容についての情報が示されます。

![][5]

必要な値はアプリケーションによって異なるため、詳細についてはアプリケーションの SAML ドキュメントを参照してください。**サインオン**と**サインアウト** サービス URL の両方が、Azure AD のインスタンスの SAML 要求処理エンドポイントである同じエンドポイントに解決されます。発行者の URL は、アプリケーションに発行される SAML トークン内の "発行者" として表示される値です。

アプリケーションを構成したら、**[次へ]** ボタンをクリックしてから **[完了]** をクリックし、ダイアログを閉じます。

##SAML アプリケーションにユーザーとグループを割り当てる 

SAML ベースの ID プロバイダーとして Azure AD を使用するようにアプリケーションを構成すれば、テストの準備はほぼできています。セキュリティ コントロールの目的で、Azure AD では、ユーザーに Azure AD を使用するアクセス権が付与されない限り、アプリケーションへのサインインを許可するトークンは発行されません。ユーザーには、直接、またはユーザーがメンバーであるグループを介してアクセス権が付与される場合があります。

アプリケーションにユーザーまたはグループを割り当てるには、**[ユーザーの割り当て]** ボタンをクリックします。割り当てるユーザーまたはグループを選択してから、**[割り当て]** ボタンをクリックします。

![][6]

ユーザーを割り当てると、Azure AD でユーザーのトークンを発行できるようになり、ユーザーのアクセス パネルにこのアプリケーションのタイルも表示されるようになります。アプリケーション タイルは、ユーザーが Office 365 を使用している場合、Office 365 アプリケーション ランチャーでも表示されます。

アプリケーションの **[構成]** タブにある **[ロゴのアップロード]** ボタンを使用して、アプリケーションのタイル ロゴをアップロードできます。

###SAML トークンで発行された要求のカスタマイズ 

アプリケーションに対するユーザーの認証時に、Azure AD は、一意に識別するユーザーに関する情報 (または要求) を含む SAML トークンをアプリに発行します。既定では、ユーザーのユーザー名、電子メール アドレス、名、および姓が含まれます。

**[属性]** タブで、アプリケーションに SAML トークンで送信された要求を表示または編集できます。

![][7]

SAML トークンで発行された要求の編集が必要になる場合がある理由として 2 つが考えられます。1 つは、異なる要求 URI または要求値のセットを必要とするようにアプリケーションが作成されているという理由です。もう 1 つは、Azure Active Directory に格納されているユーザー名 (ユーザー プリンシパル名ともいう) 以外の名前にするために NameIdentifier 要求を必要とする方法でアプリケーションがデプロイされているという理由です。

これらのシナリオの要求を追加および編集する方法の詳細については、この[要求のカスタマイズに関する記事](active-directory-saml-claims-customization.md)を参照してください。

###SAML アプリケーションのテスト 

SAML URL と証明書が Azure AD とアプリケーションで構成されると、Azure でユーザーまたはグループはアプリケーションに割り当てられ、要求は確認され、必要に応じて編集されている状態です。したがって、ユーザーはアプリケーションへのサインインの準備はできています。

テストを行うには、単に、アプリケーションに割り当てたユーザー アカウントを使用して、https://myapps.microsoft.com で Azure AD アクセス パネルにサインインしてから、アプリケーションのタイルをクリックしてシングル サインオン プロセスを開始します。または、アプリケーションのサインオン URL を直接参照し、そこからサインインすることもできます。

デバッグのヒントについては、この[アプリケーションへの SAML ベースのシングル サインオンのデバッグ方法に関する記事](active-directory-saml-debugging.md)を参照してください。

##パスワード シングル サインオン

HTML サインイン ページがある Web アプリケーションの[パスワード ベースのシングル サインオン](active-directory-appssoaccess-whatis.md)を構成するには、このオプションを選択します。パスワード ベースの SSO (パスワード保管ともいう) では、ID フェデレーションをサポートしない Web アプリケーションに対するユーザーのアクセスおよびパスワードを管理できます。これは、複数のユーザーが、たとえば、組織のソーシャル メディア アプリ アカウントなどに、1 つのアカウントを共有する必要があるシナリオにも便利です。

**[次へ]** を選択すると、アプリケーションの Web ベースのサインイン ページの URL を入力するように求められます。このページには、ユーザー名とパスワードの入力フィールドが含まれている必要があることに注意してください。入力すると、Azure AD が、ユーザー名とパスワードを入力するためのサインイン ページを解析するプロセスを開始します。プロセスが失敗した場合は、フィールドを手動でキャプチャできるようにするブラウザー拡張機能 (Internet Explorer、Chrome、または Firefox が必要) をインストールする代替プロセスが示されます。

サインイン ページをキャプチャしたら、ユーザーとグループを割り当てることができ、資格情報ポリシーは通常の[パスワード SSO アプリ](active-directory-appssoaccess-whatis.md)の場合と同様に設定できます。

注: アプリケーションの **[構成]** タブにある **[ロゴのアップロード]** ボタンを使用して、アプリケーションのタイル ロゴをアップロードできます。

##既存のシングル サインオン

組織の Azure AD アクセス パネルまたは Office 365 ポータルにアプリケーションへのリンクを追加するには、このオプションを選択します。これを使用して、認証用に Azure AD の代わりに現在 Azure Active Directory フェデレーション サービス (または他のフェデレーション サービス) を使用しているカスタム Web アプリへのリンクを追加することができます。または、ユーザーのアクセス パネルに表示するだけの特定の SharePoint ページまたは他の Web ページにディープ リンクを追加することもできます。

**[次へ]** を選択すると、リンクするアプリケーションの URL を入力するように求められます。入力したら、ユーザーとグループをアプリケーションに割り当てることができ、これにより、アプリケーションが [Office 365 アプリ ランチャー]( https://blogs.office.com/2014/10/16/organize-office-365-new-app-launcher-2/)またはユーザーの [Azure AD アクセス パネル]( https://azure.microsoft.com/documentation/articles/active-directory-appssoaccess-whatis/#deploying-azure-ad-integrated-applications-to-users/)に表示されるようになります。

注: アプリケーションの **[構成]** タブにある **[ロゴのアップロード]** ボタンを使用して、アプリケーションのタイル ロゴをアップロードできます。

<!--Image references-->
[1]: ./media/active-directory-saas-custom-apps/customapp1.png
[2]: ./media/active-directory-saas-custom-apps/customapp2.png
[3]: ./media/active-directory-saas-custom-apps/customapp3.png
[4]: ./media/active-directory-saas-custom-apps/customapp4.png
[5]: ./media/active-directory-saas-custom-apps/customapp5.png
[6]: ./media/active-directory-saas-custom-apps/customapp6.png
[7]: ./media/active-directory-saas-custom-apps/customapp7.png

<!---HONumber=AcomDC_0128_2016-->