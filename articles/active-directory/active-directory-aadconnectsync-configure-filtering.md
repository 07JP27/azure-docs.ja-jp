<properties
	pageTitle="Azure AD Connect Sync: フィルター処理の構成 | Microsoft Azure"
	description="Azure AD Connect Sync でフィルター処理を構成する方法を説明します。"
	services="active-directory"
	documentationCenter=""
	authors="andkjell"
	manager="stevenpo"
	editor=""/>

<tags
	ms.service="active-directory"
	ms.workload="identity"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="12/30/2015"
	ms.author="andkjell;markusvi"/>


# Azure AD Connect Sync: フィルター処理の構成
オンプレミスのディレクトリからどのオブジェクトを Azure AD に反映するかは、フィルター処理で制御できます。既定の構成では、構成されているフォレスト内の全ドメインの全オブジェクトが対象となります。通常は、この構成を推奨します。たとえば、Office 365 のワークロード (Exchange Online、Skype for Business など) を使っているエンド ユーザーには、完全なグローバル アドレス一覧を表示した方が、電子メールの送信先や電話の相手を探すうえで便利です。既定では、オンプレミス環境の Exchange または Lync と同じ利便性が得られるように構成されています。

場合によっては、既定の構成に変更を加えなければならないこともあります。次に例をいくつか示します。

- [マルチ Azure AD ディレクトリ トポロジ](active-directory-aadconnect-topologies.md#each-object-only-once-in-an-azure-ad-directory)の使用を計画しています。そのうえでフィルターを適用し、特定の Azure AD ディレクトリに対してどのオブジェクトを同期させるかを制御する必要があります。
- Azure または Office 365 を試験運用しており、Azure AD に存在するユーザーの一部だけが必要な場合、小規模な試験では、完全なグローバル アドレス一覧がなくても機能を検証することができます。
- サービス アカウントなど、Azure AD には個人用以外のアカウントが多数存在します。
- コンプライアンス上の理由から、オンプレミスのユーザー アカウントは一切削除できないので単に無効化します。一方、Azure AD には、アクティブなアカウントだけが必要になります。

この記事では、各種フィルター処理方法の構成について取り上げます。

> [AZURE.IMPORTANT]公式に文書化されているアクションを除き、Microsoft は Azure AD Connect Sync の変更や操作をサポートしません。そのようなアクションを実行すると、Azure AD Connect Sync の状態に一貫性が失われたり、サポート対象外の状態になったりすることがあります。その結果、Microsoft はそのようなデプロイを技術的にサポートできなくなります。

## 基本事項と注意事項
Azure AD Connect Sync では、いつでもフィルター処理を有効にできます。最初に既定の構成でディレクトリ同期を実行した後、フィルター処理を構成した場合、フィルター処理により除外されるオブジェクトは、Azure AD に対する同期の対象外になります。そのため、以前同期されてからフィルター処理された Azure AD のオブジェクトは、すべて Azure AD から削除されます。

フィルター処理に変更を加える際は、未検証の変更が意図せずエクスポートされてしまうことのないよう、あらかじめ[タスクのスケジューリング](#disable-scheduled-task)を無効にしておいてください。

フィルター処理によって非常に多くのオブジェクトが同時に削除される可能性があります。フィルター処理に変更を加えたら、必ず検証したうえで、Azure AD に変更をエクスポートするようにしてください。構成作業を終えたら、変更内容を Azure AD にエクスポートして反映する前に[検証作業](#apply-and-verify-changes)を実行するよう強くお勧めします。

意図せず多数のオブジェクトを削除してしまうことのないよう、[誤って削除されないように保護する](active-directory-aadconnectsync-feature-prevent-accidental-deletes.md)機能が既定で有効になっています。既定ではフィルター処理で削除できるオブジェクトが 500 個に制限されていますが、それを超えるオブジェクトを削除する場合、この記事の手順に従って、削除処理を Azure AD に反映できるようにする必要があります。

November 2015 ([1\.0.9125](active-directory-aadconnect-version-history.md#1091250)) より前のビルドを使用し、フィルターの構成を変更して、パスワード同期を使用する場合は、構成を完了した後、すべてのパスワードの完全同期をトリガーする必要があります。パスワードの完全同期をトリガーする方法の手順については、「[すべてのパスワードの完全同期の開始](active-directory-aadconnectsync-implement-password-synchronization.md#trigger-a-full-sync-of-all-passwords)」を参照してください。1.0.9125 以降をご使用の場合、パスワードを同期する必要があるかどうかは通常の**完全同期**処理で計算されるので、この手順を別途行う必要はありません。

フィルター処理のエラーが原因で**ユーザー** オブジェクトが Azure AD から誤って削除された場合、フィルター処理構成を削除し、ディレクトリの同期を再実行することで、Azure AD 内にユーザー オブジェクトを再生成できます。Azure AD 内のごみ箱からユーザーが復元されます。ただし、その他の種類のオブジェクトについては削除を取り消すことができません。たとえば、リソースの ACL に使用されていたセキュリティ グループをうっかり削除すると、そのグループおよび対応する ACL は復元できなくなります。

削除されるのは、Azure AD Connect の作用対象 (スコープ) として認識されていたオブジェクトだけです。別の同期エンジンによって作成されたオブジェクトが Azure AD 内に存在していても、それらがスコープ内に存在しない場合、フィルター処理を追加しても、それらのオブジェクトは削除されません。たとえば、当初 DirSync サーバーによって Azure AD 内のディレクトリ全体が完全にコピーされているとき、最初からフィルター処理を有効にした状態で新しい Azure AD Connect Sync サーバーをインストールした場合、DirSync によって別途作成されたオブジェクトは削除されません。

新しいバージョンの Azure AD Connect のインストールまたはアップグレードを行ってもフィルター処理の構成は保持されます。新しいバージョンにアップグレードした後は、常に構成が誤って変更されていないことを確認してから、最初の同期サイクルを実行することをお勧めします。

複数のフォレストが存在する場合、このトピックで説明するフィルター処理構成をすべてのフォレストに適用する必要があります (すべてのフォレストに同じ構成を適用する場合)。

### スケジュールされたタスクを無効にする
同期サイクルを 3 時間おきにトリガーする、スケジュールされたタスクを無効にするには、以下の手順に従います。

- [スタート] メニューから **[タスク スケジューラ]** を起動します。
- **[タスク スケジューラ ライブラリ]** の直下から **"Azure AD Sync Scheduler"** というタスクを探して右クリックし、**[無効]** を選択します。![Task Scheduler](./media/active-directory-aadconnectsync-configure-filtering/taskscheduler.png)
- 以上の作業が済んだら構成の変更を行い、**Synchronization Service Manager** コンソールから同期エンジンを手動で実行できます。

フィルター処理の変更がすべて完了したら、忘れずにタスクの状態を **[有効]** に戻してください。

## フィルター処理オプション
ディレクトリ同期ツールには、次のフィルター処理構成タイプが適用できます。

- [**グループ ベース**](active-directory-aadconnect-get-started-custom.md#sync-filtering-based-on-groups): 単一のグループに基づくフィルター処理は、インストール ウィザードを使用して、初回インストール時にのみ構成できます。このトピックでは詳しい説明を省略します。

- [**ドメイン ベース**](#domain-based-filtering): どのドメインを Azure AD に同期させるかを選択できます。また、Azure AD Connect Sync をインストールした後でオンプレミス インフラストラクチャに変更を加えた場合、同期エンジンの構成でドメインを追加または削除することができます。

- [**組織単位ベース**](#organizational-unitbased-filtering): Azure AD との間で同期させる OU を選択できます。選択された OU 内のすべてのオブジェクト タイプが対象となります。

- [**属性ベース**](#attribute-based-filtering): オブジェクトの属性値に基づいてオブジェクトをフィルター処理できます。オブジェクトの種類ごとに異なるフィルターを使用することもできます。

フィルター処理のオプションは、同時に複数使用することができます。たとえば、OU ベースのフィルター処理で特定の OU 内のオブジェクトのみを対象にしたうえで、属性ベースのフィルター処理を併用してオブジェクトをさらに絞り込むことができます。複数のフィルター処理方法を使用した場合、それらのフィルターが論理積で組み合わされます。

## ドメイン ベースのフィルター処理
このセクションでは、ドメイン フィルターの構成に必要な手順について説明します。Azure AD Connect をインストールした後にフォレスト内のドメインを追加または削除した場合は、フィルター処理の構成も更新する必要があります。

ドメイン ベースのフィルター処理構成は、次の手順から成ります。

- 同期の対象とする[ドメインを選択](#select-domains-to-be-synchronized)します。
- 追加または削除された各ドメインについて、[実行プロファイル](#update-run-profiles)を調整します。
- [変更を適用して検証](#apply-and-verify-changes)します。

### 同期するドメインの選択
**ドメイン フィルターを設定するには、次の手順を実行します。**

- **ADSyncAdmins** セキュリティ グループに属するアカウントを使用して、Azure AD Connect Sync を実行しているサーバーにサインインします。
- [スタート] メニューから **[同期サービス]** を起動します。
- **[コネクタ]** を選択し、**[コネクタ]** の一覧から、種類が "**Active Directory ドメイン サービス**" であるコネクタを選択します。**[アクション]** の **[プロパティ]** を選択します。![Connector properties](./media/active-directory-aadconnectsync-configure-filtering/connectorproperties.png)
-  **[ディレクトリ パーティションの構成]** をクリックします。
- **[ディレクトリ パーティションの選択]** の一覧で、必要に応じてドメインを選択 (または選択を解除) します。同期するパーティションのみが選択されていることを確認します。![パーティション](./media/active-directory-aadconnectsync-configure-filtering/connectorpartitions.png) オンプレミスの AD インフラストラクチャに変更を加え、フォレストのドメインを追加または削除した場合は、**[更新]** ボタンをクリックして一覧を最新の情報に更新します。最新の情報に更新しようとすると資格情報を求められます。オンプレミスの Active Directory に対する読み取りアクセス権を持った資格情報を指定してください。ダイアログ ボックスにあらかじめ設定されているユーザーでなくてもかまいません。![Refresh needed](./media/active-directory-aadconnectsync-configure-filtering/refreshneeded.png)
- 完了したら、**[OK]** をクリックして **[プロパティ]** ダイアログを閉じます。フォレストからドメインを削除した場合、ドメインが削除されたことを示すメッセージが表示され、その構成がクリーンアップされます。
- 続けて[実行プロファイル](#update-run-profiles)を調整します。

### 実行プロファイルの更新
ドメイン フィルターを更新した場合、実行プロファイルも更新する必要があります。

- 前の手順で変更したコネクタが、**[コネクタ]** の一覧で選択されていることを確認します。**[アクション]** から **[実行プロファイルの構成]** を選択します。![Connector Run Profiles](./media/active-directory-aadconnectsync-configure-filtering/connectorrunprofiles1.png)

次のプロファイルを調整する必要があります。

- フル インポート
- 完全同期
- 差分インポート
- 差分同期
- エクスポート

5 つのプロファイルのそれぞれについて、**追加対象**のドメインごとに次の手順を実行します。

- 実行プロファイルを選択し、**[新しいステップ]** をクリックします。
- **[ステップの構成]** ページの **[タイプ]** ボックスの一覧から、構成するプロファイルと同じ名前の付いたステップの種類を選択します。その後、**[次へ]** をクリックします。![Connector Run Profiles](./media/active-directory-aadconnectsync-configure-filtering/runprofilesnewstep1.png)
- **[コネクタの構成]** ページで、**[パーティション]** ボックスの一覧から、ドメイン フィルターに追加したドメインの名前を選択します。![Connector Run Profiles](./media/active-directory-aadconnectsync-configure-filtering/runprofilesnewstep2.png)
- **[実行プロファイルの構成]** ダイアログ ボックスを閉じるには、**[完了]** をクリックします。

5 つのプロファイルのそれぞれについて、**削除対象**のドメインごとに次の手順を実行します。

- 実行プロファイルを選択します。
- **[パーティション]** 属性の **[値]** が GUID である場合は、実行ステップを選択し、**[ステップの削除]** をクリックします。![Connector Run Profiles](./media/active-directory-aadconnectsync-configure-filtering/runprofilesdeletestep.png)

最終的に、同期の対象となるすべてのドメインが各実行プロファイルにステップとして表示されている必要があります。

**[実行プロファイルの構成]** ダイアログ ボックスを閉じるには、**[OK]** をクリックします。

- 構成を完了するには、[変更を適用して検証](#apply-and-verify-changes)します。

## 組織単位ベースのフィルター処理
**組織単位ベースのフィルター処理を構成するには、次の手順を実行します。**

- **ADSyncAdmins** セキュリティ グループに属するアカウントを使用して、Azure AD Connect Sync を実行しているサーバーにサインインします。
- [スタート] メニューから **[同期サービス]** を起動します。
- **[コネクタ]** を選択し、**[コネクタ]** の一覧から、種類が "**Active Directory ドメイン サービス**" であるコネクタを選択します。**[アクション]** の **[プロパティ]** を選択します。![Connector properties](./media/active-directory-aadconnectsync-configure-filtering/connectorproperties.png)
-  **[ディレクトリ パーティションの構成]** をクリックし、構成するドメインを選択して、**[コンテナー]** をクリックします。
- 資格情報を求められたら、オンプレミスの Active Directory に対する読み取りアクセス権を持った資格情報を指定します。ダイアログ ボックスにあらかじめ設定されているユーザーでなくてもかまいません。
- **[コンテナーの選択]** ダイアログ ボックスで、クラウド ディレクトリと同期しない OU の選択を解除し、**[OK]** をクリックします。![OU](./media/active-directory-aadconnectsync-configure-filtering/ou.png)
	- Windows 10 コンピューターを Azure AD と正しく同期させるには、**[コンピューター]** コンテナーを選択する必要があります。ドメインに参加しているコンピューターが他の OU に置かれている場合、それらが選択されていることを確認してください。
	- 信頼関係のある複数のフォレストが存在する場合、**[ForeignSecurityPrincipals]** コンテナーを選択する必要があります。そうすることで、フォレスト間のセキュリティ グループのメンバーシップが解決されます。
	- デバイスの書き戻し機能を有効にした場合は、**[RegisteredDevices]** の OU を選択する必要があります。別の書き戻し機能 (グループの書き戻しなど) を使用する場合は、それらの場所が選択されていることを確認してください。
	- Users、iNetOrgPersons、Groups、Contacts、Computers の置かれている OU が他にあれば選択します。上の図では、いずれも ManagedObjects OU に存在します。
- 完了したら、**[OK]** をクリックして **[プロパティ]** ダイアログを閉じます。
- 構成を完了するには、[変更を適用して検証](#apply-and-verify-changes)します。

## 属性ベースのフィルター処理
以下の手順は、November 2015 ([1\.0.9125](active-directory-aadconnect-version-history.md#1091250)) 以降のビルドを想定しています。

属性ベースのフィルター処理は、オブジェクトをフィルター処理する手段として最も柔軟性の高い方法となります。[宣言型のプロビジョニング](active-directory-aadconnectsync-understanding-declarative-provisioning-expressions.md)の強みを活かして、Azure AD に対してオブジェクトを同期させるタイミングをあらゆる角度から制御することができます。

フィルター処理は、Active Directory からメタバース ([受信側](#inbound-filtering)) とメタバースから Azure AD ([送信側](#outbound-filtering)) のどちらにでも適用できます。フィルター処理は受信側に適用した方が管理しやすいため、そのようにすることをお勧めします。送信側のフィルター処理は、複数のフォレストからのオブジェクトを合わせたうえで評価する必要がある場合のみ使用してください。

### 受信のフィルター処理
受信ベースのフィルター処理は既定の構成を利用します。既定の構成では、AAD に送信されるオブジェクトを同期させるためには、メタバース属性 cloudFiltered の値が未設定となっている必要があります。この属性の値が **True** に設定されている場合、オブジェクトは同期されません。意図的に **False** に設定することは避けてください。他の規則から確実に値が得られるよう、この属性の値は **True** または **NULL** (未設定) のいずれかにする必要があります。

受信のフィルター処理では、同期の対象となるオブジェクトと対象外となるオブジェクトが**スコープ**の作用によって決定されます。この点は、組織ごとに実際の要件に合わせて調整することになります。スコープ モジュールには、同期規則の作用対象を判断する**グループ**と**句**があります。**グループ**は、1 つまたは複数の**句**を含みます。複数の句は論理積で組み合わされ、複数のグループは論理和で組み合わされます。

たとえば、次のようなフィルターがあるとします。![Scope](./media/active-directory-aadconnectsync-configure-filtering/scope.png) これは、**(department = IT) OR (department = Sales AND c = US)** という意味になります。

以降のサンプルとステップは、ユーザー オブジェクトが例として使用されていますが、実際にはオブジェクトの種類に関係なく利用できます。

以下のサンプルでは、優先順位の値が 500 から始まっています。こうすることで、評価される順序が標準の規則よりも後に来るようにしています (数値が大きいほど優先順位が低くなります)。

#### 否定のフィルター処理 (同期対象外の指定)
以下の例では、**extensionAttribute15** の値が **NoSync** であるすべてのユーザーをフィルターで除外 (同期対象外に) します。

- **ADSyncAdmins** セキュリティ グループに属するアカウントを使用して、Azure AD Connect Sync を実行しているサーバーにサインインします。
- [スタート] メニューから、**同期規則エディター**を起動します。
- **[受信]** が選択されていることを確認し、**[新しい規則の追加]** をクリックします。
- わかりやすい名前を規則に付けます ("*In from AD – User DoNotSyncFilter*" など)。適切なフォレストを選択し、**[接続されているシステム オブジェクトのタイプ]** として **[ユーザー]** を、**[メタバース オブジェクトの種類]** として **[人]** を選択します。**[リンクの種類]** として **[結合]** を選択し、[優先順位] に、他の同期規則で現在使われていない値 (500 など) を入力して、**[次へ]** をクリックします。![Inbound 1 description](./media/active-directory-aadconnectsync-configure-filtering/inbound1.png)
- **[スコープ フィルター]** で、**[グループの追加]** をクリックし、**[句の追加]** をクリックして、属性で **[ExtensionAttribute15]** を選択します。演算子を **EQUAL** に設定し、[値] ボックスに「**NoSync**」という値を入力します。**[次へ]** をクリックします。![Inbound 2 scope](./media/active-directory-aadconnectsync-configure-filtering/inbound2.png)
- **[参加]** 規則は空のままにして、**[次へ]** をクリックします。
- **[変換の追加]** をクリックして、**[FlowType]** を **[Constant]** に設定し、[ターゲット属性] で **cloudFiltered** を選択して、[ソース] ボックスに「**True**」と入力します。**[追加]** をクリックして規則を保存します。![Inbound 3 transformation](./media/active-directory-aadconnectsync-configure-filtering/inbound3.png)
- 構成を完了するには、[変更を適用して検証](#apply-and-verify-changes)します。

#### 肯定のフィルター処理 (同期対象の指定)
肯定のフィルター処理を式で表すことは、否定の場合と比べて難易度が上がります。同期の対象とするかどうかが不明確なオブジェクト (会議室など) も考慮しなければならないためです。

肯定のフィルター処理オプションには、2 つの同期規則が必要となります。1 つ (または複数) は、同期対象のオブジェクトのスコープを厳密に指定した規則、もう 1 つは、同期すべきオブジェクトとして認識されなかったすべてのオブジェクトをフィルターで除外する包括的な規則です。

以下の例では、department 属性の値が **Sales** であるユーザー オブジェクトだけを同期対象としています。

- **ADSyncAdmins** セキュリティ グループに属するアカウントを使用して、Azure AD Connect Sync を実行しているサーバーにサインインします。
- [スタート] メニューから、**同期規則エディター**を起動します。
- **[受信]** が選択されていることを確認し、**[新しい規則の追加]** をクリックします。
- わかりやすい名前を規則に付けます ("*In from AD – User Sales sync*" など)。適切なフォレストを選択し、**[接続されているシステム オブジェクトのタイプ]** として **[ユーザー]** を、**[メタバース オブジェクトの種類]** として **[人]** を選択します。**[リンクの種類]** で **[結合]** を選択し、[優先順位] に、別の同期規則で現在使用さていない値 (501 など) を入力して、**[次へ]** をクリックします。![Inbound 4 description](./media/active-directory-aadconnectsync-configure-filtering/inbound4.png)
- **[スコープ フィルター]** で、**[グループの追加]** をクリックし、**[句の追加]** をクリックして、属性で **[department]** を選択します。演算子を **EQUAL** に設定し、[値] ボックスに「**Sales**」という値を入力します。**[次へ]** をクリックします。![Inbound 5 scope](./media/active-directory-aadconnectsync-configure-filtering/inbound5.png)
- **[参加]** 規則は空のままにして、**[次へ]** をクリックします。
- **[変換の追加]** をクリックして、**[FlowType]** を **[Constant]** に設定し、[ターゲット属性] で **cloudFiltered** を選択して、[ソース] ボックスに「**False**」と入力します。**[追加]** をクリックして規則を保存します。![Inbound 6 transformation](./media/active-directory-aadconnectsync-configure-filtering/inbound6.png) これは特殊なケースですが、cloudFiltered を明示的に False に設定します。

次に、包括的な同期規則を作成する必要があります。

- わかりやすい名前を規則に付けます ("*In from AD – User Catch-all filter*" など)。適切なフォレストを選択し、**[接続されているシステム オブジェクトのタイプ]** として **[ユーザー]** を、**[メタバース オブジェクトの種類]** として **[人]** を選択します。**[リンクの種類]** で **[結合]** を選択し、[優先順位] に、別の同期規則で現在使用されていない値 (600 など) を入力します。優先順位の値は、先ほどの同期規則よりも大きく (優先順位を低く) しました。後で別の部門を同期する必要が生じることも考えられるので、値の間隔は、フィルター処理の同期規則を追加できるよう、ある程度を余裕を持たせています。**[次へ]** をクリックします。![Inbound 7 description](./media/active-directory-aadconnectsync-configure-filtering/inbound7.png)
- **[スコープ フィルター]** は空のままにして、**[次へ]** をクリックします。フィルターを空にした場合、すべてのオブジェクトに規則が適用されます。
- **[参加]** 規則は空のままにして、**[次へ]** をクリックします。
- **[変換の追加]** をクリックして、**[FlowType]** を **[Constant]** に設定し、[ターゲット属性] で **cloudFiltered** を選択して、[ソース] ボックスに「**True**」と入力します。**[追加]** をクリックして規則を保存します。![Inbound 3 transformation](./media/active-directory-aadconnectsync-configure-filtering/inbound3.png)
- 構成を完了するには、[変更を適用して検証](#apply-and-verify-changes)します。

必要であれば、1 つ目のタイプの規則をさらに作成し、同期対象のオブジェクトを増やすこともできます。

### 送信のフィルター処理
場合によっては、オブジェクトがメタバースに参加した後にのみ、フィルター処理を実行する必要があります。たとえば、オブジェクトを同期する必要があるかどうかを確認するには、リソース フォレストの mail 属性と、アカウント フォレストの userPrincipalName 属性を確認する必要があります。このような場合、送信ルールに関するフィルター処理を作成します。

この例では、フィルター処理を変更するので、mail と userPrincipalName の両方の末尾が @contoso.com であるユーザーのみが同期されます。

- **ADSyncAdmins** セキュリティ グループに属するアカウントを使用して、Azure AD Connect Sync を実行しているサーバーにサインインします。
- [スタート] メニューから、**同期規則エディター**を起動します。
- [規則の種類] の **[送信]** をクリックします。
- **[Out to AAD – User Join SOAInAD]** という規則を探します。**[編集]** をクリックします。
- ポップアップで **[はい]** を選択して規則のコピーを作成します。
- **[説明]** ページの優先順位の値を、まだ使用していない値 (50 など) に設定します。
- 左側のナビゲーションの **[スコープ フィルター]** をクリックします。**[句の追加]** をクリックし、[属性] で **[mail]** を選択して、[演算子] で **[ENDSWITH]** を選択し、[値] に「**@contoso.com**」と入力します。**[句の追加]** をクリックし、[属性] で **[userPrincipalName]** を選択して、[演算子] で **[ENDSWITH]** を選択し、[値] に「**@contoso.com**」と入力します。
- **[保存]** をクリックします。
- 構成を完了するには、[変更を適用して検証](#apply-and-verify-changes)します。

## 変更の適用と検証
構成を変更したら、それらの変更をシステム内の既存のオブジェクトに適用する必要があります。まだ同期エンジンに存在しないオブジェクトを処理し、ソース システムをもう一度読み取ってその内容を検証しなければならないケースも考えられます。

**ドメイン**または**組織単位**のフィルター処理を使って構成を変更した場合は、**フル インポート**に続けて**差分同期**を実行する必要があります。

**属性**のフィルター処理を使って構成を変更した場合は、**完全同期**を実行する必要があります。

次の手順を実行します。

- [スタート] メニューから **[同期サービス]** を起動します。
- **[コネクタ]** を選択し、**[コネクタ]** の一覧から、構成変更済みのコネクタを選択します。**[アクション]** から **[実行]** を選択します。 ![Connector run](./media/active-directory-aadconnectsync-configure-filtering/connectorrun.png)
- **[実行プロファイル]** から、前のセクションで触れた操作を選択します。2 つのアクションを実行する必要がある場合は、1 つ目のアクションが完了 (選択したコネクタの **[状態]** 列が **[アイドル]** に変化) するのを待って 2 つ目のアクションを実行してください。

同期後、すべての変更がエクスポートの対象としてステージングされます。実際に Azure AD に変更を加える前に、それらの変更がすべて正しいことを検証する必要があります。

- コマンド プロンプトを起動し、`%Program Files%\Microsoft Azure AD Sync\bin` に移動します。
- 次のコマンドを実行します: `csexport "Name of Connector" %temp%\export.xml /f:x` 同期サービスにコネクタの名前があることを確認できます。Azure AD の場合は、"contoso.com - AAD" のような名前が表示されます。
- 次のコマンドを実行します: `CSExportAnalyzer %temp%\export.xml > %temp%\export.csv`
- %temp% に export.csv という名前のファイルが生成されます。このファイルは、Microsoft Excel で開くことができます。このファイルには、エクスポートの対象となるすべての変更が含まれています。
- データまたは構成に必要な変更を加え、エクスポートの対象となる変更が希望どおりになるまで、(インポート、同期、検証の) 手順を実行します。

問題がなければ、変更を Azure AD にエクスポートします。

- **[コネクタ]** を選択し、**[コネクタ]** の一覧から Azure AD コネクタを選択します。**[アクション]** から **[実行]** を選択します。
- **[実行プロファイル]** で **[エクスポート]** を選択します。
- 構成の変更によって削除されるオブジェクトが多数存在し、その数が、構成されているしきい値 (既定では 500 個) を超えた場合、エクスポート時にエラーが表示されます。エラーが表示された場合は、[誤って削除されないように保護する](active-directory-aadconnectsync-feature-prevent-accidental-deletes.md)機能を一時的に無効にする必要があります。

この時点でスケジューラをもう一度有効にします。

- [スタート] メニューから **[タスク スケジューラ]** を起動します。
- **[タスク スケジューラ ライブラリ]** の直下から **"Azure AD Sync Scheduler"** というタスクを探して右クリックし、**[有効]** を選択します。

## 次のステップ
[Azure AD Connect Sync](active-directory-aadconnectsync-whatis.md) の構成に関するページをご覧ください。

「[オンプレミス ID と Azure Active Directory の統合](active-directory-aadconnect.md)」をご覧ください。

<!---HONumber=AcomDC_0107_2016-->