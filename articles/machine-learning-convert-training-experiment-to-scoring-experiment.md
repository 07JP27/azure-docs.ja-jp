<properties 
	pageTitle="Machine Learning  のトレーニング実験からスコア付け実験に変換する | Azure" 
	description="予測分析モデルのトレーニングに使用されるMachine Learning のトレーニング実験を、Web サービスとして発行できるスコア付け実験に変換する方法。" 
	services="machine-learning" 
	documentationCenter="" 
	authors="garyericson" 
	manager="paulettm" 
	editor="cgronlun"/>

<tags 
	ms.service="machine-learning" 
	ms.workload="data-services" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="02/10/2015" 
	ms.author="garye"/>

#Machine Learning  のトレーニング実験からスコア付け実験に変換する

Azure Machine Learning では、予測分析ソリューションをビルド、テスト、および配置できます。 

予測分析モデルをトレーニングするために、 *training experiment* で作成および反復処理を実行し、新しいデータのスコア付けに使用する準備ができたら、スコア付け実験を準備して効率化する必要があります。次に、この  *scoring experiment* をAzure Web サービスとして発行し、ユーザーがデータをモデルに送信して、モデルの予測を受信できるようにします。

スコア付け実験に変換することで、トレーニングされたモデルをスコア付けの Web サービスとして公開できるようになります。Web サービスのユーザーがモデルに入力データを送信し、モデルは予測結果を返します。したがって、スコア付け実験を変換した場合は、モデルが他のユーザーに使用されることを想定しておいてください。

トレーニング実験をスコア付け実験に変換するプロセスには、次の 3 つの手順が含まれます。

1.	トレーニング済みの機械学習モデルを保存し、機械学習のアルゴリズムと**モデルのトレーニング** モジュールを、保存したトレーニング済みのモデルに置き換えます。
2.	スコア付けに必要なモジュールのみに実験を絞り込みます。トレーニング実験には、トレーニングに必要な多数のモジュールが含まれますが、モデルがトレーニングされてスコア付けに使用できるようになると、それらのモジュールは必要なくなります。
3.	実験の中で Web サービスのユーザーからのデータをどこで受け入れ、どのデータを返すか定義します。

##[スコア付け実験の作成] ボタン

実験のキャンバスの下部にある [**スコア付け実験の作成**] ボタンは、トレーニング実験をスコア付け実験に変換する 3 つの手順をユーザーに代わって実行します。

1.	トレーニング済みのモデルを、(実験キャンバスの左側にある) モジュール パレットの**トレーニング済みモデル**セクションのモジュールとして保存し、機械学習アルゴリズムと**モデルのトレーニング** モジュールを保存されたトレーニング済みのモデルで置き換えます。 
2.	これは明らかに不要なモジュールを削除します。この例では、**分割**、2 番目の**モデルのスコア付け**、および**モデルの評価**モジュールが含まれます。
3.	Web サービスの入力モジュールと出力モジュールを作成し、実験の既定の場所に追加します。

たとえば、次の実験では、サンプルの国勢調査のデータを使用した 2 クラスのブースト デシジョン ツリー モデルをトレーニングします。

![Training experiment][figure1]

この実験のモジュールは、基本的に 4 つの異なる機能を実行します。

![Module functions][figure2]

このトレーニング実験をスコア付け実験に変換するときにこれらのモジュールの一部が不要になったり、別の目的を持つようになったりします。

- **データ**- このサンプル データセット内のデータは、スコア付け中には使用されません。Web  サービスのユーザーは、スコア付けするデータを指定します。ただし、データ型など、このデータセットからのメタデータは、トレーニング済みのモデルで使用されます。このため、このメタデータを提供できるように、スコア付け実験のデータセットを保持する必要があります。

- **準備** -スコア付けのために送信されるデータによっては、これらのモジュールが受信データの処理に必要な場合と不必要な場合があります。 

	たとえば、この例では、サンプルのデータセットの値が欠落しており、モデルのトレーニングに必要ない列が含まれています。このため、**見つからないデータのクリーンアップ** モジュールが見つからない値の処理に含まれ、**プロジェクトの列**モジュールが、これらの余分な列をデータ フローから除外するために含まれます。Web サービスを通じてスコアリングのために送信されるデータに不足している値がないことがわかっている場合は、**見つからないデータのクリーンアップ** モジュールを削除できます。たえだし、**プロジェクトの列**モジュールはスコア付けされる機能のセットの定義に役立つので、このモジュールは残す必要があります。

- **トレーニング** - モデルが正常にトレーニングされたら、1 つのトレーニング済みモデルのモジュールとして保存します。次に、これらの各モジュールを、保存されているトレーニング済みのモデルに置き換えます。

- **スコア** - この例では、データ ストリームをテスト データとトレーニング データのセットに分割するために、分割モジュールが使用されます。スコア付け実験では、これは必要ないため削除できます。同様に、2 番目の**モデルのスコア付け**モジュールと**モデルの評価**モジュールは、テスト データの結果を比較するために使用されるので、これらのモジュールもスコア付け実験では必要ありません。ただし、残りの**モデルのスコア付け**モジュールは、Web サービスを通じてスコア結果を返すために必要です。

[**スコア付け実験の作成**] をクリックした後で、この例がどのようになるのかを次に示します。	

![Converted scoring experiment][figure3]

これは、実験を Web サービスとして発行するための準備として充分である場合があります。ただし、実験に合わせて追加の作業を実行する可能性があります。

###入力と出力のモジュールを調整する

トレーニング実験では、トレーニング データのセットを使用して、機械学習アルゴリズムが必要とする形式でデータを取得するいくつかの処理を実行しました。Web サービスを通じて受信することを想定しているデータで、この処理が必要ない場合は、**Web サービスの入力モジュール**を実験の別のノードに移動できます。

たとえば、既定では、上の図で示すように、**スコア付け実験の作成**が** Web サービスの入力**モジュールをデータ フローの上部に置きます。ただし、入力データがこの処理を必要としない場合、**Web サービスの入力**を、データ処理モジュールの先に手動で配置できます。

![Moving the web service input][figure4]

Web サービスを通じて提供される入力データが、これで処理なしでモデルのスコア付けモジュールに直接渡されるようになりました。

同様に、既定では**スコア付け実験の作成**が Web サービスの出力モジュールをデータ フローの下部に置きます。この例では、Web サービスはユーザーに完全な入力データのベクトル、およびスコア付けの結果を含む**モデルのスコア付け**モジュールの出力を返します。

ただし、入力データのベクトル全体ではなく、スコア付けの結果のみなど、別のものが返されるようにする場合は、**プロジェクトの列**モジュールを挿入して、スコア付けの結果以外のすべての列を除外することができます。次に、**Web サービスの出力**モジュールを**プロジェクトの列**モジュールの出力に移動します。

![Moving the web service output][figure5]

###データ処理モジュールを追加または削除する

スコア付け中に必要ないことがわかっているモジュールが、他にも実験に存在する場合は、それらを削除できます。たとえば、**Web サービスの入力**モジュールをデータ処理モジュールの後の地点に移動したため、**見つからないデータのクリーンアップ** モジュールをスコア付け実験から削除できます。 

これで、スコア付け実験が次のようになります。

![Removing additional module][figure6]

###オプションの Web サービス パラメーターを追加する

場合によっては、Web サービスのユーザーがサービスにアクセスしたときに、モジュールの動作を変更できるようにする場合があります。 *Web Service Parameters* では、これが可能です。

一般的な例として、発行された Web サービスのユーザーが、Web サービスにアクセスしたときに別のデータ ソースを指定できるように**リーダー** モジュールを設定する場合があります。または、別の宛先を指定できるように**ライター** モジュールを構成します。 

Web サービスのパラメーターを定義して、1 つまたは複数のモジュール パラメーターに関連付け、必須かオプションかを指定することができます。Web サービスのユーザーは、サービスにアクセスするときにこれらのパラメーターの値を指定することができ、モジュールの操作はそれに応じて変更されます。

Web サービスのパラメーターの詳細については、「[Azure Machine Learning の Web サービスのパラメーターを使用する
][webserviceparameters]」を参照してください。

[webserviceparameters]: machine-learning-web-service-parameters.md


##スコア付け実験を Web サービスとして公開する

スコア付け実験の準備を十分に実行したので、Azure  Web サービスとして発行できます。Web サービスを使用してユーザーはデータをモデルに送信でき、モデルは予測を返します。

完全な発行プロセスの詳細については、「[Azure Machine Learning Web サービスを発行する][publish]」を参照してください。

[publish]: machine-learning-publish-a-machine-learning-web-service.md


<!-- Images -->
[figure1]:./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure1.png
[figure2]:./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure2.png
[figure3]:./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure3.png
[figure4]:./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure4.png
[figure5]:./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure5.png
[figure6]:./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure6.png


<!--HONumber=49-->