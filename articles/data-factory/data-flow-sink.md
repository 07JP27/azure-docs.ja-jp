---
title: Azure Data Factory の Mapping Data Flow のシンク変換
description: Azure Data Factory の Mapping Data Flow のシンク変換
author: kromerm
ms.author: makromer
ms.reviewer: douglasl
ms.service: data-factory
ms.topic: conceptual
ms.date: 02/03/2019
ms.openlocfilehash: 381dc2f9f6d3a074af00ba047472719c086f5811
ms.sourcegitcommit: 4bf542eeb2dcdf60dcdccb331e0a336a39ce7ab3
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/19/2019
ms.locfileid: "56408410"
---
# <a name="mapping-data-flow-sink-transformation"></a>Mapping Data Flow のシンク変換

[!INCLUDE [notes](../../includes/data-factory-data-flow-preview.md)]

![シンクのオプション](media/data-flow/windows1.png "シンク 1")

データ フローの変換が完了したら、変換されたデータを宛先データセットにシンクできます。 シンク変換では、宛先の出力データに使用するデータセット定義を選択できます。 データ フローに必要なだけの数のシンク変換を設定できます。

受信データの変更に対処したり、スキーマの誤差に対処したりするための一般的な方法として、出力データセットに定義済みのスキーマがない状態で出力データをフォルダーにシンクします。 さらに、ソースで [Allow Schema Drift] (スキーマの誤差を許可) を選択してから、シンク内のすべてのフィールドを自動マップすることによって、ソース内のすべての列変更に対処できます。

データセットにシンクする場合は、データ フローを上書きするか、追加するか、または失敗させるかを選択できます。

[automap] (自動マップ) を選択して、すべての受信フィールドをシンクすることもできます。 宛先にシンクするフィールドを選択する場合や、宛先にあるフィールドの名前を変更する場合は、[automap] (自動マップ) で [オフ] を選択してから、[マッピング] タブをクリックして出力フィールドをマップします。

![シンクのオプション](media/data-flow/sink2.png "シンク 2")

## <a name="output-to-one-file"></a>1 つのファイルに出力する
Azure Storage BLOB または Data Lake のシンクの種類の場合は、変換されたデータをフォルダーに出力します。 Spark は、シンク変換で使用されるパーティション分割スキームに基づいて、パーティション分割された出力データ ファイルを生成します。 このパーティション分割スキームは、[最適化] タブをクリックして設定できます。ADF で出力を単一ファイルにマージする場合は、[単一パーティション] ラジオ ボタンをクリックします。

![シンクのオプション](media/data-flow/opt001.png "シンクのオプション")

### <a name="output-settings"></a>出力設定

[上書き] では、既に存在する場合はテーブルが切り捨てられ、再作成されて、データが読み込まれます。 [追加] では、新しい行が挿入されます。 データセット テーブル名のテーブルがターゲット ADW にまったく存在しない場合、[データ フロー] ではテーブルが作成され、データが読み込まれます。

[Auto Map] (自動マップ) の選択を解除すると、フィールドを宛先テーブルに手動でマップできます。

![シンク ADW のオプション](media/data-flow/adw2.png "ADW シンク")

#### <a name="field-mapping"></a>フィールドのマッピング

シンク変換の [マッピング] タブでは、受信 (左側) の列を宛先 (右側) にマップできます。 データ フローをファイルにシンクした場合、ADF は常に、新しいファイルをフォルダーに書き込みます。 データベース データセットにマップする場合は、このスキーマで新しいテーブルを生成する ([Save Policy] (ポリシーの保存) を [上書き] に設定する) か、または既存のテーブルに新しい行を挿入し、それらのフィールドを既存のスキーマにマップするかのいずれかを選択できます。

マッピング テーブルで複数選択を使用すると、1 回のクリックで複数の列をリンクしたり、複数の列を定義したり、複数の行を同じ列名にマップしたりできます。

![フィールドのマッピング](media/data-flow/multi1.png "複数のオプション")

列のマッピングをリセットする場合は、[Remap] (再マップ) ボタンを押してマッピングをリセットします。

![接続](media/data-flow/maxcon.png "Connections")

### <a name="updates-to-sink-transformation-for-adf-v2-ga-version"></a>ADF V2 GA バージョンでのシンク変換の更新

![シンクのオプション](media/data-flow/sink1.png "シンク 1")

![シンクのオプション](media/data-flow/sink2.png "シンク")

* [Allow Schema Drift] (スキーマの誤差を許可) および [スキーマの検証] オプションがシンクで使用できるようになりました。 これにより、柔軟なスキーマ定義を完全に許可すか ([スキーマの誤差])、またはスキーマが変更された場合はシンクを失敗させるか ([スキーマの検証]) のどちらかを ADF に指示できるようになります。

* フォルダーをクリアします。 ADF は、宛先ファイルをターゲット フォルダーに書き込む前に、そのシンク フォルダーの内容を切り捨てます。

* ファイル名のオプション

   * 既定値はSpark は PART の既定値に基づいて、ファイルに名前を付けることができます。
   * パターン:出力ファイルの名前を入力します。
   * [Per partition] (パーティションごと): パーティションごとのファイル名を入力します。
   * [As data in column] (列内のデータとして): 出力ファイルを列の値に設定します。

> [!NOTE]
> ファイル操作は、データ フローの実行アクティビティを実行している場合にのみ実行され、データ フロー デバッグ モードにある間は実行されません。

SQL のシンクの種類では、次を設定できます。

* テーブルを切り捨てる
* テーブルを再作成する (削除/作成を実行する)
* 大量データ読み込みのバッチ サイズ。 書き込みをチャンクにまとめる数値を入力します。

![フィールドのマッピング](media/data-flow/sql001.png "SQL のオプション")

## <a name="next-steps"></a>次の手順

これでデータ フローが作成されたので、[データ フローの実行アクティビティをパイプラインに](https://docs.microsoft.com/azure/data-factory/concepts-data-flow-overview)追加します。
