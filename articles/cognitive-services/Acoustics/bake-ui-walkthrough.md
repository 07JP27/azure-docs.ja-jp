---
title: Project Acoustics を使用した音響のベイク処理
titlesuffix: Azure Cognitive Services
description: このドキュメントでは、Unity エディター拡張機能を使用して音響ベイクを送信するプロセスについて説明します。
services: cognitive-services
author: kegodin
manager: nitinme
ms.service: cognitive-services
ms.subservice: acoustics
ms.topic: conceptual
ms.date: 08/17/2018
ms.author: kegodin
ms.openlocfilehash: ce377234cceb22bc2c6979bedd92d800355e75da
ms.sourcegitcommit: 90cec6cccf303ad4767a343ce00befba020a10f6
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/07/2019
ms.locfileid: "55872086"
---
# <a name="bake-acoustics"></a>音響のベイク処理

このドキュメントでは、Unity エディター拡張機能を使用して音響ベイクを送信するプロセスについて説明します。 音響の背景の詳細については、[Acoustics の概要](what-is-acoustics.md) に関する記事をご覧ください。 クイック スタート ガイドについては、[作業の開始](getting-started.md)に関する記事をご覧ください。

## <a name="import-the-plugin"></a>プラグインをインポートする

Acoustics プラグイン パッケージをプロジェクトにインポートします。 次に、Unity メニューの **[Window]\(ウィンドウ\) > [Acoustics]** を選択して Acoustics UI を開きます。

![Acoustics ウィンドウを開く](media/WindowAcoustics.png)

## <a name="principles"></a>原則

Acoustics ツール ウィンドウでは、音響エンジンがシーンの音響を計算するために必要な情報を収集します。 ベイクを実行するには、次の 5 つの手順があります。

1. プレイヤーのナビゲーション メッシュを作成またはマークする
2. 音響ジオメトリをマークする
3. 音響マテリアルのプロパティをジオメトリに割り当てる
4. プローブの配置をプレビューする
5. ベイクを実行する

ベイクが完了したら、ベイク後の設計手順 (任意) については、[Acoustics の設計プロセスの概要](design-process.md)に関する記事をご覧ください。

## <a name="create-or-mark-a-navigation-mesh"></a>ナビゲーション メッシュを作成またはマークする

ナビゲーション メッシュは、シミュレーション用のプローブ ポイントを配置するために使用します。 Unity の[ナビゲーション メッシュ ワークフロー](https://docs.unity3d.com/Manual/nav-BuildingNavMesh.html)を使用することも、独自のナビゲーション メッシュを指定することもできます。 Unity のワークフローを使用して作成されたナビゲーション メッシュは、音響システムによって取得されます。 独自のメッシュを使用するには、次の手順で説明する **[Objects]\(オブジェクト\)** タブからマークします。

## <a name="objects-tab"></a>[Objects]\(オブジェクト\) タブ

**[Acoustics]** ウィンドウの **[Objects]\(オブジェクト\)** タブを開きます。 このタブを使用して、シーン内のオブジェクトをマークします。これにより、**AcousticsGeometry** または **AcousticsNavigation** コンポーネントがオブジェクトに追加されます。 [標準の Unity コンポーネント ワークフロー](https://docs.unity3d.com/Manual/UsingComponents.html)を使用して、オブジェクトをマーク/マーク解除することもできます。

シーン ウインドウまたは階層内で 1 つ以上のオブジェクトを選択し、後述の **AcousticsGeometry** または **AcousticsNavigation** としてオブジェクトをマーク/マーク解除します。 何も選択されていない場合は、シーン内のすべてのものを一度にマーク/マーク解除できます。

マークできるのは、Mesh Renderers\(メッシュ レンダラー\) と Terrains\(地形\) だけです。 他のすべてのオブジェクトの種類は無視されます。 チェック ボックスでは、影響を受けるすべてのオブジェクトがマーク/マーク解除されます。

シーンで何も選択していない場合は、次の画像のようになります。

![何も選択していない場合の [Objects]\(オブジェクト\) タブ](media/ObjectsTabNoSelectionDetail.png)

シーンまたは階層ウィンドウで何かを選択している場合は、次の画像のようになります。

![何も選択していない場合の [Objects]\(オブジェクト\) タブ](media/ObjectsTabWithSelectionDetail.png)

### <a name="objects-tab-parts"></a>[Objects]\(オブジェクト\) タブの各部

タブ ページの各部分を次に示します。

1. タブ選択ボタン (**[Objects]\(オブジェクト\)** タブが選択されています)。 これらのボタンを使用して、音響ベイクを実行するためのさまざまな手順を進めます (左から右へ)。
2. このページを使用して行う必要がある操作の簡単な説明。
3. 階層ウィンドウで使用可能なフィルター。 これを使用して、階層ウィンドウをフィルター処理し、指定した種類のオブジェクトだけを表示することで、それらのオブジェクトをより簡単にマークできます。 音響のオブジェクトをまだマークしていない場合、最後の 2 つのオプションを選択しても何も表示されません。 ただし、オブジェクトをマークした後は、マークされたオブジェクトを見つけるときにこれらのオプションが役立ちます。
4. オブジェクトが選択されていない場合、このセクションにはシーン内のすべてのオブジェクトの状態が表示されます。
    * Total\(合計\) - シーン内の非表示になっていないアクティブなオブジェクトの総数。
    * Ignored\(無視\) - Mesh Renderers\(メッシュ レンダラー\) または Terrains\(地形\) 以外のオブジェクトの数。
    * Mesh\(メッシュ\) - シーン内の Mesh Renderers\(メッシュ レンダラー\) オブジェクトの数。
    * Terrain\(地形\) - シーン内の Terrains\(地形\) オブジェクトの数。
    * Geometry\(ジオメトリ\) - "Acoustics Geometry"\(音響ジオメトリ\) としてマークされた、シーン内の Mesh\(メッシュ\) オブジェクトまたは Terrain\(地形\) オブジェクトの数。
    * Navigation\(ナビゲーション\) - "Acoustics Navigation"\(音響ナビゲーション\) としてマークされた、シーン内の Mesh\(メッシュ\) オブジェクトまたは Terrain\(地形\) オブジェクトの数。 この数には、Unity の NavMesh は含まれません。
5. シーン内の "マーク可能な" オブジェクトの総数を示します。これは、Mesh Renderers\(メッシュ レンダラー\) と Terrains\(地形\) のみです。 表示されているチェック ボックスを使用して、これらのオブジェクトを音響のジオメトリまたはナビゲーションとしてマーク (オブジェクトに適切なコンポーネントを追加) できます。
6. 何も選択されていない場合、この注記では、必要に応じて、マークするオブジェクトを選択するようユーザーに促します。 いずれかまたは両方のチェック ボックスをオンにすると、何も選択しなくても、シーン内のすべてのオブジェクトをマークできます。
7. オブジェクトが選択されている場合、このセクションには選択されているオブジェクトの状態だけが表示されます。
8. 選択されている "マーク可能な" オブジェクトの総数が表示されます。 チェック ボックスをオンまたはオフにすると、選択されているオブジェクトだけがマーク/マーク解除されます。

マークされているオブジェクトとマークされていないオブジェクトがある場合、該当するチェック ボックスに "混在" を示す値が表示されます。

!["混在" を示す値が表示されたチェック ボックス](media/MixedObjectSelectionDetail.png)

チェック ボックスをクリックすると、すべてのオブジェクトが強制的にマークされ、もう一度クリックすると、すべてのオブジェクトのマークが解除されます。

ジオメトリとナビゲーションの両方でオブジェクトをマークできます。

### <a name="guidelines-for-marking-objects"></a>オブジェクトのマーキングに関するガイドライン

オブジェクトが音を遮る、反射する、または吸収する場合は、オブジェクトを **"Acoustics Geometry"\(音響ジオメトリ\)** としてマークする必要があります。 音響ジオメトリには、地面、壁、屋根、窓と窓ガラス、ラグ、大型家具などを含めることができます。 ランプ、装飾品、照明器具などの小さなオブジェクトは、ベイクのコストを大幅に増加させるわけではないため、これらのオブジェクトを含めても問題はありません。 地面や天井などの主要要素を見落とさないことが重要です。 また、衝突メッシュなど、音響に影響しないものは含めないでください。

プローブ計算時のオブジェクトの変換 (後述の **[Probes]\(プローブ\)** タブを使用) は、ベイクの結果で修正されます。 シーン内のマークされたオブジェクトのいずれかを移動するには、プローブの計算を再実行し、シーンを再ベイクする必要があります。

## <a name="materials-tab"></a>[Materials]\(マテリアル\) タブ

オブジェクトがマークされたら、**[Materials]\(マテリアル\)** ボタンをクリックして [Materials]\(マテリアル\) タブに移動します。

### <a name="parts-of-the-materials-tab"></a>[Materials]\(マテリアル\) タブの各部

![[Materials]\(マテリアル\) タブの詳細](media/MaterialsTabDetail.png)

1. このページを表示するために使用する **[Materials]\(マテリアル\)** タブ ボタン。
2. このページを使用して行う必要がある操作の簡単な説明。
3. オンにすると、**Acoustics Geometry\(音響ジオメトリ\)** としてマークされたオブジェクトで使用されるマテリアルだけが一覧表示されます。 それ以外の場合は、シーンで使用されているすべてのマテリアルが一覧表示されます。
4. これらのオプションを使用して、後述の [Acoustics]\(音響\) 列 (6) のドロップダウンをクリックしたときに表示されるドロップダウン メニューの順序を変更します。 **[Name]\(名前\)** は、音響マテリアルを名前で並べ替えます。 [Absorptivity]\(吸収率\) は、吸収率の低いものから高いものの順に並べ替えます。
5. シーンで使用されているマテリアルの一覧。アルファベット順に並べ替えられています。 **[Show Marked Only]\(マークされているオブジェクトのみを表示\)** チェック ボックス (3) をオンにすると、**Acoustics Geometry\(音響ジオメトリ\)** としてマークされたオブジェクトで使用されるマテリアルだけが表示されます。 ここでマテリアルをクリックすると、シーン内のそのマテリアルを使用するすべてのオブジェクトが選択されます。
6. シーン マテリアルが割り当てられている音響マテリアルが表示されます。 シーン マテリアルを別の音響マテリアルに再割り当てするには、ドロップダウンをクリックします。 前述の **[Sort Acoustics By:]\(音響の並べ替え\)** のオプション (4) を使用して、ここで項目をクリックしたときに表示されるメニューの並べ替え順序を変更できます。
7. 前の列で選択したマテリアルの吸音係数が表示されます。 値 0 は完全に反射する (吸収しない) ことを意味し、値 1 は完全に吸収する (反射しない) ことを意味します。 選択したマテリアルが "Custom"\(カスタム\) である場合を除き、吸収係数を変更することはできません。
8. "Custom"\(カスタム\) に割り当てられているマテリアルの場合、スライダーが無効にならないので、スライダーを使用するか、値を入力して吸収係数を選択できます。 マテリアルのプロパティの詳細については、[Acoustics の設計プロセスの概要](design-process.md)に関する記事をご覧ください。

### <a name="guidelines-for-assigning-materials-or-absorption-values"></a>マテリアル (または吸収値) の割り当てに関するガイドライン

このタブでは、名前に基づいてマテリアルの吸収性の推測を試みます。 たとえば、シーン マテリアル名が LivingRoom_WoodTable の場合、このマテリアルに割り当てられる初期音響マテリアルは "wood"\(木材\) になります。 既知のマテリアルを特定できないマテリアルには、コンクリートと同様の吸収性を持つ "Default"\(既定\) マテリアルが割り当てられます。

各シーン マテリアルに音響マテリアルを再割り当てすることができます。 たとえば、部屋の反響音が大きすぎる場合は、壁、床、または天井の音響マテリアルを吸収率の高いものに変更します。 音響マテリアルの割り当ては、そのシーン マテリアルを使用するすべてのオブジェクトに適用されます。

## <a name="probes-tab"></a>[Probes]\(プローブ\) タブ

マテリアルを割り当てたら、**[Probes]\(プローブ\)** タブに切り替えます。

### <a name="parts-of-the-probes-tab"></a>[Probes]\(プローブ\) タブの各部

![[Probes]\(プローブ\) タブの詳細](media/ProbesTabDetail.png)

1. このページを表示するために使用する **[Probes]\(プローブ\)** タブ ボタン。
2. このページを使用して行う必要がある操作の簡単な説明。
3. これらを使用して、シミュレーションの分解能を粗くするか細かくするかを選択します。 粗い方が高速ですが、ある程度のトレードオフがあります。 詳細については、後述の「[粗分解能と細分解能の比較](#Coarse-vs-Fine-Resolution)」をご覧ください。
4. このフィールドを使用して、音響データ ファイルを配置する場所を選択します。 [...] ボタンをクリックすると、フォルダー ピッカーを使用できます。 既定値は **Assets/AcousticsData** です。 この場所に **Editor** サブフォルダーも作成されます。 データ ファイルの詳細については、後述の「[データ ファイル](#Data-Files)」をご覧ください。
5. ここで指定したプレフィックスを使用して、このシーンのデータ ファイルに名前が付けられます。 既定値は "Acoustics_ [シーン名]" です。
6. プローブの計算後、上記の各コントロールは無効になります。 **[Clear]\(クリア\)** ボタンをクリックすると計算が消去され、新しい設定を使用して再計算できるようにコントロールが有効になります。
7. **[Calculate...]\(計算...\)** ボタンをクリックすると、シーンがボクセル化され、プローブ ポイントの位置が計算されます。 これはコンピューター上でローカルで実行されます。ベイクを実行する前に、これを実行する必要があります。

Project Acoustics のこのバージョンでは、プローブを手動で配置することはできません。プローブは、**[Probes]\(プローブ\)** タブで提供される自動プロセスを使用して配置する必要があります。

### <a name="what-the-calculate-button-calculates"></a>[Calculate...]\(計算...\) ボタンでの計算内容

**[Calculate...]\(計算...\)** ボタンを使用すると、これまでに指定したすべてのデータ (ジオメトリ、ナビゲーション、マテリアル、粗/細設定) が取得され、次の手順が実行されます。

1. シーン メッシュからジオメトリが取得され、ボクセル体積が計算されます。 ボクセル体積はシーン全体を囲む 3 次元体積であり、小さな立方体の "ボクセル" で構成されます。 ボクセルのサイズは、**[Simulation Resolution]\(シミュレーションの分解能\)** 設定で設定されたシミュレーションの周波数によって決まります。 各ボクセルは、"オープン エア" またはシーン ジオメトリを含むものとしてマークされます。 ボクセルにジオメトリが含まれている場合、ボクセルはそのジオメトリに割り当てられたマテリアルの吸収係数でタグ付けされます。
2. 次に、ナビゲーション データを使用して、プレイヤーの移動先の音響の対象となる場所が計算されます。 出入り口や廊下などの狭いエリアを含む、これらの場所のかなり小規模なセットを見つけ、その後に部屋、オープン スペースを見つけるよう試みられます。 小さなシーンの場合、通常は 100 か所未満ですが、大きなシーンでは最大 1,000 か所になることもあります。
3. 計算されたリスナーの最終的な場所ごとに、スペースの "開放度"、部屋のサイズなどの多数のパラメーターが決定されます。
4. これらの計算の結果は、指定した場所のファイルに保存されます (後述の「[データ ファイル](#Data-Files)」を参照)。

シーンのサイズやコンピューターの速度によっては、これらの計算に数分かかることがあります。

これらの計算が完了したら、ベイクで良好な結果が得られるように、ボクセル データとプローブ ポイントの位置をプレビューできます。 不適切なナビゲーション メッシュ、欠落しているジオメトリ、余分なジオメトリなどは、通常、プレビューですぐに表示されるので修正できます。

### <a name="scene-rename"></a>シーン名の変更

シーン名は、プローブ ポイントの配置とボクセル化が保存されているファイルにシーンを接続するために使用されます。 プローブ ポイントの計算後にシーン名を変更すると、マテリアルの割り当てと配置データが失われるので、再実行する必要があります。

## <a name="debug-display-through-gizmos"></a>ギズモを使用したデバッグ表示

既定では、**プローブ** ギズモと**ボクセル** ギズモがオンになっています。 これらのギズモでは、計算済みのボクセルとプローブ ポイントの位置が示されます。 [Gizmos]\(ギズモ\) メニューを使用して、これらを有効または無効にすることができます。

![[Gizmos]\(ギズモ\) メニュー](media/GizmosMenu.png)

### <a name="voxels"></a>ボクセル

ボクセルは、関与するジオメトリの周りの緑色の立方体としてシーン ウィンドウに表示されます。 空気のみを含むボクセルは表示されません。 シーン全体を囲む緑色の大きなボックスがあります。これは、シミュレーションで使用される完全なボクセル体積を示しています。
シーン内を移動し、ジオメトリであることが必要なすべてのものにボクセルがあることを確認します。 シーン カメラは、ボクセルが示すオブジェクトから約 5 メートル以内に存在する必要があります。

粗分解能と細分解能で作成されたボクセルを比較すると、粗いボクセルは 2 倍の大きさになります。

![ボクセルのプレビュー](media/VoxelCubesPreview.png)

### <a name="probe-points"></a>プローブ ポイント

プローブ ポイントは、プレイヤー (リスナー) が移動可能な場所と同義です。 ベイクを実行すると、これらのプローブ ポイントごとに、シーン内のあらゆる場所の音源の音響が計算されます。 プレイヤーの位置がプローブ ポイントの位置からずれている場合、プレイヤーに最も近いプローブ ポイントのデータを使用して、その位置のパラメーターが補間されます。

そのため、シーン内でプレイヤーが移動すると予想されるあらゆる場所にプローブ ポイントが存在し、狭いエリアと出入口が適切に表現されていることを確認することが重要です。 プローブ ポイントは、シーンのジオメトリの解釈に基づいて Project Acoustics エンジンによって配置されます。この Designer Preview では、プローブ ポイントを移動または編集することはできません。 代わりに、それらを使用して、ジオメトリ マーキングの正確さとナビゲーション ヒント データの正確さを確認します。

![プローブのプレビュー](media/ProbesPreview.png)

### <a name="Coarse-vs-Fine-Resolution"></a>粗分解能と細分解能の比較

分解能設定の [Coarse]\(粗\) と [Fine]\(細\) の唯一の違いは、シミュレーションが実行される周波数です。 Fine\(細\) では、Coarse\(粗\) の 2 倍の周波数が使用されます。
これは単純に思われるかもしれませんが、音響シミュレーションに多くの影響があります。

* Coarse\(粗\) の波長は Fine\(細\) の 2 倍であるため、ボクセルが 2 倍の大きさになります。
* シミュレーション時間はボクセル サイズに直接関係します。Coarse\(粗\) でのベイクは Fine\(細\) でのベイクよりも約 16 倍高速化されます。
* ボクセル サイズより小さいポータル (ドアや窓など) はシミュレートできません。 Coarse\(粗\) 設定では、これらの小さなポータルがシミュレートされないことがあります。そのため、実行時に音が通過しなくなります。 ボクセルを表示することによって、この状況が発生しているかどうかを確認できます。
* シミュレーションの周波数が低いほど、角やエッジ付近での回折が少なくなります。
* "中身の詰まった" ボクセル (つまり、ジオメトリを含むボクセル) 内に音源を配置することはできません。これを行うと音がなくなります。 Coarse\(粗\) 設定のサイズの大きいボクセル内には音源は配置されないため、Fine\(細\) 設定を使用する場合よりも音源の配置が難しくなります。
* 次に示すように、ボクセルのサイズが大きくなると、ポータルへの侵入の度合いが大きくなります。 最初の画像は、Coarse\(粗\) を使用して作成されたものであり、2 番目は、Fine\(細\) 分解能を使用した同じ出入り口を示しています。 赤のマーキングで示すように、Fine\(細\) 設定を使用すると、出入り口への侵入が大幅に減っています。 青色の線はジオメトリによって定義された出入り口であり、赤色の線はボクセル サイズによって定義された有効な音響ポータルです。 特定の状況でこの侵入がどの程度になるかは、ボクセルとポータルのジオメトリの適合度合いに完全に左右されます。この度合いは、シーン内のオブジェクトのサイズと位置によって決まります。

![Coarse\(粗\) 設定の出入り口](media/CoarseVoxelDoorway.png)

![Fine\(細\) 設定の出入り口](media/FineVoxelDoorway.png)

## <a name="bake-tab"></a>[Bake]\(ベイク\) タブ

プレビュー データに満足したら、**[Bake]\(ベイク\)** タブを使用してベイクをクラウドに送信します。

### <a name="parts-of-the-bake-tab"></a>[Bake]\(ベイク\) タブの各部

![[Bake]\(ベイク\) タブの詳細](media/BakeTabDetails.png)

1. このページを表示するために使用する [Bake]\(ベイク\) タブ ボタン。
2. このページで実行する操作の簡単な説明。
3. Azure アカウントが作成された後、Azure 資格情報を入力するフィールド。 詳細については、「[Create an Azure Batch account (Azure Batch アカウントの作成)](create-azure-account.md)」をご覧ください。
4. Acoustics ツールセットの Docker イメージ タグ。
5. Azure Portal を起動して、サブスクリプションの管理、使用状況の監視、課金情報の表示などを実行します。 
6. 計算に使用する Azure Batch コンピューティング ノードのタイプ。 ノードのタイプは、ご利用の Azure データ センターの場所でサポートされている必要があります。 不明な場合は、**[Standard_F8s_v2]** のままにしておきます。
7. この計算に使用するノードの数。 ここで入力する数は、ベイクを完了するまでの時間に影響し、Azure Batch のコアの割り当てによって制限されます。 既定の割り当てで使用できるのは、2 つの 8 コア ノードまたは 1 つの 16 コア ノードだけですが、既定の割り当ては拡張できます。 コアの割り当ての制約の詳細については、「[Create an Azure Batch account (Azure Batch アカウントの作成)](create-azure-account.md)」をご覧ください。
8. [優先順位の低いノード](https://docs.microsoft.com/azure/batch/batch-low-pri-vms)を使用するようにコンピューティング プールを構成するには、このチェック ボックスを選択します。 優先順位の低いコンピューティング ノードはコストは格段に低く抑えられますが、常に使用できるわけではなかったり、いつでも割り込まれたりする可能性があります。
9. **[Probes]\(プローブ\)** タブで計算されたシーンのプローブ数。プローブの数によって、クラウドで実行する必要があるシミュレーションの数が決まります。 プローブよりも多くのノードを指定することはできません。
10. クラウドでジョブを実行したときの予想される経過時間。 これにはノードの起動時間は含まれません。 ジョブの実行が開始されたら、これは結果を返すまでの時間になります。 これは推定値にすぎません。
11. シミュレーションを実行するために必要なコンピューティング時間の合計。 これは、Azure で使用されるノードのコンピューティング時間の合計です。 この値の使用方法の詳細については、後述の「[ベイクのコストの見積もり](#Estimating-bake-cost)」をご覧ください。
12. このメッセージは、ジョブの完了後に、ベイクの結果が保存される場所をユーザーに通知します。
13. (高度な用途専用) 何らかの理由で、送信済みのベイクの情報を Unity で強制的に破棄する必要がある場合は (別のコンピューターを使用して結果をダウンロードした場合など)、**[Clear State]** \(状態のクリア\) をクリックして送信済みのジョブの情報を破棄します。 これにより、準備ができても、結果ファイルはダウンロード**されなくなります**。**これは、ジョブの取り消しとは異なることに注意してください**。 実行中のジョブはクラウドで引き続き実行されます。
14. [Bake]\(ベイク\) ボタンをクリックすると、ベイクがクラウドに送信されます。 ジョブの実行中は、代わりに **[Cancel Job]\(ジョブの取り消し\)** と表示されます。
15. ローカル マシンでの Acoustics シミュレーションの処理を準備します。 詳細については、「[ローカル ベイク](#Local-bake)」を参照してください。  
16. この領域にはベイクの状態が表示されます。 完了すると、**[Downloaded]\(ダウンロード済み\)** と表示されます。

アクティブなジョブ、コンピューティング プール、ストレージに関する完全な情報は、[Azure portal](https://portal.azure.com) でいつでも入手できます。

ジョブの実行中は、**[Bake]\(ベイク\)** ボタンが **[Cancel Job]\(ジョブの取り消し\)** に変わります。 このボタンを使用して、進行中のジョブを取り消すことができます。 ジョブを取り消す前に確認を求められます。 ジョブの取り消しは元に戻すことができず、結果を使用できなくなります。また、使用された Azure のコンピューティング時間に引き続き課金されます。

ベイクを開始したら、Unity を閉じてかまいません。 プロジェクト、ノードのタイプ、ノード数によっては、クラウド ベイクに数時間かかることがあります。 プロジェクトを再度読み込んで Acoustics ウィンドウを開くと、ベイク ジョブの状態が更新されます。 ジョブが完了すると、出力ファイルがダウンロードされます。

Azure 資格情報はローカル コンピューターに安全に保存され、Unity エディターに関連付けられます。 これらは、Azure へのセキュリティで保護された接続を確立する目的でのみ使用されます。

### <a name="Estimating-bake-cost"></a> Azure のベイク コストの見積もり

特定のベイクのコストを見積もるには、**[Estimated Compute Cost]\(推定コンピューティング コスト\)** に表示されている値 (時間) に、選択した **VM ノード タイプ**の現地通貨での時間あたりのコストを掛けます。 結果には、ノードを稼働させるために必要なノード時間は含まれません。 たとえば、ノード タイプとして、時間あたりのコストが 0.40 ドルの **Standard_F8s_v2** を選択し、Estimated Compute Cost\(推定コンピューティング コスト\) が 3 時間 57 分の場合、ジョブを実行するための推定コストは 0.40 ドル * 最大 4 時間 = 最大 1.60 ドルになります。 実際のコストは、ノードの起動に余分な時間がかかるため、少し高くなる可能性があります。 ノードの時間あたりのコストは、[Azure Batch の価格](https://azure.microsoft.com/pricing/details/virtual-machines/linux)に関するページで確認できます (カテゴリの "コンピューティングの最適化" または "ハイ パフォーマンス コンピューティング" を選択します)。

### <a name="reviewing-the-bake-results"></a>ベイクの結果の確認

ベイクが完了したら、ランタイム プラグインを実行して、ボクセルとプローブ ポイントが想定された位置にあることを確認します。 詳細については、[Acoustics の設計プロセスの概要](design-process.md)に関する記事をご覧ください。

## <a name="Local-bake"></a>ローカル ベイク
ローカル ベイクは、Azure Batch コンピューティング クラスターにオフロードするのではなく、独自の PC で Acoustics シミュレーションを実行します。 これは、Azure サブスクリプションを必要とせずに Acoustics で実験するのに適したオプションとなります。 Acoustics シミュレーションは計算の要求が高く、シーン、シミュレーションの構成、および処理マシンの基本計算能力によっては時間がかかることに注意してください。

### <a name="minimum-hardware-requirements"></a>最小ハードウェア要件
64 ビット Intel プロセッサ。少なくとも 8 個のコアと 32 GB 以上の RAM。

たとえば、8 コアのマシンに 3 GHz の Intel Xeon E5-1660 と 32 GB 以上の RAM を備えたもの。
* 100 のプローブがある小さいシーンには、粗いベイクの場合には最大 2 時間、精細な解像度のベイクの場合には最大 32 時間かかります。
* 1000 のプローブがある大きなシーンには、粗い解像度の場合には最大約 20 時間、精細な解像度のベイクの場合には最大 21 日かかります。

### <a name="setup-docker"></a>Docker のセットアップ
シミュレーションを処理する PC 上に Docker をインストールして構成します。
1. [Docker ツールセット](https://www.docker.com/products/docker-desktop)をインストールします。
2. Docker の設定を起動し、「詳細」オプションに移動して、少なくとも 8 GB の RAM があるリソースを構成します。 Docker に CPU を多く割り当てると、ベイクの実行速度は上がります。 ![Docker 設定の例](media/DockerSettings.png)
3. 「共有ドライブ」に移動し、処理に使用されるドライブの共有を有効にします。![DockerDriveSharing](media/DockerSharedDrives.png)

### <a name="run-local-bake"></a>ローカル ベイクの実行
1. [Bake]\(ベイク\) タブで [Prepare Local Bake (ローカル ベイクの準備)] ボタンをクリックし、入力ファイルと実行スクリプトの保存先フォルダーを選択します。 ハードウェアの最小要件を満たしており、そのマシンにフォルダーをコピーして Docker がインストールされていれば、どのマシンでもベイクを実行できます。
2. 「runlocalbake.bat」スクリプトを使用してシミュレーションを起動します。 このスクリプトはシミュレーションの処理に必要なツールセットでプロジェクト Acoustics Docker イメージをフェッチし、シミュレーションを開始します。 
3. シミュレーションが終了したら、結果の .ace ファイルを Unity プロジェクトにコピーします。 Unity にこれをバイナリ ファイルとして確実に認識させるには、「.bytes」をファイル拡張子に追加します (「Scene1.ace.bytes」などとします)。 シミュレーションの詳細ログは、「AcousticsLog.txt」に格納されます。 問題が発生した場合は、診断の支援のためにこのファイルを共有します。

## <a name="Data-Files"></a>データ ファイル

このプラグインでは、さまざまな時点で 4 つのデータ ファイルが作成されます。 実行時に必要なのはその中の 1 つだけです。そのため、残りの 3 つは "Editor" という名前のフォルダー内にあり、プロジェクトにコンパイルされることはありません。

* **Assets/Editor/[SceneName]\_AcousticsParameters.asset**:このファイルには、ユーザーが Acoustics UI のフィールドに入力したデータが格納されます。 このファイルの場所と名前は変更できません。 このファイルには、ベイクに影響を与える他の値が保存されていますが、それらは上級ユーザー向けであるため、変更しないでください。
* **Assets/AcousticsData/Acoustics\_[SceneName].ace.bytes**:このファイルは、ベイクのシミュレーション中に作成されます。このファイルには、シーンの音響をレンダリングするためにランタイムが使用する参照データが含まれています。 このファイルの場所と名前は、**[Probes]\(プローブ\)** タブのフィールドを使用して変更できます。
* **Assets/AcousticsData/Editor/Acoustics_[SceneName].vox**:このファイルには、ボクセル化された音響ジオメトリとマテリアルのプロパティが格納されます。 [Probes]\(プローブ\) タブの **[Calculate...]\(計算...\)** ボタンを使用して計算されます。このファイルの場所と名前は、**[Probes]\(プローブ\)** タブのフィールドを使用して変更できます。
* **Assets/AcousticsData/Editor/Acoustics\_[SceneName]\_config.xml**:このファイルには、**[Probes]\(プローブ\)** タブの **[Calculate...]\(計算...\)** ボタンを使用して計算されたパラメーターが格納されます。このファイルの場所と名前は、**[Probes]\(プローブ\)** タブのフィールドを使用して変更できます。

ベイクからダウンロードした *.ace.bytes ファイルを削除しないように注意してください。 このファイルは、シーンを再ベイクしない限り回復できません。

## <a name="next-steps"></a>次の手順
* [Acoustics の設計プロセスの概要](design-process.md)に関する記事を参照して、ベイクの結果を音源に適用します。

