---
title: Azure IoT Central アプリケーションでデバイス テンプレートを設定する | Microsoft Docs
description: 測定値、設定、プロパティ、ルール、およびダッシュボードを含むデバイス テンプレートを設定する方法を説明します。
author: viv-liu
ms.author: viviali
ms.date: 04/16/2018
ms.topic: conceptual
ms.service: iot-central
services: iot-central
manager: peterpr
ms.openlocfilehash: bda056a75ae9d696dab389b85fe1bfb2935ee1a8
ms.sourcegitcommit: 1b8665f1fff36a13af0cbc4c399c16f62e9884f3
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "35261986"
---
# <a name="set-up-a-device-template"></a>デバイス テンプレートを設定する

デバイス テンプレートは、Microsoft Azure IoT Central アプリケーションに接続するデバイスの種類の、特性と動作を定義するブループリントです。

たとえばビルダーは、以下の機能を持つ、IoT 接続されているファンのデバイス テンプレートを作成できます。

- 温度テレメトリの測定

- ファン モーター エラー イベントの測定

- ファン動作状態の測定

- ファン速度の設定

- 場所プロパティ

- アラートを送信するルール

- デバイスに関するすべての稼働ビューを提供するダッシュボード

オペレーターはこのデバイス テンプレートから、**fan-1** や **fan-2** などの名前で、実際のファン デバイスを作成して接続できます。 これらのファンはすべて、測定、設定、プロパティ、ルール、およびアプリケーションのユーザーが監視と管理を行えるダッシュボードを備えています。

> [!NOTE]
デバイス テンプレートの作成、編集、および削除が可能なのは、ビルダーと管理者のみです。 **[Device Explorer]** ページの既存のデバイス テンプレートからは、すべてのユーザーがデバイスを作成できます。

## <a name="create-a-new-device-template"></a>新しいデバイス テンプレートを作成する

1. **[Application Builder] (アプリケーション ビルダー)** ページに移動します。

1. 空のテンプレートを作成するには、**[Create Device Template] (デバイス テンプレートの作成)** を選択し、**[カスタム]** を選択します。

1. 新しいデバイス テンプレートの名前を入力し、**[作成]** を選択します。

    ![[デバイスの詳細] ページ](./media/howto-set-up-template/devicedetailspage.png)

1. これで、新しいシミュレートされたデバイスの **[デバイスの詳細]** ページが表示されました。 シミュレートされたデバイスは、新しいデバイス テンプレートを作成すると自動的に作成されます。 これがデータを報告して、実際のデバイスと同様に制御できます。

ここで、**[デバイスの詳細]** ページの各タブを調べます。

## <a name="measurements"></a>測定値

測定値は、デバイスから到着するデータです。 デバイスの機能と一致するように、複数の測定値をデバイス テンプレートに追加できます。 現時点では、テレメトリとイベントが、サポートされる測定値の種類です。

- **[テレメトリ]** の測定値は、デバイスが時間の経過と共に収集した数値データ ポイントで、連続するストリームが表されます。 たとえば、温度です。
- **[イベント]** の測定値は、デバイス上の何らかの重要性を表す特定の時点のデータです。 イベントには、そのイベントの重要性を表す重大度が関連付けられています。 たとえば、ファン モーターのエラーです
- **[状態]** の測定値は、一定期間にわたるデバイスまたはそのコンポーネントの状態を表します。 たとえば、ファン モードです。2 つある状態の動作中と停止として定義できます。

### <a name="create-a-telemetry-measurement"></a>テレメトリの測定を作成する
新しいテレメトリの測定を追加するには、測定の種類を選択する選択肢があるフォームを開く **[+ New Measurement] (+ 新しい測定)** ボタンをクリックします。 **[テレメトリ]** を選択し、**[Create Telemetry] (テレメトリの作成)** フォームで詳細を入力します。

> [!NOTE]
> 実際のデバイスが接続されたときは、デバイスが報告する測定の名前に注意してください。 名前は測定の **[Field Name] (フィールド名)** と正確に一致している必要があります。

たとえば、新しい温度テレメトリ測定を追加できます。

![測定値のフォーム](./media/howto-set-up-template/measurementsform.png)

**[保存]** を選択した後、**[Temperature] (温度)** の測定が測定値の一覧に表示され、オペレーターはデバイスが収集している温度データの視覚化を表示できます。

![測定値のグラフ](./media/howto-set-up-template/measurementsgraph.png)

### <a name="create-an-event-measurement"></a>イベントの測定を作成する
新しいイベントの測定を追加するには、測定の種類を選択する選択肢があるフォームを開く **[+ New Measurement] (+ 新しい測定)** ボタンをクリックします。 **[イベント]** を選択し、**[Create Event] (イベントの作成)** フォームで詳細を入力します。

このフォームには、イベントの**表示名**、**フィールド名**、および**重大度**があります。 3 つの選択できる重大度のレベルから選択できます。**[エラー]**、**[警告]**、および **[情報]** です。  

たとえば、新しい "Fan Motor Error" イベントを追加できます。

![イベントの測定値のフォーム](./media/howto-set-up-template/eventmeasurementsform.png)

**[保存]** を選択した後、**[Fan Motor Error] (ファン モーター エラー)** の測定が測定値の一覧に表示され、オペレーターはデバイスが送信しているイベント データの視覚化を表示できます。

![イベントの測定値グラフ](./media/howto-set-up-template/eventmeasurementschart.png)

イベントに関する追加の詳細を表示するには、グラフ上でイベントのアイコンをクリックします。

![イベントの測定値の詳細](./media/howto-set-up-template/eventmeasurementsdetail.png)


### <a name="create-a-state-measurement"></a>状態の測定を作成する
新しい状態の測定を追加するには、測定の種類を選択する選択肢があるフォームを開く **[+ New Measurement] (+ 新しい測定)** ボタンをクリックします。 **[状態]** を選択し、**[Create State] (状態の作成)** フォームで詳細を入力します。

このフォームには、状態の**表示名**、**フィールド名**、および状態のありえる**値**があります。 それぞれの**値**には、グラフやテーブルに値を表示するときに使用される表示名を付けることもできます。

たとえば、デバイスが送信できる 2 つの選択可能な値、**[Operating] (動作中)** と **[Stopped] (停止)** がある新しい "Fan Mode" 状態を追加できます。

![状態の測定値のフォーム](./media/howto-set-up-template/statemeasurementsform.png)

**[保存]** を選択した後、**[Fan Mode]** 状態の測定が測定値の一覧に表示され、オペレーターはデバイスが送信している状態データの視覚化を表示できます。

![状態の測定値のグラフ](./media/howto-set-up-template/statemeasurementschart.png)

短期間にデバイスによって送信されたデータ ポイントが多すぎる場合、状態の測定は、次のように異なるビジュアルで表示されます。 グラフをクリックすると、その期間内のすべてのデータ ポイントが、時系列の順で表示されます。 時間の範囲を狭くしても、グラフにプロットされる測定を表示できます。

![状態の測定値の詳細](./media/howto-set-up-template/statemeasurementsdetail.png)


## <a name="settings"></a>設定

設定はデバイスを制御します。 これらにより、アプリケーションのオペレーターは、デバイスに入力を提供できるようになります。 オペレーターが使用する **[設定]** タブにタイルとして表示されるデバイス テンプレートには、複数の設定を追加できます。 数値、テキスト、日付、トグル、選択リスト、およびセクション ラベルの 6 種類の設定を追加できます。

> [!NOTE]
> 実際のデバイスが接続されたときは、デバイスが報告する設定の名前に注意してください。 名前は設定の **[Field Name] (フィールド名)** と正確に一致している必要があります。

設定は、3 つの状態のいずれかにできます。 これらの状態は、デバイスによって報告されます。

- **[Synced] (同期済み)**: デバイスは設定値を反映するように変わりました。

- **[Pending] (保留中)**: デバイスは現在、設定値に変わろうとしています。

- **[Error] (エラー)**: デバイスがエラーを返しました。

たとえば、新しいファン速度の設定を追加できます。

![設定のフォーム](./media/howto-set-up-template/settingsform.png)

**[保存]** を選択した後、**[Fan speed]** 設定はタイルとして表示され、デバイスのファン速度を変更するために使用する準備が整います。

> [!NOTE]
> 新しいタイルの作成後、新しい設定を試すことができます。 最初に、画面の右上でデザイン モードをオフにします。

![設定のタイル](./media/howto-set-up-template/settingstile.png)

## <a name="properties"></a>Properties

プロパティは、デバイスの場所やシリアル番号など、デバイスに関連付けられているデバイスのメタデータです。 デバイス テンプレートには複数のプロパティを追加できます。それらは **[プロパティ]** タブのタイルとして表示されます。オペレーターは、新しいデバイスを作成するときにプロパティの値を指定でき、これらの値をいつでも編集できます。 追加できるプロパティには 6 つの種類があります。数値、テキスト、日付、トグル、デバイス プロパティ、およびラベルです。

2 種類のプロパティがあります。

- **デバイスのプロパティ**は、デバイスによって報告されるプロパティです。
- **アプリケーションのプロパティ**は、アプリケーションにのみ保存されるプロパティです。 デバイスには、アプリケーションのプロパティに関する情報はありません。

> [!NOTE]
> デバイスのプロパティについては、実際のデバイスが接続されたときは、デバイスが報告するプロパティの名前に注意してください。 名前はプロパティの **[Field Name] (フィールド名)** と正確に一致している必要があります。 アプリケーションのプロパティについては、名前がデバイス テンプレート内で一意である限り、任意のフィールド名を指定できます。

たとえば、新しいプロパティとして、デバイスの場所を追加できます。

![プロパティのフォーム](./media/howto-set-up-template/propertiesform.png)

**[保存]** を選択した後、デバイスの場所はタイルとして表示されます。

![プロパティのタイル](./media/howto-set-up-template/propertiestile.png)

> [!NOTE]
> 新しいタイルの作成後、プロパティの値を変更できます。 最初に、画面の右上でデザイン モードをオフにします。

### <a name="create-a-location-property-powered-by-azure-maps"></a>Azure Maps 基盤で場所プロパティを作成する
Azure IoT Central 内で場所データに地理的コンテキストを追加し、番地の緯度と経度の座標をマッピングするか、単に緯度と経度の座標を渡すことができます。 Azure IoT Central のこの機能は、Azure Maps に基づいています。

追加できる場所プロパティのタイプは 2 つあります。
- **アプリケーション プロパティとしての場所**は、シンプルにアプリケーション内に保存されます。 デバイスには、アプリケーションのプロパティに関する情報はありません。
- **デバイス プロパティとしての場所** は、デバイスにより報告されます。

####<a name="adding-location-as-an-application-property"></a>場所をアプリケーションプロパティとして追加する 
Azure IoT Central アプリケーション内で Azure マップを使って、場所プロパティを Application Azure IoT Centralｔとして作成することができます。 たとえば、デバイスの設置先アドレスを追加できます。 

1. ［Device Property］ タブに移動し、[Design Mode] がオンになっていることを確認します。

![場所プロパティ](./media/howto-set-up-template/locationcloudproperty1.png)

2. [Property ] タブで、[Location] をクリックします。
3. オプションとして、表示名、フィールド名、および場所の初期値を設定できます。 

![場所プロパティのフォーム](./media/howto-set-up-template/locationcloudproperty2.png)

場所を追加する形式は 2 つあります。
- **住所としての場所**
- **座標としての場所** 

4. [保存] をクリックします。 

![[Location Property] フィールド](./media/howto-set-up-template/locationcloudproperty3.png)

場所フィールドのフォームで場所の値を更新できるようになります。 

####<a name="adding-location-as-a-device-property"></a>デバイス プロパティとしての場所を追加する 

場所プロパティは、デバイスが報告するデバイス プロパティとして作成できます。
たとえば､デバイスの場所を追跡する場合です。

1.  ［Device Property］ タブに移動し、[Design Mode] がオンになっていることを確認します。
2.  ライブラリで [Device Property] をクリックします。

![[Location Property] フィールド](./media/howto-set-up-template/locationdeviceproperty1.png)

3.  表示名、フィールド名を設定し、データ タイプに “場所” を選択します。 

> [!NOTE]
フィールド名は、デバイスが報告するプロパティの名前と完全に一致する必要があります。 

![[Location Property] フィールド](./media/howto-set-up-template/locationdeviceproperty2.png)

![場所プロパティのオペレーター ビュー](./media/howto-set-up-template/locationdeviceproperty2.png)

場所プロパティを設定したので、デバイスのダッシュボードでマップを追加して場所を可視化できます。 [ダッシュボードで Azure マップに場所を追加する](howto-set-up-template.md)方法 を参照してください。




## <a name="rules"></a>ルール

オペレーターはルールによって、ほぼリアルタイムにデバイスを監視できます。 ルールは、ルールがトリガーされたときに電子メールを送信するなどの**アクション**を自動的に呼び出します。 現在使用できるルールの種類は 1 つです。

- **テレメトリ ルール:** テレメトリ ルールは、選択したデバイスのテレメトリが、指定したしきい値を超えたときにトリガーされます。 テレメトリ ルールの詳細については、[こちら](howto-create-telemetry-rules.md)を参照してください。

## <a name="dashboard"></a>ダッシュボード

ダッシュボードは、オペレーターがアクセスして、デバイスに関する情報を参照できる場所です。 ビルダーは、デバイスがどのように動作しているかをオペレーターが理解する助けになるこのページに、タイルを追加できます。 デバイス テンプレートには複数のダッシュボード タイルを追加できます。 追加できるダッシュボード タイルの種類は、画像、折れ線グラフ、棒グラフ、KPI、設定、プロパティ、およびラベルの 6 つです。

たとえば、**[Settings and Properties]** タイルを追加して、設定とプロパティの現在の値から、選択したものを表示できます。

![ダッシュボードのデバイスの詳細のフォーム](./media/howto-set-up-template/dashboardsettingsandpropertiesform.png)

これでオペレーターがダッシュボードを表示すると、デバイスの設定とプロパティを表示するこのタイルを確認できます。

![ダッシュボード タイル](./media/howto-set-up-template/dashboardtile.png)

### <a name="add-location-azure-map-in-dashboard"></a>ダッシュボードで Azure マップに場所を追加する

［Azure Maps 基盤で場所プロパティを作成する］ (howto-set-up-template.md) ステップで場所プロパティを設定すると､デバイスのダッシュボードのマップを使って場所を可視化でるようになります。

1.  ［Device Dashboard］ タブに移動し、[Design Mode] がオンになっていることを確認してください。
2.  ［Device Dashboard］ のライブラリからマップを選択します。 

![ダッシュボードの場所 Azure Map が選択されます。](./media/howto-set-up-template/locationcloudproperty4map.png)

3.  タイトルを付けて、以前にデバイス プロパティの一部として構成した場所プロパティを選択します。

![ダッシュボードの場所 Azure Map を構成します。](./media/howto-set-up-template/locationcloudproperty5map.png)

4.  保存すると、マップのタイトルに選択した場所が表示されるようになります。 

![ダッシュボードの場所 Azure Map を可視化します。](./media/howto-set-up-template/locationcloudproperty6map.png) 

マップは任意のサイズに変更することができます。

オペレーターがダッシュボードを表示すると、場所マップを含め、構成したすべてのダッシュボード タイルを見ることができるようになります。

![ダッシュボードの場所 Azure Map のダッシュボード](./media/howto-set-up-template/locationcloudproperty7map.png) 



## <a name="next-steps"></a>次の手順

ここでは、Azure IoT Central アプリケーションでデバイス テンプレートを設定する方法について説明しました。推奨される次の手順は以下のとおりです。

> [!div class="nextstepaction"]
> [デバイス テンプレートの新しいバージョンを作成する](howto-version-devicetemplate.md)
