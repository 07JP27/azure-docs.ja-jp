<properties
	pageTitle="Azure Batch の技術概要"
	description="Azure Batch サービスの概念、ワークフロー、シナリオについて説明します。"
	services="batch"
	documentationCenter=""
	authors="dlepow"
	manager="timlt"
	editor=""/>

<tags
	ms.service="batch"
	ms.workload="big-compute"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="04/28/2015"
	ms.author="danlep"/>


#Azure Batch の技術概要
Azure のバッチを使用すると、大規模な並列および高パフォーマンスのコンピューティング (HPC) アプリケーションをクラウドで実行できます。これは、ジョブのスケジュール設定を提供するサービスのプラットフォームとの仮想マシン (Vm) をジョブを実行するは、管理のコレクションには、オートスケー リングです。バッチのサービスを使用すると、要求時に、またはスケジュールに従って、Azure での実行し、ジョブのスケジュール設定と、基になるプラットフォームでの Vm の管理の複雑さの影響を心配せずにワークロードをバッチを構成できます。

>[AZURE.NOTE]Batch はプレビュー段階です。バッチを使用するのには、Azure アカウントが必要し、バッチのプレビューにサインアップする必要があります。アカウントがない場合は、無料の試用アカウントを数分で作成することができます。詳細については、[Azure アカウントの作成に関するページ](http://azure.microsoft.com/develop/php/tutorials/create-a-windows-azure-account/)を参照してください。


## ユース ケース

バッチでは、弾力性し、クラウドの小数点以下桁数で役に立ちます *バッチ処理* または *バッチ コンピューティング* -結果を必要な大量の一部を取得する同様のタスクを実行しています。コマンド ライン プログラムまたはスクリプトがデータ ファイルのセットを入力として受け取り、データを一連のタスクで処理して、一連の出力ファイルを生成します。最終的な結果または大規模なワークフローでは、中間の手順の出力ファイルが表示されることがあります。

バッチ コンピューティングは、定期的にまたはオンデマンドで大量のデータの処理、変換、および分析を行う組織にとって一般的なパターンです。これには、銀行の日次リスク レポートや定期的に行う必要がある給与処理などのサイクル末期処理が含まれます。また、一般に計算クラスターまたはグリッドのツールやリソースを必要とする大規模なビジネス、科学、エンジニアリング アプリケーションも含まれます。このようなアプリケーションには、自動車の設計、石油やガスの探査、生命科学研究、デジタル コンテンツの制作などの分野での専門的なワークロードだけでなく、流体力学シミュレーションなどの従来の HPC アプリケーションも含まれます。

Batch は、本質的に並列な ("並列性がきわめて高い" とも呼ばれます) アプリケーションまたはワークロードに対応するため、複数のコンピューター (たとえば、Batch サービスによって管理されるコンピューティング VM) で並列タスクを実行するのに役立ちます。図 1 を参照してください。

![並列タスク][parallel]

**図 1 です。複数のコンピューターで実行されている並列タスク**

たとえば、次のようになります。

* 財務リスクのモデリング
* 画像のレンダリングと画像処理
* メディアのエンコードとトランスコード
* 遺伝子配列の分析
* ソフトウェアのテスト

また、Batch を使用して並列計算を実行すると、最終的により少ないステップで、より複雑で非循環型ではない他の並列ワークロードを処理できます。

>[AZURE.NOTE]現在、Batch プレビューでは、Message Passing Interface (MPI) アプリケーションはサポートされていません。

## 開発者シナリオ

REST ベースの Batch API は、Batch サービスでバッチ ワークロードを構成および実行するのに役立つ 2 つの開発者シナリオをサポートしています。

1. **Workitems として計算を分散** -を使用して、 *バッチ* Api を作成およびコンピューティング Vm の柔軟なプールを管理したり、その作業を指定します。これはリソースを完全に制御できますであり、マネージャーのワークフローまたは meta スケジューラ、これをバッチの REST Api または必要に応じて、作業項目のジョブ マネージャーの機能を使用して実装すると、タスク実行パイプライン - などを管理するクライアントが必要です。計算クラスターを設定したり、ジョブのキューイングやスケジュール設定のためのコードを記述したりする代わりに、計算ジョブのスケジュール設定を自動化し、ジョブを実行するコンピューティング VM のプールを拡張または縮小できます。作業項目を指定することの一部として、すべての依存関係を定義して入力と出力ファイルの移動を定義します。

2. **パブリッシュと、バッチのサービスで実行されるアプリケーション** - *バッチ アプリ* 支援をバッチでバック グラウンドで管理されるバーチャル マシンのプールにサービスとして動作するように、既存のアプリケーションをラップするより高いレベルでの Api 機能します。アプリケーションは、いずれかのクライアント ワークステーション上の現在またはコンピューティング クラスターを実行している可能性があります。Batch Apps フレームワークは、入力および出力ファイルの移動、ジョブの実行、ジョブの管理、およびデータの永続性を処理します。また、Batch Apps では、データを分割する方法やジョブの複数のステップに関してタスクをモデル化できます。REST ベースの API と Batch Apps ポータルが含まれています。このポータルは Azure の管理ポータルからアクセスでき、送信したジョブを監視するために使用できます。


## Batch の概念

Batch サービスと API を操作するための主要な概念を次のセクションで概説します。詳細については、次を参照してください。 [Azure バッチの API の基本](batch-api-basics.md)です。

* [バッチのアカウント](#BKMK_Account)
* [タスク仮想マシンとプール](#BKMK_TVM)
* [作業項目、ジョブ、およびタスク](#BKMK_Workitem)
* [ファイルとディレクトリ](#BKMK_Files)

### <a id="BKMK_Account">バッチのアカウント</a>
一意の必要がある **バッチ アカウント** 、バッチのサービスを使用します。バッチのサービスに対して行ったすべての要求は、アカウントとそのアクセス キーの名前を使用して認証する必要があります。

バッチ アカウントを作成して、または Azure ポータルでアカウントのアクセス キーの管理、 [バッチの PowerShell コマンドレット](batch-powershell-cmdlets-get-started.md)です。

ポータルで、バッチのアカウントを作成するには

1. [Azure の管理ポータル](https://manage.windowsazure.com)にサインインします。
2. クリックして **新規**, 、] をクリックして **コンピューティング**, 、] をクリックして **バッチ サービス**, 、順にクリック **簡易作成**です。 ![Batch アカウントを作成する][account_portal]

3. 次の情報を入力します。

	*  **アカウント名**, 、バッチのアカウントの URL で使用する一意の名前を入力します。
	*  **領域**, 、バッチの使用可能な地域を選択します。
	* 1 つ以上のサブスクリプションがある場合は、 **サブスクリプション**, 、バッチの使用に対して課金されますが、使用可能なサブスクリプションを選択します。


### <a id="BKMK_TVM">タスク仮想マシンとプール</a>

A **タスク仮想マシン** (TVM) は、Azure の仮想マシンを特定の実行に、バッチ サービス専用にするタスクなど、実行可能ファイル (.exe)、またはバッチのアプリの場合、アプリケーションでのアプリケーションのイメージからの 1 つまたは複数のプログラムです。一般的な Azure VM とは異なりしないプロビジョニングまたは TVM を直接管理バッチのサービスを作成およびとして Tvm を管理する代わりに、 **プール** 同様に構成された Vm は、図 2 のです。

![プールと Tvm][TVM_pool]

**図 2 になります。Tvm のプール**

バッチ Api を使用する場合は、直接、プールを作成したり、操作を完了するを指定すると自動的に作成できます。Batch Apps API を使用した場合は、クラウド対応アプリケーションを実行したときにプールが自動的に作成されます。


プールの属性は、次のとおりです。

* A [サイズ](http://msdn.microsoft.com/library/azure/dn197896.aspx) 、Tvm の
* TVM 上で実行されるオペレーティング システム
* TVM の最大数
* プールのスケーリング ポリシー - 現在のワークロードとリソースの使用量に基づいてタスクを処理する TVM の数を動的に調整するための式
* プール内通信を行うために TVM 上のファイアウォール ポートを有効にするかどうか
* TVM にインストールされる証明書。たとえば、ストレージ アカウントへのアクセスの認証用
* TVM の開始タスク。アプリケーションのインストールやタスクで使用するデータのダウンロードなど、1 回限りの操作用

>[AZURE.NOTE]現在、TVM では、Windows Server 2012 R2、Windows Server 2012、または Windows Server 2008 R2 SP1 オペレーティング システムのみを実行できます。

プールは、そのプールを作成した Batch アカウントのみが使用できます。1 つの Batch アカウントで複数のプールを持つことができます。

プール内のすべての TVM 一意の名前と関連付けられている IP アドレスが割り当てられます。TVM をプールから削除すると、オペレーティング システム、そのローカル ファイル、その名前、およびその IP アドレスに加えられた変更は失われます。TVM をプールから削除すると、その有効期間が終了します。


### <a id="BKMK_Workitem">作業項目、ジョブ、およびタスク</a>

A **workitem** Tvm、プール内でのアプリケーションを実行する方法を指定するテンプレートです。A **ジョブ** スケジュールされたワーク アイテムには 1 回出現する場合も待ち続けます。ジョブのコレクションから成る **タスク**です。図 3. に、これらの基本的な関係を示します。

![作業項目、ジョブ、およびタスク][job_task]

**図 3 です。ワーク アイテム、ジョブ、およびタスク**

バッチを使用して開発を使用する、Api によって、作業項目、ジョブ、およびタスクについての増減の詳細を管理する必要があります。

* バッチの Api を使用したアプリケーションを開発する場合は、プログラムを使用して、作業項目、ジョブ、およびタスクを定義して、タスクを実行している TVM プールを構成する必要があります。

* Batch Apps API とツールを使用してクライアント アプリケーションを統合する場合は、自動的にジョブをタスクに分割し、タスクを処理して個々のタスクの結果を最終的なジョブの結果にマージするコンポーネントを使用することができます。ワークロードをバッチのサービスを送信するときに、バッチのアプリケーション フレームワーク、ジョブを管理し、Tvm 上のタスクを実行します。



### <a id="BKMK_Files">ファイルとディレクトリ</a>

ファイルは、ジョブのタスクへの入力として使用されるデータです。タスクには、0 個、1 個、または複数個の入力ファイルを関連付けることができます。また、同じファイルを複数のタスクで使用することもできます。たとえば、ムービー レンダリング ジョブのタスクに対しては、よく使用するテクスチャやモデルがある場合があります。データ分析ジョブのタスクに対しては、一式の観測値または測定値を含むファイルを使用します。

処理する入力データと、出力データの作成を含む各タスクの作業ディレクトリが存在します。これらのディレクトリとファイルは、ジョブの実行中に他のタスクから使用できます。TVM 上のすべてのタスク、ファイル、およびディレクトリは、単一のユーザー アカウントによって所有されます。

ここでも、によっては、Api をバッチで使用する必要があります、ジョブとタスクの入力と出力のファイルに関する詳細情報を増やしたり減らしたり管理します。バッチの Api を開発する場合これらの依存関係とファイルの動きが明示的に指定します。Batch Apps の場合は、フレームワークによってこれらの項目のほとんどが処理されます。

## 作業項目のワークフロー
図 4 では、アプリケーション プールを処理するための配布先に送信する方法を示します。これは、バッチの API を使用します。

![作業項目のワークフロー][work_item_workflow]

**図 4。プールされた Vm に作業項目を配布するワークフロー**

1.	ジョブに必要な入力ファイル (ソース データやイメージ) を Azure ストレージ アカウントにアップロードします。これらのファイルは、Batch サービスがアクセスできるように、ストレージ アカウントに配置する必要があります。これらのファイルは、Batch サービスによってタスクの実行時に TVM に読み込まれます。
2.	依存バイナリ ファイルをストレージ アカウントにアップロードします。バイナリ ファイルとは、タスクによって実行されるプログラムと依存アセンブリを表します。これらのファイルはストレージからもアクセスできる必要があります。これらのファイルは、TVM に読み込まれます。
3.	TVM のプールを作成し、プール内の TVM のサイズ、実行する OS、およびその他のプロパティを指定します。タスクを実行すると、このプールから TVM が割り当てられます。
4.	作業項目を作成します。ワーク アイテムを作成するときに、ジョブが自動的に作成します。作業項目を使って、タスクのジョブを管理できます。
5.	ジョブにタスクを追加します。各タスクは、アップロードされたプログラムを使用して、アップロードされたファイルの情報を処理します。
6.	アプリケーションを実行し、出力の結果を監視します。

## アプリケーションを発行および実行するためのワークフロー
図 5. は、Batch Apps API を使用してアプリケーションを発行した後、Batch によって有効になっているアプリケーションにジョブを送信するための基本的なワークフローを示しています。

![アプリケーションの公開のワークフロー][app_pub_workflow]

**図 5。ワークフローおよびバッチのアプリで、アプリケーションを実行するには**

1.	準備、 **アプリケーション イメージ** -既存のアプリケーションの実行可能ファイル、および必要なサポート ファイルの zip ファイルです。従来のサーバー ファームまたはクラスターで実行するのと同じ実行可能ファイルを使用できる場合があります。
2.	Zip ファイルを作成、 **アセンブリのクラウド** 呼び出すされ、バッチのサービスへのワークロードのディスパッチをします。これには、SDK を介して利用できる 2 つのコンポーネントが含まれます。

	a.**ジョブ スプリッター** –、ジョブを個別に処理できるタスクに分割します。たとえば、アニメーション シナリオで、ジョブ スプリッターは、ムービー レンダリング ジョブを受け取って個々のフレームに分割します。

	b.**タスク プロセッサ** –、アプリケーションを特定のタスクの実行可能ファイルを呼び出します。たとえば、アニメーション シナリオで、タスク プロセッサはレンダリング プログラムを起動して、タスクで指定された 1 つのフレームをレンダリングします。

3.	Batch Apps API または開発者ツールを使用して、前の 2 つの手順で準備した zip ファイルを Azure ストレージ アカウントにアップロードします。これらのファイルは、Batch サービスがアクセスできるように、ストレージ アカウントに配置する必要があります。通常、この操作は、サービス管理者がアプリケーションごとに 1 回行います。
4.	Azure で有効になっているアプリケーション サービスにジョブを送信する方法を提供します。これには、アプリケーションの UI のプラグインや Web ポータルを使用できます。また、バックエンド システムの一部としての自動サービスを使用することもできます。SDK には、さまざまなオプションを示すサンプルが用意されています。

	ジョブを実行するには、次の手順を実行します。

	a.ユーザーのジョブに固有の入力ファイル (ソース データやイメージ) をアップロードします。これらのファイルは、Batch サービスがアクセスできるように、ストレージ アカウントに配置する必要があります。

	b.必要なパラメーターおよびファイルと共にジョブを送信します。

	c.API または Batch Apps ポータルを使用してジョブの進行状況を監視します。

	d.出力をダウンロードします。

## その他のリソース

* [.NET の Azure のバッチのライブラリを開始します。](batch-dotnet-get-started.md)
* [Azure のバッチ開発ライブラリおよびツール](batch-development-libraries-tools.md)
* [Azure のバッチの REST API リファレンス](http://go.microsoft.com/fwlink/p/?LinkId=517803)
* [Azure のバッチのアプリの REST API リファレンス](http://go.microsoft.com/fwlink/p/?LinkId=517804)

[parallel]: ./media/batch-technical-overview/parallel.png
[TVM_pool]: ./media/batch-technical-overview/TVM_pool.png
[job_task]: ./media/batch-technical-overview/job_task.png
[account_portal]: ./media/batch-technical-overview/account_portal.png
[work_item_workflow]: ./media/batch-technical-overview/work_item_workflow.png
[app_pub_workflow]: ./media/batch-technical-overview/app_pub_workflow.png

<!---HONumber=GIT-SubDir-->