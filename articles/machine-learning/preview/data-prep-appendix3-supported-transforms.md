---
title: "Azure Machine Learning でデータ変換をデータの準備に使用する | Microsoft Docs"
description: "この記事では、Azure Machine Learning データ準備で使用可能な変換の完全な一覧を提供します。"
services: machine-learning
author: euangMS
ms.author: euang
manager: lanceo
ms.reviewer: 
ms.service: machine-learning
ms.workload: data-services
ms.custom: 
ms.devlang: 
ms.topic: article
ms.date: 10/09/2017
ms.openlocfilehash: d0b62a63d381239e17b7dccceb89171bca15a68e
ms.sourcegitcommit: 295ec94e3332d3e0a8704c1b848913672f7467c8
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/06/2017
---
# <a name="use-data-transforms-for-data-preparation-in-azure-machine-learning"></a>Azure Machine Learning でデータ変換をデータの準備に使用する

Azure Machine Learning の "*変換*" では、特定形式のデータを使用し、データに対して何らかの操作 (データ型の変更など) を実行して、新しい形式のデータを生成します。 変換ごとに独自のインターフェイスと動作があります。 データ フローのステップを介して複数の変換を連結することで、データに対して複雑な変換や反復可能な変換を行えます。 これが、データ準備の中核機能です。

Azure Machine Learning で使用可能な変換の一覧を次に示します。 

## <a name="column-selection"></a>列の選択 
この一覧の変換の多くは、1 つまたは複数の列に対して実行されます。 複数の列を選択するには、Ctrl キーを使用します。 列の範囲を選択するには、Shift キーを使用します。

## <a name="transforms-from-the-main-menu-or-the-grid-header"></a>メイン メニューまたはグリッド ヘッダーからの変換 
変換には、メイン メニューの [変換] オプションからアクセスできます。 データ グリッド内の列名を右クリックして [変換] を選択することもできます。 複数の列が選択されている場合、その 1 つを右クリックすると、[変換] メニューが表示されます。

右クリック メニューに表示されるのは、選択したデータ型に対して有効な変換のみです。 メイン メニューにはすべての変換が表示されますが、選択した列に関係ない変換は無効になっています。

コンテキスト変換の一部のサブセットは、セルを右クリックして使用できます。 これらの変換には、コピー、置換、フィルター処理があります。 これらはデータ型に対応しているため、数値型の列のオプションは、文字列型の列のオプションとは異なります。

## <a name="derive-column-by-example"></a>列の派生の例
この変換を使用して、1 つ以上の依存の列から派生物として新しい列を作成します。 この変換は、入力 (選択された) 列と指定の例を参照して、新しい列への出力を決定します。 

この変換を使用するには、1 つ以上の列を選択します。 例によって、新しい (空の) 派生列を追加します。 (他の列から派生される場合) 派生列に表示する例を入力すると、"By Example" テクノロジが列のその他すべてのセルへの値の入力を試みます。 

複雑な例では、複数の例の入力が必要になる場合があります。 そのためには、別のセルを選択して別の例を入力します。

「By Example」テクノロジは、選択した列を使用して、例の意味を判別するよう試みます。 列を選択していない状態でこの変換を呼び出すと、現在の行のすべてのセルが使用されます。 必要な列のみを選択すると、より正確な結果が得られます。

変換を呼び出す前に、列を選択することができます。 変換エディターが開いたら、各列の上部にあるチェック ボックスによって、どの列が入力として選択されているか確認できます。 列ヘッダーのチェック ボックスを使用して、選択された列の追加や削除を行うことができます。

**例による列の派生**変換の詳細とその他のサンプルについては、[例による列の派生のリファレンス](data-prep-derive-column-by-example.md)を参照してください。  

## <a name="split-column-by-example"></a>例による列の分割
この変換は、"By Example" エンジンを使用して、既存の列を別の *n* 個の列に分割しようとします。 以降の生成された列についても自動分割を実行できます。

**例による列の分割**変換の詳細とその他のサンプルについては、[例による列の分割のリファレンス](data-prep-split-column-by-example.md)を参照してください。

## <a name="expand-json"></a>JSON の展開

この変換では、有効な JSON テキストを使用して 1 つの列を拡張することにより、複数の列を追加できます。

**JSON の展開**変換の詳細とその他のサンプルについては、[JSON の展開のリファレンス](data-prep-expand-json.md)を参照してください。


## <a name="combine-columns-by-example"></a>列の結合の例

この変換は、複数の列からの値を結合して新しい列を追加します。 

**例による列の結合**の詳細とその他のサンプルについては、[例による列の結合のリファレンス](data-prep-combine-columns-by-example.md)を参照してください。


## <a name="duplicate-column"></a>列の複製
この変換は、選択した 1 つ以上の列の正確なコピーを作成し、それぞれに元の列名から派生する新しい名前を付けます。

## <a name="text-clustering"></a>テキスト クラスタリング 
この変換は、本来同じであるはずの不整合のある値を取り上げ、グループにまとます。  

この変換を使用すると、1 つの列内の値が類似性について分析され、クラスターにグループ化されます。 各クラスターには基準となる値があり、この値によってクラスター内のすべてのインスタンスとすべてのインスタンス値が置き換えられます。 クラスター全体の削除や、基準の値の編集もできます。 一部のクラスターについてはインスタンスを削除することができます。 インスタンスをクラスターにグループ化するために使用する類似性スコアのしきい値フィルターを変更できます。

既定では、この変換は、すべてのクラスター インスタンスの値を、当該クラスターの基準の値で置き換えます。その際、新しい値を格納するため、新しい列が作成されます。 各インスタンスについて、新しい列 (名前を指定可能) に類似性スコアを追加することもできます。この列は、データ フローの後続の部分で使用できます。

## <a name="replace-values"></a>値の置換
この変換を使用して、1 つの文字列を別の文字列に置き換えます。 ソース文字列は、文字列の一部でもセル全体でもかまいません。置換は、1 つの列にも複数の列にも適用できます。 検索文字列では、標準文字、特殊文字のいずれの検索もサポートします。 

## <a name="replace-na-values"></a>NA 値の置換
この変換を使用して、"NA" のさまざまな形式 (N/A、NA、null、NaN など) や空の文字列を、一貫した単一の値に置き換えることができます。 この変換は、1 つまたは複数の列をサポートしており、列が選択されている場合にのみ表示されます。 列が選択されていない場合は、メインの [変換] メニューに表示されません。

## <a name="replace-missing-values"></a>欠損値の置換
この変換は、欠けているデータを 1 つの値で置き換えます。また、1 つまたは複数の列をサポートしています。 この変換は、列が選択されている場合にのみ表示されます。 列が選択されていない場合は、メインの [変換] メニューに表示されません。

## <a name="replace-error-values"></a>エラー値の置換
この変換は、エラーを 1 つの値で置き換えます。また、1 つまたは複数の列をサポートしています。 この変換は、列が選択されている場合にのみ表示されます。 列が選択されていない場合は、メインの [変換] メニューに表示されません。

## <a name="trim-string"></a>文字列のトリミング
この変換は、先頭および末尾の "空白" 文字 (スペース、タブなど) を 1 つ以上の列から削除します。

## <a name="adjust-precision"></a>有効桁数の調整
この変換は、数値列の小数点以下桁数を設定します。

## <a name="rename-column"></a>列名の変更
この変換は、選択した列の名前を変更します。 列のヘッダーから、列名をクリックしてインラインで呼び出すこともできます。

## <a name="remove-column"></a>列の削除
この変換は、選択した列を削除します。また、1 つまたは複数の列に対して機能します。 

## <a name="keep-column"></a>列の保持
この変換は、選択した列のみを保持します。また、1 つまたは複数の列に対して機能します。

## <a name="handle-path-column"></a>パス列の処理
ファイルのインポート中に、**データ ソースの追加**機能によってパス列が自動的にデータセットに追加されます。 データセットへのパスを形成する完全修飾ファイル名が含まれています。 この変換は、データセットの余分な列を追加または削除します。

## <a name="convert-field-type-to-numeric"></a>フィールド型の数値への変換
この変換は、列の型を数値型に変換します。 整数以外のデータに対する区切り記号を指定できます。 この変換は、既定では区切り記号を要求しないため、**[編集]** メニュー項目を使用してエディターを起動します。 この変換は、1 つまたは複数の列に対して機能します。

## <a name="convert-field-type-to-date"></a>フィールド型の日付への変換
この変換は、列の型を日付型に変換します。 既定の日付/時刻形式を使用しますが、`strftime` ディレクティブを使用してオーバーライドすることもできます。 前に固定の日付と時刻の値を付加することもできます。

この変換は、既定では形式を要求しないため、後続の手順で **[編集]** メニュー項目を使用してエディターを起動します。 この変換は、1 つまたは複数の列に対して機能します。

日付型に変換できるのは 1677 年 9 月 22 日から 2262 年 4 月 11 日までの期間の日付のみです。

## <a name="convert-field-type-to-boolean"></a>フィールド型のブール値への変換
この変換は、列の型を true または false に変換します。 複数の値の true または false へのマッピングをサポートしており、このマッピングは編集できます。 true/false マッピング テーブルに存在しない値をマップできる定数もサポートしています。 この変換は、1 つまたは複数の列に対して機能します。

## <a name="convert-field-type-to-string"></a>フィールド型の文字列への変換
この変換は、列の型を文字列に変換します。また、1 つまたは複数の列に対して機能します。

## <a name="convert-unix-timestamp-to-datetime"></a>Unix のタイムスタンプの DateTime への変換
この変換は、Unix のタイムスタンプ形式がデータ内で文字列として記述されていても、正しく解釈します。 そのタイムスタンプを、データの準備の中で正しく日付型に変換します。

## <a name="filter"></a>filter
この変換は、1 つ以上の列の値に基づく行のフィルター処理をサポートします。 フィルターの条件は、各列のデータ型によって異なります。文字列型の列は、"次の値を含む" や "次の値を含まない" という条件でフィルター処理できます。 数値型の列は、"次の値より大きい" や "次の値より小さい" という条件でフィルター処理できます。

メイン メニューまたは列ヘッダーの右クリックから**フィルター**変換を呼び出した場合、合致しなかった行を別のデータ フローにフォークするオプションを使用できます。 メインのデータ フローはフィルターに**合致**した行で継続し、フィルターで**除外**されたすべての行を含む新しいデータ フローが作成されます。

## <a name="use-first-row-as-headers"></a>最初の行をヘッダーとして使用
この変換は、データ セットの 1 行目を列名に昇格させます。 1 行目にデータが入っていない列がある場合、名前は自動生成されます。 この変換を使用すると、データのインポートは早くとも 2 行目から開始されることになります。 **[スキップする行]** の設定に応じて、インポートは、データ セット内で、さらに下の行から開始されることがあります。 また、1 行目を列名として使用せず、自動生成された名前のみを使用することもできます。

## <a name="join"></a>Join (結合)
この変換は、2 つのデータ フローを 1 つに結合するために使用します。 結合の出力のどれを結果とするかを選択できます。結合が成功した行、結合が失敗した "左側" の行、結合が失敗した "右側" の行を選択できます。

**結合**変換は 1 つのデータ フローから起動され、そのデータ フローを結合の一方として選択します。 次に、結合のもう一方として別のデータ フローを選択するように求めます。 2 つのフローを選択すると、変換は、それぞれのフローで、どの列を使用して結合を行うかを要求します。 結合に複数の列が必要な場合、変換を起動する前に派生列を作成して、結合のみを目的とした新しい (連結された) 列を作成します。 変換は、結合キーの提案と、可能であれば、派生列の自動生成を試みます。

結合が完了したら、結合の Sankey ダイアグラム ビューが表示されます。 線の幅は、結合フローの部分を移動する行の数を相対的に示しています。 右側のパネルを使用して、成功した行、失敗した左側の行、失敗した右側の行を排他的に選択できます。 1 つの分岐を選択することもできます。

## <a name="append-rows"></a>行の追加
この変換は、別のデータ フローから現在のデータ フローにデータを追加します。 位置によって列をマップし、末尾に新しい行を追加します。

## <a name="append-columns"></a>列の追加
この変換は、別のデータ フローから現在のデータ フローに新しい列を追加します。 右側に新しい列を追加します。 各行にデータは入力されません。

## <a name="summarize"></a>集計
この変換は、選択した 1 つ以上の列の一意の値を組み合わせて集計を計算します。 

サポートされている集計は、COUNT 、SUM、MIN、MAX、MEAN、VARIANCE、STANDARD DEVIATION です。 特定の列の集計のリストは、そのデータ型に適用できる集計のみにフィルター処理されます。 適用できない集計は無効になります。 たとえば、文字列型の列の平均を計算することはできませんが、最小値と最大値を計算することはできます。

エディターを利用できる場合は、列ヘッダーからパネルの左上にドラッグすると、集計される列がここに表示されます。 このパネルは階層表示となっており、入れ子になった集計を行うことができます。 右上の [エディター] パネルを使用して、列に適用する集計を選択します。 １ つの列を 1 回、または複数回集計に使用できます。 少なくとも 1 つの集計が選択されたら、右下のグリッドに、集計フォームがプレビュー表示されます。 

この変換は、`ANSI-SQL GROUP BY` に似ています。

## <a name="remove-duplicates"></a>重複の除去
この変換は、選択した 1 つ以上の列で重複する値がある場合に、行全体を削除します。 列が選択されていない場合、削除されるのは、列の値がすべて同じ行のみです。

## <a name="sort"></a>並べ替え
この変換は、データを並べ替えます。 1 つ以上の列で並べ替えが可能で、各列は昇順 (既定) または降順 (エディターから変更可能) で並べ替えることができます。

この変換は、`ANSI-SQL ORDER BY` に似ています。

## <a name="output-transforms"></a>出力の変換
次の変換は、出力データを変換します。 単一のフロー内に複数の書き出しブロックを設けて、データをさまざまなポイントで書き出すことができます。

### <a name="write-to-csv"></a>CSV への書き込み
この変換は、データ フローの現在のポイントから、CSV 形式でデータを書き出します。 この変換は、ファイルの場所 (ローカルまたはリモート) やさまざまな設定を制御します。

### <a name="write-to-parquet"></a>Parquet への書き込み
この変換は、データ フローの現在のポイントから、Parquet 形式でデータを書き出します。 この変換は、ファイルの場所 (ローカルまたはリモート) やさまざまな設定を制御します。

## <a name="script-based-transforms"></a>スクリプト ベースの変換
次の変換は、スクリプト (Python) を使用して、コア製品では提供されない機能を実行します。 

>[!NOTE]
>これらの変換のいずれかを使用する前に、[Python の拡張機能の使用](data-prep-python-extensibility-overview.md)に関するページを参照してください。

### <a name="add-column-script"></a>列の追加 (スクリプト)
この変換は、Python 式を使用してデータに列を追加します。
詳細については、[新しい列を派生させる Python コードのサンプル](data-prep-appendix10-sample-custom-column-transforms-python.md)に関するページを参照してください。

### <a name="advanced-filter-script"></a>高度なフィルター (スクリプト)
この変換を使用して、Python の行レベル フィルターを記述します。
詳細については、[フィルター式の例](data-prep-appendix6-sample-filter-expressions-python.md)に関するページを参照してください。

### <a name="transform-dataflow-script"></a>データフローの変換 (スクリプト)
この変換は、Python をデータ セット全体に適用します。
詳細については、[データ フロー変換の例](data-prep-appendix7-sample-transform-data-flow-python.md)に関するページを参照してください。

この変換では、Python をデータ パーティション全体に適用することもできます。
詳細については、[データ フロー変換の例](data-prep-appendix7-sample-transform-data-flow-python.md)に関するページを参照してください。

### <a name="write-dataflow-script"></a>データ フローの書き出し (スクリプト)
この変換は、Python を使用してデータ セット全体を書き出します。
詳細については、[新しい列を派生させる Python のサンプル](data-prep-appendix9-sample-destination-connections-python.md)に関するページを参照してください。



