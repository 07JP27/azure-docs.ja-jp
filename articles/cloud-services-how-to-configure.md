<properties linkid="manage-services-how-to-configure-a-cloud-service" urlDisplayName="構成方法" pageTitle="クラウド サービスの構成方法 - Azure" metaKeywords="クラウド サービスの構成" description="Azure のクラウド サービスの構成方法について説明します。クラウド サービスの構成の更新方法と、ロール インスタンスへのリモート アクセスの構成方法を紹介します。" metaCanonical="" services="cloud-services" documentationCenter="" title="クラウド サービスの構成方法" authors=""  solutions="" writer="davidmu" manager="" editor=""  />




<h1><a id="configurecloudservice"></a>クラウド サービスの構成方法</h1>

[WACOM.INCLUDE [disclaimer](../includes/disclaimer.md)]

クラウド サービスで最もよく使用される設定は Azure の管理ポータルで構成できます。また、構成ファイルを直接更新する場合は、サービス構成ファイルをダウンロードして内容を更新し、更新したファイルをアップロードして、クラウド サービスの構成を更新します。どちらの方法でも、構成の更新はすべてのロール インスタンスに適用されます。

クラウド サービスで実行中の 1 つまたはすべてのロールへのリモート デスクトップ接続を有効にすることもできます。リモート デスクトップを使用すると、アプリケーションの実行中にそのデスクトップにアクセスし、問題のトラブルシューティングや診断を行うことができます。アプリケーション開発時にリモート デスクトップのサービス定義ファイル (.csdef) を構成しなかった場合でも、ロールへのリモート デスクトップ接続を有効にできます。リモート デスクトップ接続を有効にするために、アプリケーションを再展開する必要はありません。

Azure で構成の更新中に 99.95% の可用性を保証できるのは、各ロールに少なくとも 2 つのロール インスタンス (仮想マシン) がある場合だけです。この場合、1 台の仮想マシンでクライアントからの要求を処理し、もう 1 台で更新を行うことができます。詳細については、「[サービス レベル アグリーメント](https://www.windowsazure.com/ja-jp/support/legal/sla/)」を参照してください。

##目次##

* [方法: クラウド サービス構成の更新](#update)
* [方法: ロール インスタンスへのリモート アクセスの構成](#remoteaccess)


<h2><a id="update"></a>方法: クラウド サービス構成の更新</h2>

1. [Azure の管理ポータル](http://manage.windowsazure.com/)で、**[クラウド サービス]** をクリックします。目的のクラウド サービスの名前をクリックして、ダッシュボードを開きます。


2. **[構成]** をクリックします。

	**[構成]** ページでは、監視の構成、ロール設定の更新、およびロール インスタンス (仮想マシン) のゲスト オペレーティング システムとファミリの選択ができます。

	![[構成] ページ](./media/cloud-services-how-to-configure/CloudServices_ConfigurePage1.png)

3. 監視設定では、監視レベルの設定 ([詳細] または [最小])、および詳細監視に必要な診断接続文字列の構成を行います。手順については、「[クラウド サービスの監視方法](../how-to-monitor-a-cloud-service/)」を参照してください。


4. サービス ロールについては (ロールによりグループ分け)、次の設定を更新できます。

	>-**[設定]** - サービス構成ファイル (.cscfg) の *ConfigurationSettings* 要素で指定された各種構成設定値を変更します。
	
	>-**[証明書]** - ロールの SSL 暗号化で使用されている証明書のサムプリントを変更します。証明書を変更するには、まず、**[証明書]** ページで新しい証明書をアップロードする必要があります。次に、ロール設定に表示される証明書文字列のサムプリントを更新します。

5. **[オペレーティング システムの設定]** で、ロール インスタンス (仮想マシン) のオペレーティング システム ファミリまたはバージョンを変更することも、**[自動]** を選択して、現在のオペレーティング システム バージョンの自動更新を再開することもできます。オペレーティング システムの設定は、Web ロールと Worker ロールに適用されますが、以前の Azure の管理ポータルでホステッド サービスに追加された VM ロールは影響を受けません。

	新しいクラウド サービスを展開するときは、オペレーティング システムとして Windows Server 2008 R2、Windows Server 2008 with Service Pack 2 (SP2)、または Windows Server 2012 を選択できます。展開中に、すべてのロール インスタンスに最新のオペレーティング システムがインストールされ、オペレーティング システムは既定で自動更新されます。

	コードの互換性を維持するために異なるバージョンのオペレーティング システムでクラウド サービスを実行する必要がある場合は、オペレーティング システム ファミリおよびバージョンを選択できます。特定のバージョンのオペレーティング システムを選択すると、クラウド サービスで使用するオペレーティング システムの自動更新は中断されます。オペレーティング システムに更新プログラムが適用されるようユーザーが責任を持つ必要があります。

	最新バージョンのオペレーティング システムでアプリケーションに生じる互換性の問題がすべて解決された場合、オペレーティング システムのバージョンを **[自動]** に設定して、オペレーティング システムの自動更新を再開できます。

	![OS 設定](./media/cloud-services-how-to-configure/CloudServices_ConfigurePage_OSSettings.png)

6. 構成設定を保存してロール インスタンスに適用するには、**[保存]** をクリックします (変更を取り消すには、**[破棄]** をクリックします)。**[保存]** および **[破棄]** は、設定を変更するとコマンド バーに追加されます。

###クラウド サービス構成ファイルを手作業で更新するには###

1. 現在の構成を含むクラウド サービス構成ファイル (.cscfg) をダウンロードします。クラウド サービスの **[構成]** ページで、**[ダウンロード]** をクリックします。続いて **[保存]** または **[名前を付けて保存]** をクリックして、ファイルを保存します。

2. サービス構成ファイルを更新した後、次のステップでファイルをアップロードして構成の更新内容を適用します。

	a. **[構成]** ページで、**[アップロード]** をクリックします。
	
	**[新しい構成ファイルのアップロード]** が開きます。

	![構成のアップロード](./media/cloud-services-how-to-configure/CloudServices_UploadConfigFile.png)

	b. **[構成ファイル]** で、**[参照]** を使って、更新した .cscfg ファイルを選択します。

	c. クラウド サービスにインスタンスが 1 つしかないロールがある場合は、**[1 つ以上のロールに単一のインスタンスが含まれている場合でも更新する]** チェック ボックスをオンにして、ロールの構成を更新できるようにして続行します。

	Azure では、各ロールに少なくとも 2 つのインスタンスを定義しない限り、サービス構成の更新中にクラウド サービスの最低 99.95% の可用性を保証することはできません。詳細については、「[サービス レベル アグリーメント](http://www.windowsazure.com/ja-jp/support/legal/sla/)」を参照してください。

	d. [OK] (チェックマーク) をクリックします。


<h2><a id="remoteaccess"></a>方法: ロール インスタンスへのリモート アクセスの構成</h2>

リモート デスクトップを使用して、Azure で実行されているロールのデスクトップにアクセスできます。リモート デスクトップ接続を使用すると、アプリケーションの実行中にそのアプリケーションの問題のトラブルシューティングや診断を行うことができます。アプリケーションの設計時、またはアプリケーションを Azure に展開した後で、ロールでのリモート デスクトップ接続を有効にできます (ロールの実行中)。管理ポータルを通じて実行中のロールでリモート デスクトップ接続を有効にしても、アプリケーションを再展開する必要はありません。リモート デスクトップ接続を認証するには、前にアップロードした証明書を使用するか、新しい証明書を作成することができます。

クラウド サービスの **[構成]** ページで、リモート デスクトップを有効にしたり、仮想マシンへの接続に使用するローカルな管理者アカウントまたはパスワード、認証に使用する証明書、または有効期限を変更したりできます。

<div class="dev-callout"> 
<b>注</b>
<p>クラウド サービスが複数の接続済みの Windows Server ベースの仮想マシンで構成されている場合、リモート アクセスを構成する必要はありません。この場合、仮想マシンはリモート デスクトップ用に自動的に構成されています。</p>
</div>


###サービス定義ファイルでリモート アクセスを構成するには###

サービス定義ファイル (.csdef) に **Import** 要素を追加して、RemoteAccess および RemoteForwarder モジュールをサービス モデルにインポートします。これらのモジュールが存在すると、Azure によってリモート デスクトップ用の構成設定がサービス構成ファイルに追加されます。リモート デスクトップの構成を完了するには、Azure に証明書をインポートして、サービス構成ファイルでその証明書を指定する必要があります。詳細については、「[Azure ロールのリモート デスクトップ接続をセットアップする][]」を参照してください。

###管理ポータルでロール インスタンスのリモート アクセスを有効にする、または変更するには###

1. [管理ポータル](http://manage.windowsazure.com/)にログインし、**[クラウド サービス]** をクリックします。目的のクラウド サービスの名前をクリックして、ダッシュボードを開きます。

2. クラウド サービスの **[構成]** ページを開き、**[リモート]** をクリックします。

	 **[リモート デスクトップ設定を構成する]** に、クラウド サービスの展開時にサービス構成ファイルに追加された設定が下図のように表示されます (ある場合)。

	![クラウド サービス リモート](./media/cloud-services-how-to-configure/CloudServices_Remote.png)

> [WACOM.NOTE]
> **警告:** 初めてリモート デスクトップを有効にして [OK] (チェックマーク) をクリックしたときは、すべてのロール インスタンスが再起動されます。再起動を防止するには、パスワードの暗号化に使用した証明書がロールにインストールされている必要があります。証明書がインストールされていない場合、以下のオプションが表示されます。![CloudServices_CreateNewCertDropDown](./media/cloud-services-how-to-configure/CloudServices_CreateNewCertDropDown.png)

	再起動を防止するには、証明書をインストールしてからこのダイアログに戻ってください (詳細については、「[Azure ロールでのリモート デスクトップの使用][]」を参照してください)。既存の証明書を選択すると、構成の更新がロール内のすべてのインスタンスに送信されます。

3. **[ロール]** で、更新するサービス ロールを選択します。すべてのロールの場合は、**[すべて]** をクリックします。

4. 必要に応じて次の変更を行います。

- リモート デスクトップを有効にするには、**[リモート デスクトップを有効にする]** チェック ボックスをオンにします。リモート デスクトップを無効にするには、チェック ボックスをオフにします。

- ロール インスタンスへのリモート デスクトップ接続で使用するアカウントを作成します。

- 既存のアカウントのパスワードを更新します。

- 認証に使用するために、アップロードした証明書を選択するか (**[証明書]** ページの **[アップロード]** を使用して証明書をアップロードします)、新しい証明書を作成します。

- リモート デスクトップ構成の有効期限を変更します。

5. 構成の更新が完了したら、[OK] (チェックマーク) をクリックします。

6. ロール インスタンスに接続するには:

	a. **[インスタンス]** をクリックして、**[インスタンス]** ページを開きます。

	b. リモート デスクトップが構成されたロール インスタンスを選択します。

	c. **[接続]** をクリックし、指示に従って仮想マシンのデスクトップを開きます。

	d. **[開く]**、**[接続]** の順にクリックして、リモート デスクトップ接続を開始します。

###管理ポータルでロール インスタンスのリモート アクセスを無効にするには###

1. [管理ポータル](http://manage.windowsazure.com/)にログインし、**[クラウド サービス]** をクリックします。目的のクラウド サービスの名前をクリックして、ダッシュボードを開きます。

2. クラウド サービスの **[構成]** ページを開き、**[リモート]** をクリックします。

3. **[ロール]** で、更新するサービス ロールを選択します。すべてのロールの場合は、**[すべて]** をクリックします。

4. **[リモート デスクトップを有効にする]** チェック ボックスをオフにします。

5. [OK] (チェックマーク) をクリックします。

[Azure ロールのリモート デスクトップ接続をセットアップする]: http://msdn.microsoft.com/ja-jp/library/windowsazure/hh124107.aspx

[Azure ロールでのリモート デスクトップの使用]: http://msdn.microsoft.com/ja-jp/library/windowsazure/gg443832.aspx
			

